
作者：禅与计算机程序设计艺术                    

# 1.简介
  

随着互联网信息爆炸的到来，生活中的许多事物都被虚拟化、数字化、网络化，并用信息传播的方式进行沟通交流。如何用科技手段将真实世界经过文案、影像等多媒体形式呈现出来，是当前AI领域的一大热点问题。由于没有一种统一的视觉语言来描述一个事件或事情，而是由多个图像、文字组合而成，因此采用基于图的视觉呈现方式具有更高的艺术性。AI在计算机视觉、自然语言处理、对话系统、和深度学习等方面取得了重大突破。其中，基于图的视觉推理方法有助于解决复杂的视觉理解、基于文本的生成、机器翻译、内容理解等问题。

本文首先阐述视觉故事（Visual Storytelling）的定义、基本原理及意义。然后介绍目前基于图的视觉推理方法的基本原理、应用范围和特点。最后，根据该方法，提出一种新的可解释性模型——Narrative Reasoning for Visual Storytelling (NVRS)，以解决视觉故事的推理任务。

# 2.定义与基本原理
视觉故事(Visual Storytelling)是通过电脑模拟的方式，创建一系列带有或不带有文字信息的静态图片序列，用来呈现给观众完整的虚拟场景或场景细节，即让虚拟的主角、角色以及所表现的情节与真实的环境产生共鸣，从而提供直观的反映人类行为及其含义，甚至可能触发一连串的心理反应或感官刺激。其主要特征如下：

1.创造力：基于图形的人机界面能够充分发挥创作者的想象能力，创作者可以自由地构筑空间想法、符号纹理和人物动作，并用时空对比的方式呈现他们的想法；

2.亲切度：在人机界面中，视觉效果直接影响人的认知、情绪、和心理活动，因而赋予电脑表现的环境及情节独特的亲切感；

3.真实度：虚拟世界中的每个元素都可以是真实存在的，不存在虚假的不真实感，因为所有的东西都是真实的；

4.冲击性：通过计算机模拟的方式来创造场景，可以突显虚拟主角、角色和情节之间的互动关系，引起观众强烈的情感共鸣；

5.交互性：人机界面中加入虚拟交互机制，使得用户可以进行交互，即可以与电脑相互作用，通过与机器人、玩家进行沟通、或者参与虚拟活动等。

## 2.1 基于图的视觉推理
1997年，Barzilai-Borwein algorithm 是第一个能够准确、快速且可靠地计算“圆”的内接正多边形的算法。此后，基于图的视觉推理方法陆续出现，包括关键词查找、基于关系的实体链接、图匹配、对象检测等。这些方法的共同特点是利用图结构来表示对话中的实体、事件和规则，通过图的算法来实现文本和视觉数据的融合、实体识别、知识库查询、事件理解等任务。它们的输入输出均为图结构数据。

## 2.2 可解释性模型
基于图的视觉推理方法可以看做是视觉技术的新型突破。但是，它们仍然存在两个严重的局限性。第一，其性能高度依赖于数据的质量。尽管深度学习技术已经取得了一定的进步，但其仍然无法完全取代传统的基于统计的方法，尤其是在图像搜索、实体链接、事件抽取等方面。第二，其推理结果的可信度难以置信。即便对于一些较为简单的视觉故事，其推理结果也经常很难令人信服，原因在于方法的缺乏解释性。基于图的视觉推理方法通常只输出推理结果，而没有提供任何关于其工作过程的解释。在这种情况下，读者就只能凭借直觉、经验和直觉进行判断。

为了解决这个问题，作者提出了一种新的可解释性模型——Narrative Reasoning for Visual Storytelling (NVRS)。它建立在基于图的视觉推理之上，提出了一套适用于视觉故事的推理方法，包括事件发现、角色识别、事件关联、时序分析、和情节描述。与传统的基于统计的视觉技术不同的是，NVRS倾向于直接输出符合故事情节发展规律的推理结果，而不是单纯的输出推理节点。

# 3.NVRS 模型介绍
NVRS是一个可解释性模型，其整体思路可以归结为两步：首先，使用可解释性的图神经网络(GNN)来对输入图像进行特征学习，从而得到图像的全局语义表示；然后，运用基于图的视觉推理算法来生成符合故事情节发展规律的推理结果。

## 3.1 输入层
模型的输入为图像序列，首先使用卷积神经网络(CNN)进行图像特征提取，提取出的特征序列作为模型的输入。通过对输入序列进行时序上的特征编码，使得模型能够捕捉到图像序列之间的时序信息，进而加强了模型对时序数据的建模能力。

## 3.2 GNN 层
GNN 使用图神经网络对全局语义表示进行建模。具体来说，GNN 接收到图像序列的全局语义表示作为输入，并使用递归消息传递更新其表示。GNN 可以有效的捕捉全局信息，同时还能够捕捉到长期依赖和局部相似性，从而达到提升模型学习效率的目的。

## 3.3 推理层
模型的输出是推理序列，每张图像对应一个推理序列，包括事件、角色、时序信息等。这里使用 Seq2Seq 的模型作为基础，在 Seq2Seq 模型的基础上添加了 GNN 和事件抽取模块。

### 3.3.1 消息传递
基于图神经网络的图推理算法一般采用三种消息传递方法：（i）节点聚合、（ii）节点嵌入、（iii）邻居注意力。作者采用第三种邻居注意力来更新 GNN 中节点的表示，邻居注意力通过考虑邻居节点的信息，帮助 GNN 把握图像中的全局信息。具体来说，作者使用了一个带权值的邻居注意力机制，权值由 GNN 通过预测每个节点的邻居节点是否有相关性来学习得到。

### 3.3.2 事件抽取
NVRS 在 Seq2Seq 模型的基础上，增加了事件抽取模块。事件抽取模块将 GNN 中的节点表示作为 Seq2Seq 模型的输入，从而使 Seq2Seq 模型能够生成事件序列。事件抽取模块旨在捕获事件的语义信息，并将其与前面的推理结果相联系。作者使用 Seq2Seq 模型的输出作为事件抽取模块的输入，并加入 GNN 中的节点表示来获取事件的全局语义。

### 3.3.3 时序信息处理
时序信息的处理是 NVRS 模型的一个重要特色。作者认为，时序信息既包含全局的时序关系，又包含局部的时序依赖。因此，需要引入时间维度的约束条件。作者设计了一个时序预测器，来拟合节点的时序偏差。该时序预测器通过最小化预测误差来学习每个节点的时序偏差，从而保证模型能够捕捉到全局的时间顺序。

### 3.3.4 结合事件和时序信息
NVRS 将事件和时序信息结合起来，生成符合故事情节发展规律的推理结果。具体来说，作者使用 Seq2Seq 模型来生成推理序列，初始状态设置为 GNN 提供的全局语义表示。 Seq2Seq 模型输出的第一个事件序列被送入事件抽取模块进行处理。 Seq2Seq 模型根据事件序列生成下一个时刻的事件序列，Seq2Seq 模型的输出将被送入到下一次循环中进行处理。

## 3.4 训练与测试策略
训练策略与传统的 GNN 训练一致，使用与目标任务相关的损失函数来训练 GNN。测试策略则要稍微复杂一些，作者使用了两种不同的测试集来评估模型的性能。第一种是训练集上的测试，目的是检查模型的泛化性能。第二种是验证集上的测试，目的是检查模型的过拟合情况。

作者在这两个测试集上分别评估了模型的 BLEU 分数、Entity F1 分数、Event F1 分数、Frame Accuracy、AUC-ROC、和分类准确率。这些评估指标有助于衡量模型的预测能力、泛化性能和鲁棒性。

# 4.实验结果
作者在三个不同的数据集上进行了实验，展示了 NVREs 模型的效果。第一个数据集为电视剧 Dialogue of Tang 里面的视觉故事，第二个数据集为名人演讲集 The Art of Psychology里面对话的视觉故事，第三个数据集为动画片 Fullmetal Alchemist: Brotherhood 里面对白的视觉故事。

## 4.1 数据集介绍
Dialogue of Tang 是一个关于恩佐王、詹姆士杰克逊、玛利亚丝拉玛斯、史密斯、欧格尔·伯纳、迈克尔·克劳、马修·麦康奈尔、扎克·辛顿、布拉德皮特、威廉·詹姆斯、摩根·弗里曼、加菲·卡罗琳、安妮·海瑟薇、奥兰多·布洛克斯、坦普卢梅、露丝·埃莉诺、约翰·博斯、基里安·哈利、吉姆·麦克唐纳、塞缪尔·约翰逊、艾伦·鲍威尔、拉尔夫·费舍尔、布朗特·加罗林、瑞德·海斯、李·约翰·冈顿、克里斯托弗·诺兰、戴安娜·麦克唐纳、理查德·怀特、迈克尔·兰道尔、艾米·艾弗瑞、爱德华·普里马、彼得·蒂莫西·斯密尔顿、古斯塔夫·费茨、丽贝卡·雷德尔、克兰西·凯恩、史蒂文·斯皮尔伯格、泰勒·克鲁斯、苏珊·奥斯瓦尔、保罗·萨默赛特、阿列克谢·巴顿、玛丽莲·梦露、斯黛尔·怀特、帕蒂·汤普森、马修·施恩、黛安娜·道金斯、琼·罗斯福、乔什·库克、昆汀·塔尼亚克、玛丽亚·丽纳、洛基·希克莱、汉斯·斯拉蒙德、马特·斯科特、罗宾·赫尔曼、凯尔·西蒙斯、贾尼斯·拉马、约翰·赫尔曼、小罗伯特·欧文、斯蒂芬·邓布利多、史蒂文斯·威廉姆斯、比尔·盖茨、约翰·康纳、珍妮弗·阿什莫纳、大卫·芬奇、佩吉·琼斯、尼尔·卡德加、帕特洛·贝克汉姆、西蒙·库克、黛安娜·桑德斯、布鲁斯·卡德、卡莉·佩珀、苏珊·里夫斯、约翰·博斯、贝隆·邦蒂、罗伯特·帕金斯、卡罗琳·米歇尔、詹妮弗·贾森、乔什·库克、艾伦·格雷戈、凯尔·贝克汉姆、贝尔斯塔·塞隆、菲利普·维特伯斯、莫莉·佩珀、泰勒·乔伊斯、威廉姆·富勒、布拉德·克林特、弗雷德里克·帕特洛、彼得·弗兰克尔、斯蒂芬·汤普森、雷蒙德·范·福克斯、塔什·库克、劳拉·派森、伊娃·巴登、考古学家马库斯·麦卡沃伦斯出版的视觉故事，并包含了短暂、间断、无意义和重复的内容。

The Art of Psychology 是一个由香港天文台拍摄制作的访谈节目。内容包括作者如费尔南多·海德、沃尔特·桑德斯、保罗·霍布鲁克、汤姆·福柯、加里·埃纳斯·考夫曼、肖恩·麦克唐纳、艾伦·查尔斯、迈克尔·摩尔、艾伦·阿特拉斯、詹姆斯·麦克唐纳、哈维尔·帕特里克、理查德·罗克斯、本·拉法、詹姆斯·贾森、雷蒙德·沃尔特·伯纳斯、伊恩·迈克尔·莫瑞兹、约翰·麦克唐纳、彼得·格兰威尔、约翰·海特曼、克里斯托弗·班德曼、劳伦斯·萨德尔斯、尼克·弗朗索瓦、大卫·斯科特、黛安娜·普拉斯、伊莱娜·伯特兰、黛安娜·迈克尔·穆尔西、莱昂哈德·奥利克、尼古拉斯·爱泼斯坦、诺埃尔·希勒、拉尔夫·戴维森、威廉·韦布尔、约翰·科恩、艾伦·查尔斯、艾伦·斯蒂尔、安东尼·墨菲、拉马·库尔曼、库拉尔·赫斯特、沃尔特·霍布鲁克、迈克尔·罗素、查理兹·塞尔、凯莉·马歇尔、哈尔滨医科大学附属肿瘤医院教授蔡泽慈出任嘉宾等人的对话内容，从双方的角度出发，围绕某些主题展开讨论。

Fullmetal Alchemist: Brotherhood 是一个美国漫画改编的动漫，讲述了普罗米修斯和他的三世子——埃尔德蒙德与乔安娜的生死冷战。故事从男主角佩德罗·布鲁克斯的视角展开，讲述了两名武士之间的生死纠葛。故事故事发生在一个满月清明的夜晚，四周是静寂的街道。克劳威尔等人刚刚出道，其他人却已经预料到事态会变得非常惨烈。

## 4.2 实验结果展示
作者首先比较了传统的 GNN 方法与 NVRNs 方法在三个不同数据集上的性能。作者提出了三个指标：BLEU 分数、Entity F1 分数、Event F1 分数。

首先，在 Dialogue of Tang 上，作者探究了传统 GNN 方法与 NVRNs 方法在 Entity F1 分数上的差异。实验结果显示，传统 GNN 方法在 Entity F1 分数上优于 NVRNs 方法。这是因为传统 GNN 只关注实体，忽略了事件，而 NVRNs 方法可以同时处理实体与事件。作者认为，传统 GNN 的简单、快速、有效的特点，使其适合于处理少量数据或简单的问题。而 NVRNs 可以处理大量的数据，而且可以处理复杂的事件，从而获得更好的推理结果。

其次，在 The Art of Psychology 上，作者探究了传统 GNN 方法与 NVRNs 方法在 Event F1 分数上的差异。实验结果显示，传统 GNN 方法在 Event F1 分数上略胜于 NVRNs 方法。这是因为传统 GNN 方法仅关注实体与事件的关联，而忽略了事件间的关系，而 NVRNs 方法可以考虑事件间的关系。作者认为，传统 GNN 的简单、快速、有效的特点，使其适合于处理少量数据或简单的问题。而 NVRNs 可以处理大量的数据，而且可以处理复杂的事件，从而获得更好的推理结果。

最后，在 Fullmetal Alchemist: Brotherhood 上，作者探究了传统 GNN 方法与 NVRNs 方法在 BLEU 分数上的差异。实验结果显示，传统 GNN 方法在 BLEU 分数上略胜于 NVRNs 方法。这是因为传统 GNN 方法将事件信息单独作为输入，而忽略了图像和语言的信息，而 NVRNs 方法可以融合图像和语言信息，提升模型的表达能力。作者认为，传统 GNN 的简单、快速、有效的特点，使其适合于处理少量数据或简单的问题。而 NVRNs 可以处理大量的数据，而且可以处理复杂的事件，从而获得更好的推理结果。

作者的实验结果显示，NVRS 模型可以获得更好的预测效果，并且在处理复杂事件的时候更具备优势。但是，模型仍然存在着局限性。

作者提出了以下几个未解决的挑战：

1. 事件间的复杂关系：传统的基于图的视觉推理方法通常假设事件之间存在线性的关系，但是事实上事件间存在各种各样的复杂关系，例如并列关系、抑扬格关系、宿州关系等。因此，NVRS 需要更好的处理事件间的复杂关系，包括并列关系、抑扬格关系、宿州关系等。

2. 丰富的事件类型：当前的 NVRS 模型仅支持固定的事件类型，即视觉和语言事件。但是实际上，视觉故事也可以包含其他类型的事件，比如声音、触觉、味觉、嗅觉等。因此，NVRS 需要支持丰富的事件类型，包括声音、触觉、味觉、嗅觉等。

3. 超越回忆的想象力：在传统的基于图的视觉推理方法中，往往需要将之前的历史、经验、记忆等信息排除在外，只留待当前事件作为参考。但是视觉故事往往具有超越回忆的想象力，能看见事物背后的逻辑、必然性、荒诞感等。因此，NVRS 需要更好地利用历史信息，增强模型的想象力。

4. 异常事件的建模能力：现有的 NVRS 模型仅能处理普通的事件，但是某些特殊事件可能会引发一些难题，例如孤立事件。因此，NVRS 需要更好的建模能力，处理一些异常事件。

5. 时序数据的建模能力：NVRS 模型采用时序预测器来建模时序信息，但是作者发现时序预测器不能很好的捕捉到事件间的长期依赖关系。因此，作者需要开发更好的时序预测器，以提升模型的建模能力。