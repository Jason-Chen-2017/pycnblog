
作者：禅与计算机程序设计艺术                    

# 1.简介
  

Docker是一个开源的应用容器引擎，基于Go语言实现。它可以轻松打包、部署和运行应用程序，并可以扩展到任意数量的机器上。Docker将应用与相关的依赖项捆绑在一起，形成一个轻量级的独立软件包，即容器。由于隔离性和安全性等优点，使得Docker非常适合用于自动化环境中部署复杂的应用程序。本文是关于Docker官方文档的一份中文译本。

主要读者：Docker初学者；对Docker有疑惑或需要进一步了解的人员。

## 一、背景介绍

Docker是一个开源的应用容器引法，通过利用Linux内核中的cgroup和namespace资源隔离特性，用户可以在不影响系统其他进程的情况下，创建出独立于宿主系统的虚拟环境。Docker基于Go语言开发，从17年3月推出第一版Docker到现在已经过去了十多年的时间，经历了非常多的版本迭代，目前最新稳定版本是19.03。

Docker提供了简单易用、快速启动的特性，而无需额外配置就可以达到隔离环境的效果。最早期，Docker被称作“英国伦敦的码头”，主要目标是为了解决开发人员的痛点——开发环境的一致性。但是随着Docker的火爆，它的真正意义也越来越明显。Docker的出现，彻底颠覆了传统虚拟机技术，帮助开发者解决了许多原本困扰着开发人员的问题，比如环境一致性、快速部署、高可用、便携性等等。

作为一款能够帮助开发人员提升工作效率的工具，Docker拥有强大的社区支持。每天都有大量优秀的第三方工具、平台被开发出来，如Kubernetes、AWS ECS、Azure ACI、Mesos等等。除了上面提到的这些领先的技术，Docker还与其他云服务商及开源软件结合，共同构建起一个庞大的生态系统。

## 二、基本概念术语说明

### 2.1 镜像（Image）

Docker镜像类似于一个静态的文件系统，其中包含了一组指令并且没有执行环境，只能执行一些基本的任务。镜像可以理解为一个只读的模板，自带完整的运行时环境，但无法直接执行。在Docker中，镜像可以用来创建容器实例，它由以下三部分构成：

1. 基础镜像（Base Image）：通常来说，Dockerfile中定义的第一个指令就是FROM，用来指定所基于的基础镜像。Dockerfile会告诉Docker如何编译这个镜像，以满足应用运行的需求。对于不同类型的应用，可能会选择不同的基础镜像。例如，对于Web应用来说，可能选择一个带有Web服务器的基础镜像，而对于数据库应用来说，则选择一个带有数据库服务器的基础镜像。
2. 文件系统层（Filesystem Layer）：从基础镜像开始，Docker自顶向下递归地将所有指令逐个执行，生成一个新的镜像。这一层就是文件系统层，它包含了最终容器运行时所需的所有文件。
3. 配置层（Configuration Layer）：在第二层以上的所有层都属于配置层，用于保存镜像的元数据。它包括了镜像的标签（Label）、作者（Author）、创建时间（Created）、体积大小（Size）、容器入口点（Entrypoint）、默认执行命令（Cmd）等信息。

### 2.2 容器（Container）

镜像是静态的，容器才是动态的，它是一个运行中的实体。你可以把容器看作是一个轻量级的沙箱，里面有自己的文件系统、进程空间和网络配置。每当你启动或者创建一个容器的时候，它就会从镜像中创建一份可写的副本。容器与镜像之间最大的不同是它们共享内核，因此容器里的进程可以直接访问宿主机的资源，而不需要模拟整个操作系统。另外，每个容器都有一个唯一的ID，既可以用来在主机上管理它，又可以被传入到其他容器中。

### 2.3 仓库（Repository）

仓库（Repository）是集中存放镜像文件的场所。Docker Hub是一个公开的仓库，任何人都可以使用，甚至可以在上面分享、分发自己的镜像。在国内，像阿里云提供的镜像服务、DaoCloud这样的云端仓库也相继推出。当你需要下载某个镜像时，Docker客户端会首先查看本地是否存在该镜像，如果不存在，则会向远程仓库请求该镜像。

### 2.4 Dockerfile

Dockerfile是用来构建镜像的构建文件，其中的指令会告诉Docker怎么样构建镜像，然后再将镜像运行起来。Dockerfile分两部分，分别是构建镜像用的指令和运行容器用的启动指令。一般来说，Dockerfile包含的内容如下：

- 指定基础镜像：FROM <image>:<tag>。
- 安装软件包：RUN <command>。
- 设置环境变量：ENV <key>=<value>。
- 添加文件：ADD <src>... <dest>。
- 执行命令：CMD ["executable","param1","param2"]。
- 复制文件：COPY <src>... <dest>。
- 指定端口映射：EXPOSE <port>。
- 设置工作目录：WORKDIR <path>。

Dockerfile的编写方式类似于shell脚本，不同的是其后缀名为.Dockerfile。Dockerfile中的指令一般按顺序执行，并且会在当前工作目录下寻找要添加的文件或执行的命令。