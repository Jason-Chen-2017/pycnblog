
作者：禅与计算机程序设计艺术                    

# 1.简介
  

线性系统又称线性方程组、线性代数方程组等，是指由若干个或几个变量（下标）及其之间的关系构成的方程系统，而这种关系恰好符合加法、乘法以及单位元的运算。常见的线性系统有：流体力学方程、微分方程、差分方程、流变换方程、偏微分方程、齐次方程、控制方程、离散方程。
对于一个线性系统而言，如果所有的系数都不为零，则该系统是完全描述的；如果存在至少一个系数为零，则该系统是不完全描述的，称为部分描述系统。
最常用的线性系统之一是普通的方程组，通常形式如下：
$$\begin{cases} a_{11}x_1+a_{12}x_2+\cdots +a_{1n}x_n=b_1\\ a_{21}x_1+a_{22}x_2+\cdots +a_{2n}x_n=b_2\\ \vdots \\ a_{m1}x_1+a_{m2}x_2+\cdots +a_{mn}x_n=b_m\end{cases}$$
其中$a_{ij}, b_i(i=1,\ldots, m)$为系数矩阵和右端常数向量，$x_j(j=1,\ldots, n)$为未知量。
这些方程组中只有少量未知量的线性方程组叫做可逆方程组（invertible equation），称为线性方程组；而一般的不可逆方程组称为非线性方程组或病态方程组（ill-posed equations）。
假设存在某个矩阵$A$满足：
$$Ax = b$$
且矩阵$A$是稀疏矩阵，即其元素个数小于等于实际可能存在的元素个数。则矩阵$A$的解可以用格雷戈里曼迭代法（Gilbert-Peierl Iteration Method）进行求解。本文主要讨论稀疏线性系统的求解方法，即当矩阵$A$是稀疏矩阵时如何利用格雷戈里曼迭代法求解。
# 2.基本概念术语说明
## 2.1 格雷戈里曼迭代法
格雷戈里曼迭代法是一种用于求解线性系统的迭代法，它由威廉·格雷戈里·摩尔所提出。
设已知矩阵$A$是一个$m$阶方阵，而向量$\vec{x}^{(0)}=(x^{(0)}_1, x^{(0)}_2, \cdots, x^{(0)}_n)^T$作为初值，则格雷戈里曼迭代法的一般过程如下：
1. 对每一个$k=0, 1, 2, \cdots$：
2. （$k+1$步）计算：
   $$\vec{p}_k = A\vec{x}^{(k)} - \vec{b}$$
3. （$k+1$步）计算：
   $$Q_k = Q_{k-1}(I - H_k)$$
4. （$k+1$步）计算：
   $\vec{x}^{(k+1)} = (H^{-1}_kq_k)_1$, $q_k=Q_ka_k$
5. 当$\left|x^{(k+1)}-\vec{x}^{(k)}\right|\leq \epsilon$或达到最大迭代次数时停止迭代。
其中，
$H_k$是$A$的第$k$个伪逆矩阵，$\vec{b}$是系数矩阵$A$的右端常数向量，$q_k$表示迭代过程中第$k$次迭代的增量向量，$a_k$表示迭代过程中第$k$次迭代的增量矩阵。
## 2.2 稀疏线性系统
设$A$是$m$行$n$列的实矩阵，若对任意$i, j$，$a_{ij}=0$或$a_{ij}$的值不确定，则称$A$为稀疏矩阵。
## 2.3 “稀疏”
对于一组方程，如果某些方程无明确的解，则称该组方程为“不完全确定的”。例如，方程组：
$$2x-y=1, -x+y=-1, -y=2x-1$$
在点$(0,0)$处没有任何的解。但假如把最后两条方程换一下顺序：
$$-y=2x-1, y=-2x+3, -x+y=-1$$
则这个方程组在点$(0,0)$处有一个唯一确定的解$x^*=\frac{-3}{7}$, $y^*=1$。这里使用的“完全确定的方程”可以认为就是指只有唯一确定的解的方程。相反，“不完全确定的方程”中的每一个方程都可能对应着不同的解。
所以，“稀疏”的意思是指矩阵$A$是一个稀疏矩阵。在稀疏线性系统中，所有不存在的元素都被设置为零，矩阵$A$的元素之间存在很大的相似性。因此，对于稀疏矩阵而言，一般不需要求出它的逆矩阵，也不需要求出列空间。因此，只需要求解约束条件下的解即可。
# 3.核心算法原理和具体操作步骤以及数学公式讲解
## 3.1 求解稀疏线性系统的一般步骤
对于一个稀疏线性系统，假定其约束条件是$Ax=b$，其中$A$为$m$阶方阵，$x$为$n$维列向量，$b$为$m$维列向量。假定向量$x$的初始值为$x^{(0)}$，将要用迭代法求得精确解$x^*$。则以下步骤可以得到精确解：

1. 用矩阵$A$和$b$构造线性方程组$A\vec{x}=\vec{b}$，得到的是一个可逆方程组。
2. 把求解出的基本解$\vec{x}^{(k)}$重新组织成列主元矩阵$P_k$，并作相应的置换，使之成为上三角矩阵。这个矩阵的第$i$列的元素由$\vec{x}^*(i)$给出。
3. 如果要求近似解，则用$P_k$的近似逆矩阵$P_{k+1}^{-1}$替代$P_k^{-1}$，以获得近似解$x^{*}_{\Delta k}$.
4. 在每一步迭代后，更新$x^{(k+1)}=Px_k$，再把新的基$Px_k$左乘矩阵$Q_kx^{(k+1)}$以获得新的增量向量$q_k=Qx^{(k+1)}-Px_k$。
5. 将增量向量$q_k$投影回$R_kp_k$所在的范围内，取原来的$x_k$与增量向量$q_k$的均值作为$x^{k+1}$，重复步骤3～4直到收敛或者迭代次数达到要求。

## 3.2 格雷戈里曼迭代法求解稀疏线性系统的数学表达
对于一个矩阵$A$为稀疏矩阵的线性方程组$Ax=b$，其解为$x=Px_{\ast}$, 其中$P$为基矩阵。设矩阵$A$的伪逆矩阵为$H_0$，$p_{\ast}$为$A$的伴随向量，即$Ap_{\ast}=\lambda p_{\ast}=0$。则有：
$$\begin{bmatrix}\lambda_1 & & \\ & \ddots & \\ && \lambda_n\end{bmatrix}P_1=b$$
利用单位阵$I$的特征分解，将矩阵$A$的伴随向量表示成：
$$A^TA=\text{diag}(\lambda_1,\lambda_2,\ldots,\lambda_n)$$
则有：
$$P_1\begin{bmatrix}\beta_1 & \\ & \beta_n\end{bmatrix}=\text{diag}(\lambda_1,\lambda_2,\ldots,\lambda_n)\cdot\begin{bmatrix}p_{\ast}^T \\ p_{\ast}\end{bmatrix}$$
其中$\beta_i=p_{\ast}^Tp_1\lambda_i$。

类似地，可以得到$p_2,\ldots,p_n$关于$\lambda_1,\lambda_2,\ldots,\lambda_n$的特征向量及对应的特征值，然后根据特征值构造基矩阵$P_2,\ldots,P_n$。对每个$k=0,1,\ldots$：
$$P_{k+1}=(I-\lambda_kp_{\ast})\begin{bmatrix}P_{k}\\ q_k^TP_k\end{bmatrix}$$
其中$q_k=Q_k(A-\lambda_kp_{\ast})^{-1}p_k$，其中$Q_k=QP_k(I-\lambda_kp_{\ast})^{-1}$，$Q_k\in R^{nxn}$是单位阵的$n$阶伴随矩阵。

最后，对每一步迭代，计算$x^{(k+1)}=Px_k$，其中$x_k=P_{k+1}(b-\lambda_kP_{\ast})$，$\lambda_k$为第$k$步的基本解，$P_{\ast}$为伴随向量，则可计算出每个增量向量：
$$q_k=Q_kx^{(k+1)}-(1-\lambda_kp_{\ast}^T)(Px_k),\quad P_{\ast}^Tq_k=0,$$
之后将$q_k$投影回$R_kp_k$所在的范围内，取原来的$x_k$与增量向量$q_k$的均值作为$x^{k+1}$，重复这个过程直到收敛或者迭代次数达到要求。

## 3.3 实际案例分析
考虑如下稀疏线性系统：
$$\begin{cases} x+y+z=5\\ z-3x+2y=0\\ 2x+3y-z=0\end{cases}$$
其约束条件为$x+y+z=5$、$z-3x+2y=0$和$2x+3y-z=0$。令$b=(5,0,0)^T$，$A=[[1,1,1],[1,-3,2],[-2,3,-1]]$。由于矩阵$A$为稀疏矩阵，所以可以通过格雷戈里曼迭代法求解。

首先，对矩阵$A$的伴随向量求解：
$$Ap_{\ast}=\begin{pmatrix}-9 \\ -4 \\ 1\end{pmatrix},\quad p_{\ast}=\begin{pmatrix}4/5 \\ 1/5 \\ 1/5\end{pmatrix}$$
故有：
$$\begin{bmatrix}-9 & -4 & 1\end{bmatrix}\begin{bmatrix}4/5 \\ 1/5 \\ 1/5\end{bmatrix}=\text{det}(A)=\lambda_1(\lambda_2-\lambda_3)-\lambda_2(\lambda_1-\lambda_3)+\lambda_3(\lambda_1-\lambda_2)=0$$
得到基矩阵$P_1=[\beta_1,\beta_2,\beta_3]^T=[[-4/5,1/5,1/5],\lambda_1/(-\lambda_1-\lambda_2+\lambda_3)]$，其中$\lambda_1=-\lambda_2+\lambda_3=1/2<1$，因此：
$$\begin{bmatrix}\beta_1 & \beta_2 & \beta_3\end{bmatrix}=\begin{bmatrix}0&1&0\\ 4/5&0&0\\ 0&0&4/5\end{bmatrix}\begin{bmatrix}-4/5 \\ 1/5 \\ 1/5\end{bmatrix}=P_1\begin{bmatrix}-4/5 \\ 1/5 \\ 1/5\end{bmatrix}=[[-4/5,1/5,1/5],\lambda_1/(-\lambda_1-\lambda_2+\lambda_3)]\begin{bmatrix}-4/5 \\ 1/5 \\ 1/5\end{bmatrix}$$

用初值$x^{(0)}=(1,1,1)^T$作为参考，在第一步迭代时：
$$P_1\begin{bmatrix}-4/5 \\ 1/5 \\ 1/5\end{bmatrix}=\begin{bmatrix}0&1&0\\ 4/5&0&0\\ 0&0&4/5\end{bmatrix}\begin{bmatrix}-4/5 \\ 1/5 \\ 1/5\end{bmatrix}=[[0,1,0],[-4/5,0,0],[0,0,-4/5]]\begin{bmatrix}-4/5 \\ 1/5 \\ 1/5\end{bmatrix}=\begin{bmatrix}0&1&0\\ 4/5&0&0\\ 0&0&4/5\end{bmatrix}\begin{bmatrix}-4/5 \\ 1/5 \\ 1/5\end{bmatrix}=\begin{bmatrix}4/5 \\ 1/5 \\ 1/5\end{bmatrix}$$
因为$x^{(0)}$已知，所以不用更新，直接进入第二步：
$$P_2\begin{bmatrix}-4/5 \\ 1/5 \\ 1/5\end{bmatrix}=\begin{bmatrix}0&1&0\\ 4/5&0&0\\ 0&0&4/5\end{bmatrix}\begin{bmatrix}-4/5 \\ 1/5 \\ 1/5\end{bmatrix}=[[0,1,0],[-4/5,0,0],[0,0,-4/5]]\begin{bmatrix}-4/5 \\ 1/5 \\ 1/5\end{bmatrix}=[[0,1,0],[-4/5,0,0],[0,0,-4/5]]\begin{bmatrix}4/5 \\ 1/5 \\ 1/5\end{bmatrix}=\begin{bmatrix}0&1&0\\ 4/5&0&0\\ 0&0&4/5\end{bmatrix}\begin{bmatrix}4/5 \\ 1/5 \\ 1/5\end{bmatrix}=\begin{bmatrix}8/5 \\ 1/5 \\ 1/5\end{bmatrix}$$
同样的道理，第三步也一样。则可以看到：
$$x^{(3)}=[[-4/5,1/5,1/5],\lambda_1/(-\lambda_1-\lambda_2+\lambda_3)]\begin{bmatrix}8/5 \\ 1/5 \\ 1/5\end{bmatrix}=[[-4/5,1/5,1/5],[1/2,-3/2,-1/2]][[8/5],[1/5],[-1/5]]=[8/15,1/15,0]$$
由于系统是线性的，这是一个唯一的解。接下来考虑近似解。取一个较小的步长$\Delta t$，计算$Px_{\ast}+\Delta t\lambda_1P_{\ast}$，并作相应的变换：
$$x_{\Delta t}^+=\begin{bmatrix}4/5 \\ 1/5 \\ 1/5\end{bmatrix}+\Delta t\lambda_1\begin{bmatrix}4/5 \\ 1/5 \\ 1/5\end{bmatrix}=\begin{bmatrix}4/5+4/5t \\ 1/5+1/5t \\ 1/5+1/5t\end{bmatrix}=e^{\lambda_1t}\begin{bmatrix}4/5 \\ 1/5 \\ 1/5\end{bmatrix}$$
求出近似解$x_{\Delta t}^+$后，可以看出其比真解$x^*$更接近。

综上所述，格雷戈里曼迭代法求解稀疏线性系统的一般步骤为：

1. 用矩阵$A$和$b$构造线性方程组$A\vec{x}=\vec{b}$，得到的是一个可逆方程组。
2. 把求解出的基本解$\vec{x}^{(k)}$重新组织成列主元矩阵$P_k$，并作相应的置换，使之成为上三角矩阵。这个矩阵的第$i$列的元素由$\vec{x}^*(i)$给出。
3. 如果要求近似解，则用$P_k$的近似逆矩阵$P_{k+1}^{-1}$替代$P_k^{-1}$，以获得近似解$x^{*}_{\Delta k}$.
4. 在每一步迭代后，更新$x^{(k+1)}=Px_k$，再把新的基$Px_k$左乘矩阵$Q_kx^{(k+1)}$以获得新的增量向量$q_k=Qx^{(k+1)}-Px_k$。
5. 将增量向量$q_k$投影回$R_kp_k$所在的范围内，取原来的$x_k$与增量向量$q_k$的均值作为$x^{k+1}$，重复步骤3～4直到收敛或者迭代次数达到要求。