
作者：禅与计算机程序设计艺术                    

# 1.简介
  

Deep Boltzmann Machine（DBM） 是深度玻尔兹曼机的缩写，一种生成模型，由Hinton等人于2006年提出。它是指在深层次结构中包含可塑性、不可回归性、不对称性的马尔可夫链的概率模型。其特点是在每一个层中都引入了神经网络，使得每一个隐层节点可以学习到某些特征，并通过这些特征与上一层的隐层节点相互作用产生下一层的隐层节点。 DBM 可以解决许多复杂任务，包括分类、聚类、生成和判别等。 
近几年，随着计算能力的发展，DBM 在图像处理、自然语言处理、生物信息学、模式识别等领域的应用越来越广泛。 DBM 的学习和预测可以保证模型准确性，并且可以有效地学习数据中的复杂特性。 


# 2.概念术语说明
## 2.1 深度玻尔兹曼机
### （1）定义
深度玻尔兹曼机（Deep Boltzmann Machine，DBM），也被称作无监督深层次狄利克雷估计器（Unsupervised Deep Boltzmann Machines，UD-BM）或深层次条件玻尔兹曼机（Deep Conditional Restricted Boltzmann Machine，DC-RBM）。它的特点是由多个隐藏层构成，每个隐藏层都由一组具有不同连接权值的相互连接节点组成。由于深层次结构中存在额外的连接，因此可以学习到输入数据的非线性表示，从而能够提取出抽象的模式。DBMs可以用于分类、聚类、生成模型等任务，并且效果很好。


### （2）学习过程

如上图所示，DBM的学习过程分为以下五步：
（1）初始化参数：首先，在输入层和隐藏层之间加入均匀分布的噪声，作为初始的参数值。

（2）前向传播：根据样本数据对参数进行迭代更新。计算每一层的节点值，其中第i层的第j个节点的值依赖于上一层第k个节点的值和激活函数。计算节点值的公式如下： 


其中： 
- v: 节点值 
- i: 当前层第 j 个节点 
- l: 当前层编号 
- N_l: 上一层第l层的节点个数 
- b: 参数 
- θ: 权重矩阵 
- a: 上一层第 k 个节点的值 
- σ: 激活函数，这里采用sigmoid函数 
- W: 偏置项参数 
- x: 样本值 

（3）期望传播：计算各节点之间的联合概率分布。利用Gibbs采样法（也称逐比例采样）从各层采样隐含变量。假设第l层的节点j有c种状态，则采样时按照概率分布p(v_j^l|v^{<l},z^{<l})独立地从c个状态中选择一个。计算采样结果的公式如下： 


其中：
- ∆: delta函数，返回0或1 
- v_k^(l): 第k个状态的样本值 

（4）反向传播：利用已有的样本对参数进行梯度下降，获得最优的参数值。利用L2正则化方法防止过拟合。

（5）收敛判定：当训练集上的损失函数减小到一定阈值时，认为训练结束。


## 2.2 Gibbs采样
Gibbs采样是一种用已知的变量值，按概率分布采样的方式。在DBM中，Gibbs采样用来估计节点之间的联合概率分布。具体过程如下： 

（1）输入层：固定所有变量值，计算各节点的边缘概率分布P(vi, vk)。 

（2）第i层：固定其他变量值，计算vj的边缘概率分布P(vk | vi)。 

（3）重复步骤（1）、（2）直至所有变量固定，则得到每个节点的联合概率分布P(vi, vk,..., vn)。然后根据该概率分布采样新的样本值。