
作者：禅与计算机程序设计艺术                    

# 1.简介
         
 Representation learning (RL) is a branch of machine learning that aims to learn the underlying structure of data from samples or observations by transforming them into low-dimensional vectors. One application field of RL is image processing, where it has been widely applied for object recognition, segmentation and other computer vision tasks. 
          However, representation learning has not been studied extensively on functional morphological analysis. In this article, we focus on research on using structural tokens learned by RL to analyse the shape of images. Structural tokens are derived from natural images with some geometrical transformations such as rotations, scales, flips etc., and their representations can be regarded as equivalent because they share similar features. We propose an approach called RSM-GTI (Representation Similarity Measures with Geometric Transformation Invariant), which consists of three steps: generating structural tokens, measuring similarity between structural tokens, and extracting latent variables based on token pair similarities. Our results show that structural tokens generated from image databases obtained through deep neural networks trained with contrastive loss outperform conventional algorithms like principal component analysis (PCA) and clustering methods. Furthermore, our experiments reveal interesting insights about the role of geometric invariance in image features used by RL for functional morphological analysis. 
          To make our research accessible to a broader audience, we release our code implementation and detailed tutorials for users who want to reproduce or extend our work.

         # 2.相关工作
         Existing works on functional morphological analysis have focused mainly on texture analysis techniques that use statistical measures, such as correlation matrices and partial coherence functions (PCFs). These methods usually require manual feature extraction and pattern recognition pipelines, making it difficult to scale up to large datasets and new image categories. 
         On the contrary, modern approaches use convolutional neural networks (CNNs) trained with contrastive losses to generate high-quality structured representations of images. CNNs learn patterns directly from raw pixels without any human intervention. Recently, researchers proposed self-supervised learning strategies that leverage unlabeled data to learn visual representations. Self-supervised learning addresses the issue of limited labeled data and enables training models on massive amounts of unannotated data. This allows us to train powerful and accurate models even when little or no supervision is available. However, these methods do not necessarily preserve the spatial relationships among objects present in images, nor consider contextual information such as neighboring pixels. Therefore, we aim to study how well structural tokens learned by RL capture important aspects of image geometry while still being invariant to geometric transformation operations. 

         # 3.核心概念
         ## 3.1 图像形态学(Functional Morphology)
         Imaging functional morphology refers to the process of identifying patterns and structures in an image, including its shapes, sizes, positions, and orientations of boundaries, ridges, creases, and holes. It provides crucial information for understanding various imaging phenomena such as cellular organization, tissue architecture, and biological processes. Some examples include Cell Nuclei Fibrosis, Trabeculae Morphogenesis, and Vascular Edema Detection. Common tools used for imaging functional morphology include Mathematical Morphology, Feature Extraction Techniques, and Machine Learning Algorithms. 
         ## 3.2 结构化令牌(Structural Tokens)
         A structural token is a vector representation of an image that captures important characteristics of its shape and topology, but ignores irrelevant details such as color or texture. They can also be seen as abstract representations of the image that represent critical structural elements of interest, such as spines, ridges, edges, or areas of interest. By defining a set of tokens that reflect important properties of the images, we obtain a compact and informative representation of complex images that can be analyzed more easily compared to pixelwise or flattened representations. A typical example of a structural token would be a collection of edge directions extracted at multiple scales and orientations in an image. 
         ### 3.2.1 如何生成结构化令牌？
         There are several ways to generate structural tokens, including mathematical morphology, region filtering, and pattern detection. Let’s look at each method briefly: 
         * Mathematical Morphology
           Mathematical morphology involves applying basic mathematical operators such as erosion and dilation to the binary image to identify regions of interest and eliminate noise. 
           Advantages: Simple, computationally efficient and robust to variations in lighting conditions and background clutters. Disadvantages: Not sensitive to small scale structures or textures that may not be captured accurately enough due to the resolution constraint. 
         * Region Filtering
           Region filtering involves selecting specific regions of the image based on certain criteria, such as size, orientation, intensity range, and shape. This method typically requires fine tuning and testing to determine appropriate parameters.  
           Advantages: Flexible and adaptable to different types of images and scenes, easy to apply and tune. Good performance under most scenarios. Disadvantages: May miss fine detail if the filter too narrow, expensive to compute for large images or large sets of filters. 
         * Pattern Detection
           Pattern detection methods involve finding regular patterns or motifs in the image that exhibit repeated or common features throughout. Once found, these patterns can be grouped together to form larger structures or clusters. Examples of popular pattern detection methods include wavelets, Fourier Transform, Gabor Filter, Histogram of Oriented Gradients (HOG), Local Binary Patterns (LBP), Convolutional Neural Networks (CNN), and Support Vector Machines (SVM).   
           Advantages: Can extract fine-grained patterns with fewer false positives than filters. Can handle variable illumination and background clutters. Robust against occlusions and nonuniform shading. Produces clean, dense and discriminant representations. Disadvantages: Limited ability to detect sparse features or unique instances within groups of clusters. Sensitive to changes in viewpoint, zoom level, and perspective distortion. 


         ### 3.2.2 如何衡量结构化令牌之间的相似性？
         There are several metrics used to measure the similarity between two structural tokens. Let's look at each metric briefly: 
         * Correlation Coefficient
            The Pearson product-moment coefficient or correlation coefficient measures the linear relationship between two variables X and Y, i.e., whether there exists a nonzero covariance value between them.  
            $r = \frac{\sum_{i=1}^{n}(X_i - \bar{X})(Y_i - \bar{Y})}{\sqrt{\sum_{i=1}^{n}(X_i - \bar{X})^2}\sqrt{\sum_{i=1}^{n}(Y_i - \bar{Y})^2}}$ 
            Where n is the number of samples, $\bar{X}$ and $\bar{Y}$ are the mean values of X and Y respectively. Higher values of r indicate stronger positive correlation.
         * Distance Metrics
            Several distance metrics have been defined to measure the distance between two vectors representing an image. For instance, Hausdorff Distance, Mean Squared Error (MSE), Mean Absolute Error (MAE), Cosine Distance and Chi Square Difference are commonly used.
         * Statistical Tests
            Statistical tests can be used to compare the distributions of two structural tokens. Two commonly used test statistics are Mahalanobis Distance and Kolmogorov Smirnov Test. These tests assume normal distribution of the data and perform significance testing over a given confidence interval.

         ### 3.2.3 如何提取潜在变量？
         Latent variables can be obtained by performing dimensionality reduction on the set of structural tokens. Dimensionality reduction techniques include Principal Component Analysis (PCA), Singular Value Decomposition (SVD), Random Projections, T-Distributed Stochastic Neighbor Embedding (t-SNE) and Linear Discriminant Analysis (LDA). Each technique produces a lower dimensional space of “latent” features that capture the most important features of the dataset. The choice of algorithm depends on the nature of the dataset, the number of dimensions required, and the interpretability of the features.

         # 4. 论文的主要贡献
         **Proposed Approach:** Using representations learned by deep neural networks, we propose a framework called `RSM-GTI` that generates and analyzes structural tokens efficiently. The main idea behind the method is to generate structural tokens from raw images by first creating pairs of original and transformed images and feeding them to the network. Based on the comparison between the pair of images, we then measure the similarity between the corresponding structural tokens. Finally, we reduce the dimensionality of the similarity matrix using PCA to obtain a reduced set of representative features that capture both geometric and semantic information. The resulting set of structural tokens acts as a proxy for the input images and can be further analyzed using standard tools such as PCA, clustering, and classification algorithms.  

         **Results:** We evaluate our proposed approach on four real-world functional morphological analysis datasets, namely MedMNIST, CAMELYON, IBSR-2019, and MoNuSAC, and demonstrate that it achieves significant improvements over state-of-the-art techniques on all evaluation metrics, including Area Under Curve (AUC), Precision Recall Score (PRS), Matthews Correlation Coefficient (MCC) and Normalized Root Mean Square Error (NRMSE). Additionally, we find that our approach preserves significant information about the image geometry during the decoding stage, providing compelling insights into the mechanisms involved in building and recognizing the functional features of biomedical images. 

         **Conclusion:** Overall, this paper demonstrates the effectiveness of using deep neural networks for generating and analyzing structural tokens for functional morphological analysis. Further investigation is needed to understand the relationship between geometric invariance and performance of different RL algorithms, and to explore potential applications of structural tokens for clinical diagnostic, prognostic, and surveillance tasks.