
作者：禅与计算机程序设计艺术                    

# 1.简介
  


随着高通量测序技术的广泛应用，已经形成了一套基于RNA-seq的表达水平估计方法体系。在本文中，我们提出了一种概率模型，该模型可用于对细胞中不同基因的特定表达水平进行建模，并提供了一个灵活而有效的方法来估计每个基因的平均表达水平。这种模型考虑了测序数据、序列相似性、误差、样品之间相关性等多种影响因素，能够更准确地估计不同基因的特定表达水平。

# 2.介绍

## 2.1.系统框图


流程图展示了将原始RNA-Seq数据映射到基因表达水平的整个过程。首先，使用单碱基水平检测(SBS)方法或Paired-end reads的方法对原始RNA-Seq数据进行测序。然后，通过计算核苷酸间距分布以及质量控制分析(QC)来处理序列数据。接下来，将序列数据转换为序列矩阵，其中每行对应一个基因，每列对应一个序列。此时，就可以利用概率模型估计基因的特定表达水平。

## 2.2.概率模型

### 2.2.1.基本假设

我们认为，不同基因在同一细胞内具有不同的表达水平，这些表达水平由以下三个基本因素共同决定：

1. 基因序列
2. 核苷酸与核苷酸之间的距离
3. 其它影响RNA-Seq数据质量的因素

特别地，我们假设如下：

1. 在同一细胞中，不同的序列因子会导致不同位置上的碱基出现不同种类的碳水化合物，从而导致不同的基因表达水平。这些因子包括具有特定功能的核糖核酸转移酶(TF)、RNAPol II修饰体以及C调制酶等。
2. 核苷酸与核苷酸之间的距离有可能影响基因的表达水平。一方面，短距离的核苷酸有助于抗原抑制，另一方面，距离核苷酸越远的基因则需要更多的环境信息才能产生有效的表达。
3. 测序过程中产生的错误也会影响基因的表达水平。在PCR扩增的过程中，由于扩增的顺序不确定，可能会发生错配。其他一些如PCR偏好性、RT PCR引入以及PBC效应等因素都会影响测序数据。
4. 细胞间有着复杂的互作作用，不同细胞类型之间的差异会进一步影响基因的表达水平。

### 2.2.2.概率模型的概述

我们可以把RNA-Seq数据看作是观察到基因表达情况的一个随机变量，其取值是在一定范围内的实数。对于每一个基因，都可以用一个高斯分布来描述其特定表达水平。我们假定每一个基因的表达水平服从如下的概率分布：
$$p(x|b_i)=\frac{1}{Z}\exp(-\frac{(x-a_{i})^2}{2\sigma_{i}^2}),$$
这里$x$是测序到的某个碱基的碳水化合物计数值，$b_i$表示基因$i$的平均值，$\sigma_i$表示基因$i$的标准差，$a_i$表示基因$i$的零点，$Z$是一个归一化常数，保证对所有基因来说概率之积为1。

根据上述假设，我们可以构造如下概率模型：

**模型1：** 每个基因的表达水平服从高斯分布。即：
$$x_i \sim N(\mu_i,\sigma_i), i=1,2,...,n,$$
其中$\mu_i$表示基因$i$的平均值，$\sigma_i$表示基因$i$的标准差。

**模型2:** 每个位置的碱基由一个高斯分布生成，并且所有位置共享相同的参数。即：
$$x_{ij} \sim N(\mu_{ij},\sigma_{ij}), j = 1,2,...,m.$$

**模型3：** 每个碱基的计数值由基因序列和核苷酸间距分布共同决定。核苷酸间距分布由核苷酸残基距离和核苷酸结构预测所得，而核苷酸残基距离又受测序位点间的相互作用影响。这里我们假设测序位点间的相互作用是各向异性的，即不考虑任何顺序关系。因此，核苷酸间距分布服从如下的混合高斯分布：
$$p(d|\gamma)=\sum_{\alpha}w_\alpha\mathcal{N}(d|\mu_\alpha,\Sigma_\alpha), d>0$$
其中$d$是核苷酸间距，$\gamma$是测序所得的核苷酸序列，$w_\alpha$表示第$\alpha$个混合分量的权重，$\mathcal{N}$表示高斯分布，$\mu_\alpha$和$\Sigma_\alpha$分别表示第$\alpha$个混合分量的均值和协方差矩阵。

**模型4:** 我们假设每一条序列数据都有一个特定的误差率，即测序到某一位置的计数值$x_{ij}$与实际计数值的差异为$e_{ij}=x_{ij}-c_{ij}$, $c_{ij}$是真实的计数值。此外，我们还假设测序过程中有噪声的影响，其中噪声指的是测序平台、分析算法、测序质量、PCR偏好性等等因素引起的测序过程中的统计偏差。于是，模型4给出了测序数据的联合概率分布：
$$p(x,d,e|\theta)=p(x|b)\prod_{i=1}^{n}p(d_i|\gamma)|e_i|, x=(x_{1j},x_{2j},...,x_{mj}); e=\left\{e_{ij}\right\}_{ij}$$

## 2.3.估计基因的特定表达水平

### 2.3.1.模型选择

不同的数据集可能具有不同的特性，比如基因数量、数据量、结构特征、染色质结构、数据质量等。因此，我们需要依据这些数据特点选取合适的模型。比如，在缺乏关于TF和作用原理的信息的情况下，我们通常采用模型1；而在考虑到核苷酸间距分布信息的情况下，我们则采用模型2和模型3。具体到本文，我们建议采用模型3作为最终模型，原因有两个：第一，它既考虑了序列因子的影响，也考虑了核苷酸间距分布信息；第二，模型3的计算开销很小，而且可以用现有的软件包进行快速实现。

### 2.3.2.计算方式

对于模型3，可以计算出整个基因组每条序列的核苷酸间距分布，这个分布可以通过生物信息工具包，比如Infernal或ViennaRNA计算得到。这些分布对于后续计算非常重要。而对于每个基因的特定表达水平，我们可以直接利用模型3计算平均值和标准差，不需要进一步处理。如果希望进一步了解模型的具体计算方式，欢迎阅读原论文的参考文献。

### 2.3.3.代码实现

为了方便测试与评估，我们准备了R语言下的R包`GeneExpModel`。这个包提供了两种算法，分别是线性回归（linear regression）和最大熵（maximum entropy）。具体地，通过设置参数，用户可以指定估计的基因数量、使用模型、调整参数等，之后便可以得到估计结果。

# 3.展望与未来方向

在本文中，我们提出了一种新的概率模型，旨在估计RNA-Seq数据中基因的特定表达水平。模型考虑了测序数据、序列相似性、误差、样品之间相关性等多种影响因素，能够更准确地估计不同基因的特定表达水平。此外，我们还展示了如何用现有的软件包R语言中的GeneExpModel包实现模型的快速估计。最后，我们将我们的模型与现有的基因表达水平估计方法进行了比较，发现了一些明显优势，如模型鲁棒性强、拟合速度快、不依赖于复杂的数据库等等。但同时，我们也注意到模型还存在着一些局限性，如对背景数据要求高、对其它影响因素的估计不足、难以解释估计的结果等。针对这些局限性，我们将在未来的工作中继续进行研究。