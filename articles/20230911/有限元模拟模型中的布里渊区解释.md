
作者：禅与计算机程序设计艺术                    

# 1.简介
  

布里渊区(V-Cycle)是许多有限元模拟方法的关键所在。它是指将网格划分成多个子网格区域，每个子网格区域中都是固定的单元格，而其他网格区域则由相邻的子网格区域衔接而成，如此不断细化网格区域，逐步形成新的子网格区域，直到整个网格区域被细分为一个个具有固定单元格的“孤岛”，即布里渊区。布里渊区在有限元模拟方法中起着重要作用。

传统的有限元法通常采用经典的贪心策略迭代求解的方式，即首先求解完整网格区域上的自由度，然后对这些自由度进行重新排序和分类，最后在较小的“孤岛”上应用高斯-赛德尔迭代法等优化方法。由于这种计算量很大，在网格较大时效率低下，因此有限元模拟方法采用了一种更有效的方法——布里渊区法（V-Cycle）。本文将详细介绍布里渊区的具体原理和应用。

# 2.基本概念术语说明
## （1）布里渊区法
布里渊区法（V-Cycle）是目前最常用的有限元模拟方法。该方法的基本思想是先建立起稠密网格区域，逐步细化，直至得到完全嵌套在一起的孤岛。在每一个阶段，即V-Cycle的不同阶段，都可以按照如下步骤进行：
1、自适应网格生成：从原始的粗糙网格开始，不断细化网格大小，形成多个子网格区域；
2、自由度分解：对于每一个子网格区域，建立相应的单元阵列，并确定每个单元格上的自由度。自由度的数量随着网格细化程度的增加而增多；
3、矩阵生成：通过差分方程构建局部刚度矩阵和局部拉普拉斯矩阵，即近似的局部全反射算子和局部电磁场。
4、边界条件处理：根据边界条件和自由度的约束关系，设置单元阵列上的边界条件。
5、单元矩阵求解：依靠局部刚度矩阵和边界条件，用迭代或矩阵分解的方法，解出单元阵列的响应函数。
6、全局矩阵求解：基于所有单元阵列的响应函数，构造全局刚度矩阵和拉普拉斯矩阵，并利用它们进行后处理，完成网格区域的求解。
7、收敛判断：若全局矩阵已经收敛，则进入下一个V-Cycle阶段；否则继续迭代或者降低精度。
## （2）稠密网格
当网格区域足够大时，才能较好地进行有限元模拟。通常情况下，稠密网格是指各个单元格之间距离均匀，且网格尺寸较大。对于弱形式的有限元方法，稠密网格的形状可能是任意的。但对于高阶有限元方法，则需要满足一些特殊的要求，比如符合支撑函数的几何形状等。

对于一般的矩形网格，如以下网格为例：
其稠密性质可以从两个方面观察：
1. 各个单元格的面积与网格尺寸成正比。
2. 每个单元格的中心到四个顶点的距离均匀。

## （3）自由度分解
布里渊区法的核心问题之一就是如何确定每个单元格上的自由度。自由度的数量与网格的划分、网格的粗糙程度和刚度矩阵的复杂程度密切相关。自由度分解也称为自由度分配。

举个例子，假设有一二维离散元模型如下图所示：
其中，左图显示了一个线性的双曲型有限元场，右图显示了一个三次元的Hermite有限元场。在前者中，各个单元有三个自由度，分别对应于该单元左边、右边、底边的法向量方向。而在后者中，各个单元有六个自由度，对应于每个单元面的法向量和位移方向。

可以看出，自由度越多，则网格元素的容纳能力就越强，模拟结果就越精确。因此，自由度的分配以及网格的设计都是十分重要的。

## （4）局部刚度矩阵与局部拉普拉斯矩阵
在布里渊区法中，网格区域被划分为不同的子网格区域，也就是说，每个子网格区域内都有一个对应的刚度矩阵和拉普拉斯矩阵。这两类矩阵，既与网格区域的定义息息相关，又受单元阵列的自由度分布影响。

### Ⅰ、局部刚度矩阵
局部刚度矩阵是指用来描述单元阵列的刚度依赖于单元的自由度分布情况的矩阵。对于二维情况，它的矩阵组成是

对于局部刚度矩阵，相应的差分方程可表示为

其中，∇u为单元坐标系下的单元导数，xij为基函数，φi为第i个基函数。由局部刚度矩阵，就可以得到局部的刚度梯度场，即局部导数

### Ⅱ、局部拉普拉斯矩阵
局部拉普拉斯矩阵是用来描述单元阵列的电磁场的依赖于单元的自由度分布情况的矩阵。对于二维情况，它的矩阵组成是

对于局部拉普拉斯矩阵，相应的差分方程可表示为

其中，ηij为单元坐标系下基函数i对基函数j的连续性，φi为第i个基函数，φj为第j个基函数。由局部拉普拉斯矩阵，就可以得到局部的电磁场，即局部旋度场

## （5）边界条件处理
在网格求解过程中，通常还需要考虑边界条件。布里渊区法中，边界条件往往只涉及少数几个自由度，所以处理起来比较简单。

举个例子，假设我们要模拟下面的二维平行板结构：
其中，左边的板是接触边界，右边的板是截流边界，中间的板是自由边界。对于任意一点q，可以看出边界板上的自由度只能属于右边或中间板。因此，右边板上的边界条件可以直接赋给相应的单元。同样的，左边板上的边界条件可以在内部自由边界单元中赋予合适的值，即使不知道边界板上的电荷密度，也可以给出一个合适的估计值。