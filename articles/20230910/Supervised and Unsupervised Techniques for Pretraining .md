
作者：禅与计算机程序设计艺术                    

# 1.简介
  

Graph Neural Network (GNN) 是近几年越来越火热的一种用于处理图结构数据的神经网络模型。由于 GNN 的普及性，其在学术界和工业界都取得了突破性的进步。为了使得 GNN 模型在应用场景中得到更好的效果，研究人员们提出了各种预训练方法，其中包括无监督方法（如图采样、对比学习）、半监督方法（如节点分类任务）等。本文主要讨论了图神经网络模型预训练中的有监督和无监督方法。

# 2.相关知识
## 2.1 有监督预训练
### 2.1.1 节点分类任务
给定一个图 $G=(V,E)$ 和节点特征矩阵 $X\in R^{n\times d}$，节点分类任务就是训练一个模型$f_\theta(x)=y$，使得模型能够根据节点的特征向量 $x$ 来预测节点类别 $y \in Y$。分类准确率可以衡量模型的好坏，并作为评价指标。节点分类任务的输入数据一般包括两个部分：图 $G$ 和节点特征矩阵 $X$。通过训练得到的模型可以用于节点分类、节点划分、节点聚类、节点预测等任务。

### 2.1.2 链接预测任务
给定一个图 $G=(V,E)$ 和边标签矩阵 $Y\in R^{(e)\times c}$，链接预测任务就是训练一个模型 $g_\phi(e)=z$ ，使得模型能够根据边 $(u_i,v_j)$ 的特征向量 $[e_{ij}]$ 来预测该边的标签 $z\in Z$ 。标签准确率可以衡量模型的好坏，并作为评价指标。链接预测任务的输入数据一般包括三个部分：图 $G$、边标签矩阵 $Y$ 和边特征矩阵 $E$。通过训练得到的模型可以用于边分类、边预测、社区发现、图可视化等任务。

### 2.1.3 节点分类与链接预测联合训练
同时训练节点分类模型和链接预测模型可以帮助提高模型的能力。但是如何将两者进行联合训练，尚未得到明确的解决方案。目前，主要的做法是在预训练阶段只训练节点分类模型，然后微调得到预训练模型；或者先微调节点分类模型，再重新训练得到预训练模型。

## 2.2 无监督预训练
无监督预训练主要包含两种方法，分别是图采样方法和对比学习方法。
### 2.2.1 图采样方法
图采样方法直接从原始图 $G=(V,E)$ 中抽取子图。例如，可以在固定数量的边上随机取子图，或者从图上随机游走获取子图。这种方式获取的子图往往存在很强的负采样效应，因此通常不会用于预训练模型。
### 2.2.2 对比学习方法
对比学习方法利用一个已有的模型来构造相似的新模型，然后基于新模型进行预训练。例如，对比学习可以学习到不同图上的相似性，然后利用这个相似性构造新的图嵌入。已有的工作证明了这种方法可以有效地生成合适的图嵌入，但它需要巨大的计算资源和时间。另外，许多工作表明，对比学习方法无法完全捕获图的真实结构信息。
# 3.相关工作
之前关于预训练的工作主要集中在图分类任务上。文章选取了以下几个方面作为自己的贡献：
1. 提出了无监督方法，即图采样方法和对比学习方法，作为增广的预训练方式，有效避免了传统无监督方法的缺陷。
2. 将两种方法进行了联合训练，并分析了两种方法之间的优劣。
3. 对比学习方法的一系列方法设计和实现，表明了它的有效性。
4. 在节点分类任务和链接预测任务上分别进行了实验，验证了图神经网络模型预训练中的有监督和无监督方法的有效性。