
作者：禅与计算机程序设计艺术                    

# 1.简介
  

分子动力学(Molecular dynamics)是研究分子运动的学科领域，其方法基于原子粒子的相互作用，通过一定时间的微观运动模拟，研究各类化学和生命系统的运动规律，从而解答各种复杂的生物体的结构、功能、制备过程等。分子动力学被广泛应用于生物工程、药物研发、医疗健康领域。在本文中，我将介绍这一领域的一项重要研究工作——“小分子电转移率计算”。

# 2.分子动力学的主要术语与概念
分子动力学(MD)，又称为经典MD，即用经典力学模拟构型的晶格中的自由粒子在时间上的微观运动。MD的关键是对晶格结构中存在的分子微观行为进行力学建模并进行量子化处理，利用量子力学的原理对时空上的多种运动状态进行描述。主要术语与概念如下:

1）分子：指具有无机性质、液体性质或气体性质的共同体，其构成由原子组成。一般来说，分子由原子核、胞膜、分子链、水分子、蛋白质、蛋白质酶、基因、核糖体等等组成。

2）原子：指能够产生半正子或全正子的自旋、电子或质子电荷的最小单位。原子核是原子的最外层的一个层。每个原子核内都有一些电子与离子双向共存，两者之间的交换由三重相互作用(轨道、旋转和吸引)完成。

3）自由粒子：指那些没有像电子或质子那样位置固定、能量传递的粒子。例如，有色无机粒子、分子链、DNA、酶体的组成分子。

4）半径向上排列的粒子：指带电荷的粒子；由一或两个半径向上排列的电子组成。半径向上排列的粒子的运动则受到它们与周围无序电荷的吸引力，受到其他半径向上排列粒子的引力以及静止质点引力的影响。

5）维数：指不同原子的数量，通常取值为3n+1。它代表一个晶格中可供粒子自由运动的方向的数量。n是整数，代表原子的总数。如在三维晶格中，维数n=3。

6）系统（即分子体系或分子团）：指分子所组成的集合体。其中包括原子、分子链及连接分子的自由粒子等。系统的某种状态定义了该系统的所有能量，而系统的某个特定的能量范围也叫做轨道。系统的初始状态称作平衡态（equilibrium state）。

7）布里渊区：一种电子晶格，位于晶格主导结构中，用于生成费米子，促进粒子运动。

8）势能（potential energy）：是系统所存储的能量。在分子动力学中，势能用来描述系统的总能量随时间变化的规律。可以把势能看成是系统的“引力”，势能越高，系统的平均速度就越慢。

9）分子动力学方程：在给定初态（即系统的平衡态）下，分子动力学方程描述了系统在各个时间步长的运动情况。它依赖于系统的总能量、各个粒子的位置和动量、系统中存在的能级及势能等。

10）初始条件：在分子动力学实验中，初始条件是决定系统运动的重要依据。系统的初始位置、姿态、温度、压强、振动等都直接影响着系统的运动特性。

11）能量：在分子动力学中，能量是指系统的总体积，表示所有能量的总和。它既可以表示系统的固有能量，也可以表示系统的熵增加。系统总能量的大小反映了系统当前处于的热运动阶段，热运动阶段越低，系统的平均速度就越慢。

12）聚合：聚合是指物理上两个原子或分子之间的碰撞、摩擦，产生新的原子或分子。在分子动力学实验中，聚合被用来描述粒子在空间中形成的相互作用。它主要由受力原子产生，而受力原子对周围环境和其他原子进行势能作用。

# 3.分子动力学算法
经典MD的基本流程：

（1）选取适当的原子模型、初始条件、时间步长等；

（2）确定晶格结构；

（3）对每个原子的坐标、速度和角速度进行初始化；

（4）利用总能量方程进行一系列电子步（每一步选取两个原子、更新位置、速度），直至达到终止时间；

（5）根据半径向上排列的原子的运动规律及其他信息，确定整体的运动规律。

分子动力学的小分子电转移率计算算法的具体操作步骤和数学公式讲解：

1.构建自由度矩阵R。R是一个n*m的方阵，其中n和m分别表示原子数目和自由度数目。第i行j列的元素值表示原子i的第j个自由度。对于不同的粒子模型，自由度的定义可能不同。这里采用二阶描述模型，则自由度数目为6，即原子i的6个自由度分别为（x，y，z，vx，vy，vz）:

$$R=\left[\begin{array}{ccc}
1 & 0 & 0 & 1 & 0 & 0 \\
0 & 1 & 0 & 0 & 1 & 0 \\
0 & 0 & 1 & 0 & 0 & 1 \\
\vdots & \vdots & \vdots & \ddots & \vdots & \vdots\\
0 & 0 & 0 & 0 & 0 & n-1 \\
n-1 & (n-1)^2 & (n-1)^3 & \cdots & 0 & 0 \\
\end{array}\right]$$

注：n表示原子数目，自由度数目为n*(n+1)/2。如此一来，自由度矩阵R的维数就确定了。

2.设置参数：

（1）原子半径、单位长度、气体常数；

（2）速度、时间步长；

（3）电子常数、玻尔兹曼常数。

3.初始化参数：

（1）随机选取m个原子作为自由度，并确定它们的坐标、速度和角速度。

（2）将其他原子的坐标、速度设置为零。

4.模拟电子步：

（1）选取两个自由度x和y，计算电子的距离r和半径。如果r小于电子半径，则不允许这两个自由度相互作用。

（2）计算引力场Fij。采用周期性的勒让德赫斯电子势近似，计算这两个自由度之间的受力。Fij就是电子i对电子j的引力。

$$F_i=-\frac{\epsilon}{\sqrt{|\mathbf r_{ij}|}}(\mathbf v_{ij}-\alpha (\mathbf r_{ij})^{\perp})\cdot \frac{q_iq_j}{\mathbf r_{ij}}$$

$$F_j=-\frac{\epsilon}{\sqrt{|\mathbf r_{ij}|}}(\mathbf v_{ij}+\alpha (\mathbf r_{ij})^{\perp})\cdot \frac{q_iq_j}{\mathbf r_{ij}}$$

$$F_{ij}=\frac{-\epsilon q_iq_jq_k}{\sqrt{|r_{ij}||r_{jk}|}}(\mathbf v_{ij}-\mathbf v_{ik})\cdot \frac{(r_{ij}r_{jk})^{\perp}}{|\mathbf r_{ij}|-|\mathbf r_{jk}|+\delta}$$

$\epsilon$是玻尔兹曼常数，$q_i$是电子的质量，$(\mathbf v_{ij}-\mathbf v_{ik})$是电子i和j的粘度矢量。勒让德赫斯势近似，即电子距离越远，势能越小。由三重相互作用，得到六个相互作用量。

（3）计算总能量U。对于原子i、j及相互作用量，得到总能量U。

$$U=\sum_{i<j}(a_{ij}f_if_j+\frac{1}{2}b_{ij}q_iq_j)+\frac{1}{2}\sum_{i<j}(c_{ij}|\mathbf v_{ij}|^2+\frac{d_{ij}}{2}|\mathbf p_{ij}|^2)$$

$a_{ij}$和$b_{ij}$是原子i和j之间的原子核与分子链之间的磁场张力，c_{ij}、d_{ij}是原子i和j之间的偶极矩。

（4）计算总电荷q。根据电子动量定理，对于任意两个自由度x和y，有以下关系：

$$q_ix_iy_i=-q_iy_ix_i=2q_i\mu_i^2\omega_i^2-\frac{h^2}{m_e}\delta_{ij} $$

由动量守恒定律，有：

$$\frac{dq_i}{dt}=2q_i\mu_i^2\omega_i^2-\frac{dh^2}{mdt} $$

利用$\frac{dh^2}{mdt}=kT/\gamma m_e^2$，有：

$$q_i\frac{d\mu_i}{dt}=-q_i\frac{dk_i}{dt}$$

那么，在电子步之后，任取两个自由度x和y，有：

$$\frac{d\mu_i}{dt}=\frac{d\mu_j}{dt}=-\frac{q_iy_jx_j}{q_iy_ix_i}\frac{dx_jdy_i}{dy_jx_j} $$$$ + \frac{q_ix_jy_j}{q_ix_ix_i}\frac{dx_idy_j}{dy_ix_j} - \frac{q_i x_i y_j}{q_i x_j y_i}\frac{dv_jx_j}{dx_jy_j} - \frac{q_i y_i x_j}{q_i y_j x_i}\frac{dv_jy_j}{dy_jx_j} + \frac{2q_i}{r_{\rm ij}}\frac{d\theta_i}{dt}$$

因此，可以得到总电荷q随时间变化的曲线。

5.绘制电荷分布图。画出电荷q随时间变化的曲线。

6.求解电转移率。当电子步足够多时，就能看到电荷分布图的特征出现，即出现谐振子现象。分析这个谐振子，就可以求得电转移率。电转移率实际上是一个信号，它反映了电荷分布图的谐振频率，即电子在晶格上的平均运动速率。由于小分子，所以需要更多的电子步才能使电转移率有较好的测量精度。

# 4.小分子电转移率计算实例

下面我用水溶于氢气的系统演示一下小分子电转移率计算的过程。

（1）选取适当的原子模型、初始条件、时间步长等。这里用二阶描述模型，用固定速度的小分子构成氢气，氢气的速度为常数，时间步长为$10^{-18}$s。

（2）确定晶格结构。用勾股定理建立晶格，晶格边长为常数。

（3）对每个原子的坐标、速度和角速度进行初始化。令所有原子的坐标和速度设置为零，角速度沿z轴正方向匀速运动。

（4）模拟电子步。每一步选取两个自由度x和y，计算引力场Fij。

（5）绘制电荷分布图。画出电荷q随时间变化的曲线。

（6）求解电转移率。找到谐振频率，即电子的平均运动速率。由于二阶模型，电子的平均运动速率约为$\sim10^{14}$ cm/s。


# 5.未来发展趋势与挑战

分子动力学的研究一直处于蓬勃发展的时代，它是研究各类化学和生命系统的运动规律的重要工具。但是，它的局限性也很明显，无法用于描述真实世界中复杂的系统，比如分子结构、分子状态、分子浓度以及分子运动的多种模式。另外，随着计算机技术的发展，模拟量子体系的模拟技术也逐渐成为分子动力学研究的一个新领域。因此，未来分子动力学研究还会面临许多挑战，主要有以下几点：

1）非正交坐标：目前，分子动力学研究基于晶格坐标，这类坐标比较简单，而且有限个方向上只能探测到原子的运动规律。然而，真实世界中的分子并不是这样的简单，它可以沿着不同方向快速移动，因此，更高维度的非正交坐标就成为了未来的方向。

2）量子化学：量子化学的理论基础是量子力学，它提供了一种量子化模型，将传统力学变成量子力学的数学模型。在这种模型中，电子的波函数被替换成一个离散的量子态。因此，量子化学可以用于更好地研究分子的运动规律。量子化学将再次影响分子动力学的研究，尤其是在计算小分子电转移率时。

3）轨道加速器：轨道加速器的研究，旨在把量子动力学、高能物理、量子纠缠以及其他领域的知识结合起来，开发一种高能原子，其动能高达2500eV，能够捕获量子态中的超导光子。这种原子将为分子动力学研究带来巨大的发展。

# 6.常见问题与解答

Q1.如何选择合适的时间步长？
A1.时间步长的选择对系统的稳定性和计算精度都非常重要。过大的时间步长容易导致系统震荡，而过小的时间步长可能无法描述分子的运动。所以，时间步长的选择应该根据具体问题进行合理的设计。一般来说，时间步长应该足够小，同时又不能太小，否则计算结果将不可靠。

Q2.设想一种只含氢原子的极端情况下的分子系统。该系统的自由度数目为多少？
A2.自由度数目一般等于原子数目的二倍，因为每个原子都对应两个自由度。对于只有一个氢原子的系统，自由度数目为1。

Q3.模型与常数的选择对结果有什么影响？
A3.模型的选择可能会影响结果的准确性和计算效率。选择合适的模型既要考虑研究的复杂性，也要考虑计算的资源开销。常数的选择也应注意与实验中数据相匹配，否则结果将不可信。