
作者：禅与计算机程序设计艺术                    

# 1.简介
         

TOPSIS（Technique of Order Preference by Similarity to the Ideal Solution）是一种多目标决策的方法，可以用于评估多种条件下多个方案的优劣。与其它多目标决策方法比如Pareto Front(帕累托前沿)和Vikor等不同，TOPSIS考虑所有目标的影响，并综合考虑各个目标之间的相互关系。
其基本思想是基于距离测度来衡量各个目标的相似度，并据此确定每个目标的排序，最后将具有最高分值的方案作为最终的输出结果。
# 2.多目标决策中的术语说明
## 定义
* **问题**：一个或多个目标、约束条件及其权重构成的一个优化问题；
* **目标**：指代某种性质或效益的值；
* **约束条件**：限制条件，如不能超过的上限或下限；
* **权重**：表示不同目标重要程度的系数，是一个实数值向量；
* **代价矩阵**：描述各个方案的性能，由每个目标的评分构成的一组实数值向量组成；
* **最佳方案**：具有最大化期望利润或最大化期望收益的方案；
* **最优解**：在给定约束条件下的最佳方案。
## 示例
假设有以下两个项目：
* 项目A：
* 目标：推广新品、降低广告费用、增加销售额、提升忠诚度；
* 约束条件：推广时间、广告数量、市场份额、投入精力、广告有效性；
* 权重：[0.1, 0.2, 0.3, 0.1, 0.2]
* 项目B：
* 目标：扩充库存、降低风险、提高效率；
* 约束条件：库存容量、运输成本、管理费用；
* 权重：[0.2, 0.2, 0.2]
## TOPSIS算法操作步骤
### 1.计算相似度
1.1 求每一个目标i对于整体目标的贡献度
$$d_i=\frac{\sum_{j=1}^{n}w_jx_{ij}}{||\vec{w}||}$$
1.2 将所有的目标的贡献度取负号，得到最小化目标，即求最大化目标贡献度
$$C=-\max d_i$$

2.计算理想最优解
2.1 根据最优目标贡献度的定义，求得理想最优解
$$S^+=(\max w_ix_j-\min w_jx_j)/(\max w_jx_j-\min w_jx_j),j=1,2,...,m; i=1,2,...,k$$

3.计算非正态化处理后的代价矩阵
3.1 对代价矩阵每一行进行标准化处理
$$x_{ij}^'=\frac{x_{ij}-\mu_i}{\sigma_i},j=1,2,...,m; i=1,2,...,k$$
3.2 计算正态化后代价矩阵的均值和方差
$$\mu'_j=\frac{1}{m}\sum_{i=1}^mx_{ij}^', j=1,2,...,m$$
$$\sigma'_j=\sqrt{\frac{1}{m}\sum_{i=1}^m(x_{ij}^'-\mu'_j)^2}, j=1,2,...,m$$

4.计算距离
4.1 计算每一个方案与最优解的欧氏距离
$$d_s=\sqrt{\sum_{i=1}^kd_{ij}(x_{si}^')^2}$$
4.2 计算各个方案的总距离之和
$$D_s=\sum_{s=1}^{n}d_s$$

### 5.确定最优方案
5.1 按照最优方案距离的大小顺序排列所有的方案
5.2 从前到后判断每个方案是否比上一个方案更优，如果更优则记录该方案的索引号。
5.3 如果还有方案没有被记录过，则选中最优方案。
5.4 返回第五步中记录的方案的索引号。