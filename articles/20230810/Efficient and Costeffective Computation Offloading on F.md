
作者：禅与计算机程序设计艺术                    

# 1.简介
         

## 概述
Fog computing (云服务中的Fog网关)是一种基于云计算技术的新型网络服务，可以将物联网、移动互联网等外界数据集中存储到中心云端进行处理分析，而在本地保留计算资源，形成一个分布式的数据处理系统。这种网络服务具有高可靠性、低延迟、弹性扩容等特点，能有效减少用户访问中心云服务的延时和网络拥塞。然而，由于云端资源的限制（如带宽、内存），传统的Fog-to-Cloud gateway network不得不对计算任务进行部分卸载，即利用边缘节点的计算能力完成预测分析或实时处理。
现有的研究大多侧重于计算任务的设计和优化，而忽略了实际执行过程中耗费大量计算资源的问题。如何更好地提升性能并降低成本，是当前Fog-to-Cloud gateway network的一个重要课题。因此，作者在此提出了一个基于fog-to-cloud gateway network的新颖的模型，该模型能够估计计算任务在边缘节点上的运行时间及其资源消耗，并据此确定需要卸载的任务及其对应的预算。之后，作者通过实验验证了其模型的准确性和稳定性。
本文基于该模型，详细阐述了计算任务的卸载策略、预算分配方式、资源消耗估计方法等方面，并给出了一个实际案例。本文的目的是希望能够提供对于Fog-to-Cloud gateway network的计算卸载方面的最新研究成果，为目前已有研究的进一步推进提供参考。
## 研究背景
当前Fog-to-Cloud gateway network主要存在以下三个挑战：

1. 计算任务的资源消耗估计方法难以准确，尤其是在实际执行中。
2. 计算任务的资源消耗与网络带宽成反比，这会导致冗余计算资源的浪费。
3. 缺乏真正的综合考虑，通常只按执行时间预算分配资源。

为了解决上述问题，本文从两个方面提出了相应的解决方案。第一，针对第二个挑战，本文采用了一系列的统计手段对计算任务进行分类并计算出每个类别的平均计算资源消耗。然后根据不同类的任务分别设置不同的预算。第二，针对第三个挑战，本文提出了一种新型的预算分配方式——后向预算分配法。后向预算分配法根据预期的使用情况设置一个长期的预算，将其分摊到各个任务上，同时考虑每种类型任务的权重、任务优先级等因素，使任务得到公平的分配。
## 模型简介
### 数据集信息
本文的研究所用到的测试数据集包括20个IoT设备，共120个任务，每个任务是一个传感器读数采集任务。传感器类型和数量均为自定义生成，每台设备的数据量大小为10MB，每个设备产生的数据量大小约为1GB。下表给出数据集的信息。

| 属性 | 值 |
| --- | --- |
| 总任务数 | 120 |
| 每台设备的任务数 | 20 |
| 每个任务的资源消耗（单位：ms） | 100 ~ 5000 ms |
| 边缘节点的CPU个数 | 20 ~ 80 |
| 边缘节点的内存大小 | 1GB ~ 10GB |
| 云端服务器的CPU个数 | 100 ~ 1000 |
| 云端服务器的内存大小 | 20GB ~ 800GB |

### 模型框架
#### 计算任务的生命周期
首先，本文定义了计算任务的生命周期。计算任务从生成到消亡的整个过程称之为生命周期，它由以下四个阶段组成：

1. 生成阶段：计算任务被提交到云端服务器。
2. 分配阶段：计算任务被调度到合适的边缘节点，并执行。
3. 执行阶段：计算任务运行在边缘节点上，在此过程中需要消耗CPU、内存资源。
4. 完成阶段：计算任务结束，离开边缘节点。

#### 任务分类与资源消耗估计
为了评估计算任务在边缘节点上的实际执行时间和资源消耗，作者设计了一种简单的方法——按任务类型分组。作者认为，不同类型的任务应该具有相同的时间开销，但它们所需的资源消耗却可能差异很大。例如，传感器读数采集任务需要处理大量的数据，但其它任务只需要花费较少的资源就能完成。因此，作者将传感器读数采集任务分为A类，其它任务分为B类。下图给出了不同类别任务的例子。


为了估计不同任务类型的资源消耗，作者定义了两种方法：第一种方法直接根据任务类型的资源消耗范围，将每一种类型的任务划分到某个数量级，再随机分配到一定的平均消耗水平；第二种方法结合某些已知的计算模型和规律，根据任务的特征估计它的资源消耗。


#### 任务预算分配策略
基于资源估计和任务分类，本文提出了一种任务预算分配策略——后向预算分配法。后向预算分配法通过设置长期的预算，将其分摊到各个任务上，同时考虑每种类型任务的权重、任务优先级等因素，使任务得到公平的分配。具体来说，先设置一个初始的大预算，随着任务的进行，如果出现某类任务资源消耗超过预算，则按资源消耗占比重新分配预算；如果出现某类任务资源消耗接近预算，则继续往下执行。在每次资源分配后，都要估计剩余预算的剩余空间是否还有足够的资源支持下一个任务的预算分配。若有，则进入下一次分配循环，直至所有任务的预算分配完成。

#### 模型的优点
1. 简单而直观：后向预算分配法不需要复杂的模型，易于理解。
2. 公平性：后向预算分配法可以充分考虑任务优先级、计算资源消耗、网络带宽等因素，保证所有任务的执行效率都得到保障。
3. 可扩展性：后向预算分配法具有良好的可扩展性，在大规模计算任务环境下也能取得较好的效果。