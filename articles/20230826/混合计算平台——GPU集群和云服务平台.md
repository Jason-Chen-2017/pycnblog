
作者：禅与计算机程序设计艺术                    

# 1.简介
  

## 1.1混合计算平台概述
混合计算平台是一个由多个计算资源构成的统一平台，可以提供高性能、低延迟、高可靠性的多种计算能力，包括分布式并行计算(HPC)和云计算服务。通过提供高性能计算、机器学习、大数据分析、金融交易等功能支持，实现经济可行的商业模式。目前，国内外的许多公司、机构都在布局或已经布局自己的混合计算平台建设。例如，华为正在布局自己的移动智能边缘计算平台，阿里巴巴正在布局云原生AI平台，腾讯也开发了自己的分布式超级计算机TeraGraph。当然，混合计算平台还可以作为基础设施层，支撑更多的应用场景，如人工智能自动驾驶、网络可靠性工程、医疗健康等领域。
## 1.2HPC（高性能计算）和云计算简介
### HPC简介
HPC是指通过集群系统、并行处理器等计算资源，对大型、复杂的科学计算任务进行并行化处理，从而解决大规模数据运算所需的时间与内存需求不匹配的问题。主要特点是系统可扩展性强、成本低、可靠性高。HPC应用的范围广泛，涉及物理学、工程学、天文学、生物学、农业等领域。
### 云计算简介
云计算是一种利用互联网技术，将计算机系统、存储设备、数据库和相关应用服务等资源分配给最终用户的计算模型。云计算按按需付费的方式提供计算、存储、应用服务等资源。云计算的优势在于按需获取资源，降低了硬件投资和运营成本，节约了资源浪费。目前，云计算已成为当前热门的IT技术之一。
## 1.3混合计算平台组成
混合计算平台由计算节点、网络连接、存储设备、管理软件等组成。其中，计算节点是运行计算作业的地方，由CPU、GPU、FPGA、TPU等处理单元组成；网络连接则是两个计算节点之间通过互联网相连；存储设备用于保存计算结果、输入数据和中间文件；管理软件负责监控、调度、管理计算资源，如任务分配、资源分配等。
图1 混合计算平台的组成
## 1.4混合计算平台优势
### 高效率
采用混合计算平台可以提升计算效率，尤其是在一些繁重的计算任务中。因为资源利用率较高，因此可以显著缩短计算时间；同时，使用云服务平台可以降低云端服务器的成本，避免过高的成本支出。
### 节省成本
采用混合计算平台可以节省成本，原因在于资源利用率高、费用较低。通过云服务平台的使用可以避免购买昂贵的本地服务器，也不会产生过多的IT经费支出。另外，云服务平台可以将数据中心整体作为一个整体进行运维，这有利于减少风险、提高安全性和可用性。
### 可扩展性强
混合计算平台的可扩展性强，可以根据需要增加、减少计算节点，并通过负载均衡等方式实现负载分担。这样，就可以在响应业务需求变化时实现资源动态平衡。
### 灵活性强
混合计算平台具有良好的灵活性，可以适应各种计算任务和工作模式。这使得它可以帮助企业更加快速地满足业务发展需要。
### 技术创新性
混合计算平台可以促进IT技术的创新性，特别是对于大数据和机器学习技术领域。这有助于提升企业的竞争力和长远发展能力。
# 2.基本概念术语说明
## 2.1集群软件包
### （1）登录节点
登录节点是访问集群的入口，负责集群管理和资源管理。登录节点通常安装有操作系统和管理工具，例如PSSH、Slurm、LSF等。
### （2）作业管理器
作业管理器负责调度并管理计算节点上的计算作业。计算作业一般分为两类：交互式和批处理。交互式作业要求即时响应，适用于运行一次后即退出的计算任务；批处理作业则在指定的时间间隔运行，完成后生成相应的文件输出。
### （3）编译环境
编译环境包括执行编译任务的编译器、构建工具、调试工具等。编译环境一般根据需要配置，有预装的版本或者安装包。
### （4）开发环境
开发环境包括运行应用程序的编译器、运行库和调试工具等。开发环境一般根据需要配置，有预装的版本或者安装包。
### （5）计算节点
计算节点就是执行计算作业的地方，由CPU、GPU、FPGA、TPU等处理单元组成。计算节点上通常安装有操作系统、并行软件包和语言运行环境。计算节点可以运行单个作业，也可以调度多个作业并行执行。
## 2.2SLURM命令
### （1）sinfo 命令：查看集群节点信息
```
[root@cnode ~]# sinfo -Nelh # 查看节点状态
PARTITION   AVAIL  TIMELIMIT NODES     STATE NODELIST
normal*      up    infinite  2         idle c[2-3]
```
### （2）scontrol 命令：查看集群任务队列信息
```
[root@cnode ~]# scontrol show job -dd --oneliner # 查看任务队列信息
JobId=71 NumberOfNodes=1 NodeList=(null) Default=NO ReqNodeList=(null)
    Command=/bin/sleep infinity
    JobName=sleep
    UserId=zgf UserGroup=zgf Priority=1111 Account=(null)
    MinMemoryPerNode=0 MaxMemoryPerNode=10000 MinCPUsPerNode=1 MaxCPUsPerNode=1
    State=RUNNING Reason=None Dependency=(null) Requeue=0 Restarts=0 BatchFlag=1
    ExitCode=0:0 Date=2021-08-04T03:54:27 EligibleTime=2021-08-04T03:54:24
    StartTime=Unknown EndTime=Unknown TimeStamp=Tue Aug  4 03:54:27 2021
```
### （3）sbatch 命令：提交批处理任务
```
[root@cnode ~]# cat sleep.sh
#!/bin/bash
srun /bin/sleep $((RANDOM % 10 + 1)) # 每个任务等待随机时长后退出
[root@cnode ~]# sbatch sleep.sh # 提交批处理任务
Submitted batch job 72
```
### （4）scancel 命令：取消任务
```
[root@cnode ~]# scancel 72 # 取消任务ID为72的任务
[root@cnode ~]# scancel --user zgf # 取消用户zgf的所有任务
[root@cnode ~]# scancel --name sleep # 取消名称为"sleep"的任务
```