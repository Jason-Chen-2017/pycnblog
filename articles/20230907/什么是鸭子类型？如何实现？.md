
作者：禅与计算机程序设计艺术                    

# 1.简介
  

鸭子类型（duck typing）也被称为“屎钩类型”，指的是一个对象只要“像鸭子一样走路”，那么它就可以作为函数参数、返回值或者变量类型使用。它的含义就是“当看到一只鸭子时，我就认为它一定是一只鸭子”。Python中，任何实现了某个接口的对象都可以赋值给函数、变量或者其他需要鸭子类型的地方。因此，使用鸭子类型不需要严格遵守类的继承体系结构，而只需要尽可能地模仿鸭子的行为方式即可。
# 2.基本概念及术语
## 2.1. 鸭子类型
鸭子类型定义：如果一个对象只要“像鸭子一样走路”，那么它就可以作为函数参数、返回值或者变量类型使用。这个定义比较抽象，我们举个例子来理解一下。

例如，现在有一辆汽车，我们需要通过函数传入到另一个函数中，我们期望传入的参数类型应该是一个Car类实例，那么就可以这样做：

```python
def run_car(car):
    car.run()
    
class Car:
    def __init__(self):
        self.running = False
        
    def start(self):
        self.running = True
    
    def stop(self):
        self.running = False
    
    def run(self):
        if self.running:
            print("The car is running.")
        else:
            print("The car is stopped.")
            
my_car = Car()   # create a new instance of the Car class
my_car.start()    # start the car
run_car(my_car)   # pass it to another function and expect an argument type of Car
```

运行结果如下所示：

```
The car is running.
``` 

从上面的例子我们可以看出，即使在不知道run_car()函数内部实现的情况下，只要my_car对象遵循Car类的接口规范（具有run方法），就可以将其作为参数传递给该函数。

## 2.2. 鸭子类型与继承
继承是面向对象编程的一个重要特性。由于使用了鸭子类型，父类并不会影响子类，反之亦然。因此，在编写代码的时候，应该尽量使用抽象类或接口，而不是直接继承父类。

例如，以下的代码不能正常工作：

```python
class Animal:
    def eat(self):
        pass
        
class Dog(Animal):
    def bark(self):
        pass

dog = Dog()
animal = animal(dog)  # error! cannot assign an object of type 'Dog' to a variable of type 'Animal'
```

因为Dog不是Animal的子类，但仍然可以使用isinstance()等函数判断它是否属于某个特定的类型。这是因为Dog对象虽然没有eat()方法，但是只要满足Animal类的接口规范（只要具有run方法），就可以赋给Animal变量。

为了解决这个问题，需要修改Dog类的定义，让它继承自Animal类：

```python
class Dog(Animal):
    def bark(self):
        pass

    def run(self):
        return "The dog is running."


dog = Dog()
animal = animal(dog)  # works now
if isinstance(animal, Animal):
    animal.run()     # prints "The dog is running."
else:
    raise TypeError('Expected an object of type Animal')
```

这里Dog类重新定义了run方法，而且它的返回值为字符串"The dog is running."。通过这种方式，我们成功地将Dog对象赋值给Animal变量。

最后，关于接口的定义。在编程中，经常会遇到一些需要特定接口才能执行某些操作的情况。比如，播放器需要遵循特定接口才能播放音乐，手机需要遵循特定接口才能拨打电话。一般来说，这些接口都会提供一些方法或属性供调用方进行相关操作。

因此，基于接口的设计模式可以帮助我们更好地组织代码，避免出现一些重复的代码，同时也能提高代码的可测试性。