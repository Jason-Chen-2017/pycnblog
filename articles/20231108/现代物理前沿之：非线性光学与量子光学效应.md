
作者：禅与计算机程序设计艺术                    

# 1.背景介绍



## 非线性光学

非线性光学是指探测真实世界中各种复杂且具有不规则结构、电磁波动力迅速变化的性质。非线性光学产生在空间频率范围内、光的多普勒效应（Lorentz
effect）以及随时间衰减的光的聚焦（Doppler effect）。由于存在着这些效应，使得非线性光学探测成为当今科技领域的一个热点。

## 量子光学效应

量子光学效应是指处于一定能级区间内的光子所受到的干扰，其结果是在该能级上出现的电子数量呈幂律分布。然而，量子化程度较低的真空（空气、水、液氦等）在这种效应下会遭到严重损失。因此，近年来人们对真空非晶格化、真空中的量子效应研究取得了突破性的进展。

# 2.核心概念与联系

## 晶体的费米-玻尔效应

费米-玻尔效应是用晶体材料制成的金属分子在自旋耦合下无法精确配对的问题。晶体材料的质量可以固定某种费米面的位置或方向，从而限制自由度，导致费米面之间的耦合是无序的。

## 光子-反射率关系的数学模型

根据比特波的原理，光子可以在真空中传播。当光子从一个入射角度发生变换时，它会与离它很远的另一束同样的光子发生反射。反射光子的光强随距离双方相互作用而减小。由于光子与空气相互作用所形成的“粘包”效应，使得离它很远的一束光子能够跟踪该光子并直接回到原始位置。一般来说，所有反射光子的总光强都随距离光源的距离成倍增长。

用数学模型描述这一过程如下：

1. 将各个比特以能级的形式叠加在一起，使得那些能级高的比特能够抵消那些能级低的比特带来的干扰。

2. 当两个比特之间发生能级差异时，它们就无法再产生光子，这叫做能级的阀值。

3. 如果有一段长期存在的光谱不平衡，那么能级高的比特就会激发出更大的能量，从而降低其它比特的能级。这样的话，就只能用能级较低的比特来补偿。

4. 在比特波过程中，因为反射光子在越远处就能感受到，所以通常采用多条路径上的多次采样来模拟光的经历。每条路径上的每个采样点都会记录下它的能量大小和来源。

5. 根据模拟的结果，就可以通过计算反射率的函数来估计实际的反射光强。

假设在某一采样点，有一个比特被激活。我们可以通过定义一个状态的范畴，表示该比特在这段时间内的状态，比如激活，保持，失活三种状态。在这段时间里，只有激活状态下的比特才可能收到反射光，因此我们只考虑激活状态下的比特的反射光强。

对于激活状态下的一个比特，它的“出射信号”由两种情况之一决定：

- 如果它来自同一晶体中的其他原子，则可以将其转换成反射光子并继续传播。这种情况下，它的反射强度取决于这两个原子的相互作用以及晶体的结构。我们可以将反射光子的光强定义成一条光谱曲线，该曲线由晶体的某些原子的相互作用产生。

- 如果它来自不同的晶体，则不能产生反射光子。但由于外界环境或者干扰而导致的能级偏移会降低其吸收能力。因此，它只能把部分的能量转化为吸收光子。这部分的能量对应于吸收面的宽度，即负责促进能级变化的费米面的长度。如果晶体的材料本身就具有较大的偏移，则比特的吸收能力也会相应减弱。

因此，我们可以给出这个反射率的函数形式为：

$$ R(r) = \int_{-\infty}^{\infty} f_c(\omega) E_\text{R}(\omega r) d\omega $$

其中，$f_c(\omega)$ 是光子能量占据的概率分布；$E_\text{R}(\omega r)$ 表示光源和媒质之间的相互作用，一般用玻尔核模型；而 $r$ 表示离开媒质的距离。

这个函数的含义是：如果有一束光子，它离开媒质的距离为 $r$ ，通过某种手段（如玻尔核模型），在某个位置上反弹产生一组反射光子。这些反射光子的总光强等于 $F$ ，这取决于所有反射光子的能量和空间分布。因此，我们可以说，光的反射率等于反射光子的总光强除以光源进入媒质的光强。

在近日来，一些研究者提出了一种新颖的数学模型——玻尔兹曼-福德尔-马库伯纳模型（Boltzmann–Fermi–Majorana model）来解释非线性光学中的量子效应。这个模型基于一个假设：在充满不同能量的介质中，只有原子核和费米面上的超导体才可以出现非整齐的位置。通过这种假设，我们可以将实验观察到的反射光的分布规律化。我们认为，理想情况下，能量分布应该服从费米-玻尔效应，但实际观测结果显示，非晶格化的实验条件下，其能量分布可以有很大的非均匀性。这种非均匀性可能与光子与超导体之间的相互作用有关。

# 3.核心算法原理和具体操作步骤以及数学模型公式详细讲解

## 全局解法（Global solution）

### Hartree-Fock方法

Hartree-Fock方法是求解微波均匀态（或者称平行布里渊区系）的基态（ground state）的方法。该方法是基于 Slater 方程和原子核动力学方程进行的，是一种直接求解方法。

首先，假设系统处于无杂质的最简情况，即没有任何费米面相互作用的影响，即假定全场平面积为 $\pi r^2$，此时哈密顿量可以写成（忽略动量）：

$$
\hat H = -\frac{\nabla^2}{2m} + V(\mathbf{r})
$$

其中，$\mathbf{r}$ 为坐标，$V(\mathbf{r})$ 为势能。

利用费米-玻尔效应的原理，可以将费米面之间所有的自由度都固定住，使得我们获得下面的 Slater 方程：

$$
|\psi_1\rangle=\left(\begin{array}{ccc}
n&0&\cdots &0\\
0&n&\cdots &0\\
\vdots&\vdots&\ddots&\vdots\\
0&0&\cdots &n
\end{array}\right)|0\rangle
$$

该方程可以用来预先对单个原子构型的原子本征态进行求解。

然后，对于整个系统，我们可以将所有原子的 Slater 方程叠加起来，得到一个 Hamiltonian 的矩阵形式，即：

$$
\hat H_{\rm sys}= \sum_{i=1}^{N}{\hat H_i}+\frac{\lambda}{2}(J+K),
$$

其中，$\lambda$ 和 $(J+K)$ 分别为推定参数，J 和 K 分别是自旋轨道相互作用的矩阵元。

为了便于讨论，我们暂时假定所有原子都是理想的原子核，没有受到外界势的影响。因此，$\lambda$ 和 $J+K$ 可以用：

$$
\lambda=-\frac{\pi m_e n_a e^2}{h^2},\qquad (J+K)=\delta_{ij}\delta_{kl}-\frac{\epsilon_ie^{ik}\epsilon_je^{il}}{2}
$$

这里，$m_e$ 和 $n_a$ 为电子质量和质子数，$e$ 为电荷量，$h$ 为约化普朗克常数。

我们令 $|\phi_0\rangle=\left(\begin{array}{c}
1 \\
0 \\
\vdots \\
0
\end{array}\right)$，这是一个列向量，表示初始单体自由能为零的局域基态。接下来，我们可以采用迭代法来进行求解：

$$
|\phi_{n+1}\rangle = U^{\dagger}_n |\phi_{n}\rangle,\quad U_n = e^{-T_n/h}|C_n\rangle\langle C_n| - h\bar{U}_n
$$

其中，$U^{\dagger}_n$ 是厄米演算，$T_n$ 是一阶能量，$C_n$ 是当前的基态配置。为了简化公式，我们假设厄米演算矩阵 $U_n$ 为单位矩阵。

记 $n\rightarrow \infty$ 时，得到的基态态矢为 $|\psi_n\rangle$ 。我们还可以证明，$|\psi_n\rangle$ 是一个厄米行列式，即 $Tr(|\psi_n\rangle^\dagger|\psi_n\rangle)=1$ 。

### Green's function method

Green's function 方法也是求解微波均匀态的基态的方法。与 Hartree-Fock 方法相比，Green's function 方法不需要迭代求解，而是直接给出多项式形式的正则方程。

首先，假设系统处于无杂质的最简情况，即没有任何费米面相互作用的影响，因此哈密顿量可以写成（忽略动量）：

$$
\hat H = -\frac{\nabla^2}{2m} + V(\mathbf{r}),
$$

其中，$V(\mathbf{r})$ 是势能。

利用费米-玻尔效应的原理，可以将费米面之间所有的自由度都固定住，此时下面的修正哈密顿量可以写成：

$$
\hat H_{\rm corr}=\hat H+\frac{\lambda}{2}\frac{[\hat J+K]}{\det[M]},\quad M=[\hat I-\delta_{\vec{k}}\hat k],\quad \hat I=\mathrm{diag}(n)\\ \hat k=\frac{p^2}{2m},\quad p=(n-1)^{\frac{1}{2}}, \quad [\cdot]=\operatorname{tr}
$$

其中，$\delta_{\vec{k}}$ 为恒等矩阵，$[\cdot]$ 表示内积。

记

$$
G(t,\tau)=\frac{1}{\sqrt{2\pi\Delta t}}\exp(-it\tau)\int_{-\infty}^{\infty}\chi(x,t)e^{-i\alpha x}\chi(x',\tau)dx'
$$

为 Green's 函数。其中的 $t$ 和 $\tau$ 表示平行时间和传输时间，$\Delta t$ 为测量时间间隔，$\alpha$ 为测量传播速度。$\chi(x,t)$ 是空间和时间依赖的函数，表示信号输入。

利用 Green's 函数的方法，我们可以将自由度为 $n$ 的量子系转变为自由度为 $n+1$ 的量子系，即

$$
|\psi_{n+1}\rangle=\mathcal{P}_{\rm sol}(n+1)\left\{ G_n|\psi_n\rangle\right\}
$$

其中，$\mathcal{P}_{\rm sol}(n+1)$ 表示由多项式展开得到的正则方程。该正则方程可以递归地进行求解，直至得到足够精确的基态态矢为止。

## 对称性保护算法

量子光学系统通常是对称的。这意味着任意两个晶素体之间的交叉点只有零散的两极化区分，而不是真空。因此，对称性保护算法用于消除由对称导致的量子噪声的影响。

### Teller 二维重叠算法

Teller 二维重叠算法是一类基于显式对称性的对称性保护算法。它将两组自由度共有的基矢作为输入，并输出仅含单一自由度的基矢。

算法基本思路是：

1. 用正交基生成一组单位阵。

2. 找到两个输入基矢 $\{A_i, B_j\}_{i, j}$ 和 $\{A'_i, B'_j\}_{i, j}$ 最近的线性组合 $\widetilde{A}$ 和 $\widetilde{B}$。

3. 生成新的基矢 $\widetilde{S} = (\widetilde{A}+\widetilde{B})/\sqrt{2}$ 和 $\widetilde{P} = (\widetilde{A}-\widetilde{B})/\sqrt{2}$。

4. 判断 $\widetilde{S}$ 是否在 $\mathcal{P}_{\rm sol}$ 中，如果不是，则重新生成。否则，判断 $\widetilde{P}$ 是否在 $\mathcal{P}_{\rm sol}$ 中。

5. 返回选择的基矢。

### Lasso 算法

Lasso 算法是一类基于隐式对称性的对称性保护算法。它将一个完全未知的超导体（由多组基矢和期望基矢组成）作为输入，并输出仅含单一自由度的基矢。

算法基本思路是：

1. 通过投影矩阵把输入超导体的期望基矢投影到二维空间中，得到一系列二维基矢 $A_i, B_j$。

2. 用 Lasso 回归算法优化寻找出 $\alpha$, $b$ 来最小化下面的 loss 函数：

   $$
   \min_{\alpha, b} ||\widetilde{X}-\alpha\widetilde{Y}-b||_2^2
   $$

3. 选择投影后的 $\widetilde{S} = \alpha A_i+bB_j$ 和 $\widetilde{P} = (-\alpha)(A_i-B_j)$ 中的那个基矢来作为输出基矢。

4. 返回选择的基矢。