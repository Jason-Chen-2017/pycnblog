
作者：禅与计算机程序设计艺术                    

# 1.简介
  

密度函数 theory (DFT)，是一门研究热运动物理方面的数学分支学科。它研究的是非均匀性、无守恒性等诸多热力学现象的物理基础。其基本假设是热导率具有不断减小的趋势，而真实热运动的趋向是线性的。热流密度依赖于物质的结构、位置和温度，在统计学上用概率分布来描述。

本文为读者提供了一种通俗易懂的阅读方法，对密度函数 theory 有个直观的认识，以及基于该理论的计算模型、机器学习方法的演变及应用。希望能够帮助读者更好地理解 DFT，建立 DFT 技术知识体系。 

# 2.基本概念
## 2.1 热运动理论中的“电子”
首先，回顾一下热运动理论中的几个重要术语：热流、电子、熵、能量和自由能。

- 热流：用以描述物体内部以一定速率传导的热能。
- 电子：指微观粒子构成的有机体的一部分，具有正电荷（+e）和负电荷(-e)。
- 概念：热运动论中能量由电子所创造，每一个电子可以创造出一个能量，称之为“自由能”。
- 熵：衡量物体内特定混乱程度的物理量，单位为 J/K，与温度无关。物体越混乱，熵就越大。
- 能量：物理量，其大小不能被直接测量。由于热运动由电子的相互作用产生，因此可以用能量来描述，能量以 J 为单位。

## 2.2 热运动力学与统计力学
DFT 中的一组基本概念，即热运动力学与统计力学。热运动力学是指研究热运动物理的一种力学原理。热流通常认为遵循常数温度分布，而事实上，热流可以根据热导率和结构的不同而呈现不同的形态。统计力学是一套从微观到宏观的宏观物理学，在统计力学理论中，存在着统计不确定性，在于各种物理量的估计、预测等。

- 温度：物体内部的绝对温度，用来刻画热运动物理中物体的状态。在统计力学中，可以把温度看作一个变量，通过测量各种温度下的物理量，来求得实际物理参数的真值。
- 热平衡：当系统处于稳定状态时，所有带来的热量都应该得到平均分配，这个过程称之为热平衡。通常情况下，物理模型都会设定初始温度作为热平衡点，后续的测量会围绕这一点进行。
- 热容：一个物体（如材料或容器）的对外表面积的平均受热能力，单位为 W/(m K)。在统计力学中，可以用热容来表示物体的均匀度，热容越高，物体越容易表现出均匀分布的特征。
- 相关系数：描述两个随机变量之间线性关系的强弱。可以用 Pearson 相关系数或者 Spearman 相关系数表示。热流的相关系数通常比较低，因为热流是具有统计不确定性的。


## 2.3 概率分布
对于热流密度的描述，最基本的方法就是概率分布。概率分布是一个函数，它将热流空间中的任意一点映射到对应的概率值。概率分布反映了热流密度分布的特性，包括均匀性、局部性、集中程度等。

# 3.DFT 方法
## 3.1 DFT 的构建方式

### 3.1.1 离散化
在热流力学中，大多数热流都是连续的，也就是说，它可以在一个空间区域上随意移动，但是对于实际应用来说，这样做很难满足物理规律的要求。为了简化问题，需要进行离散化处理，将热流离散成离散点。离散化可以使热流的每个点都对应于一个离散元。

### 3.1.2 平移变化
对于离散元的平移变换，通常采用两种方式：格林-朗日方法和分治方法。前者更简单易行，后者利用离散元之间的联系进行运算效率的提升。在这里，我们采用格林-朗日方法。

### 3.1.3 Gross-Pitaevskii 方程

Gross-Pitaevskii 方程是一个微分方程，用于描述电子如何运动并生成能量。该方程源自微观领域的研究，当时也是一个非常复杂的方程。但是，由于其简洁性，并且形式简单明了，在近些年已经成为研究热流的主要工具。

## 3.2 DFT 核

### 3.2.1 单体核
单体核是一个典型的 DFT 核，在近期也逐渐被抛弃。它的特点是在所有电子处只有两个电子。这是因为热流仅仅依赖于局域的一个点，因而不存在电子对之间的相互作用。

### 3.2.2 双体核
双体核是一种类似于单体核的热运动模型。它在所有的电子处都有三个电子，其中有一个电子是中心电子。双体核可以很好地模拟到达特定距离的离子束的过程。此外，这种核也可以描述一些半导体晶体管件中的信息传输。

### 3.2.3 BdG 核

BdG 核是 DFT 中一个经典的模型，也称为拓扑核。它利用了薛定谔方程，来描述所有电子相互作用的情况。薛定谔方程的解可以描述所有可能的排列，因而给出了一种有效的数值方法。

在早期的 DFT 算法中，BdG 核往往配合格林-施温夫-麦克唐纳方法一起使用。它基于给定的一个电子结构，利用数值方法来求解薛定谔方程。目前，最新版本的 DFT 算法则使用 Ewald 方法代替了该方法。Ewald 方法的优点是速度快，但收敛性较差。

## 3.3 DFT 程序
目前，主流的 DFT 程序有如下几种：
- Abinit: 是一种计算机程序，用于计算化学和材料的各种化学性态以及电子和其他费米子体系的物理性质。它同时包含了 VASP 和 Quantum Espresso 两款高性能的计算软件包。Abinit 可以在各种平台上运行，并可用于研究单个原子、单体分子、环状结构、气体等。
- CFOUR: 是世界上第一个开源的实现了全面的 DFT 功能的 C++ 库。它支持多种类型的分子，包含了 HF、PBE、RPA、GAP、LDA、M062X 等模型。CFOUR 可以在各类操作系统上运行，并提供方便的命令接口。
- Gaussian: 是最常用的商业化的程序包，其用户界面友好，功能丰富。其支持的计算任务多样且功能完善，可以应用于各种类型分子的计算。Gaussian 的优点是免费，安装便捷，适合大型项目的计算。
- Molpro: 是一种基于 Fortran 的程序包，它支持多种类型的分子。Molpro 支持 DFPT、MLRIT 等模型。

# 4.机器学习方法
## 4.1 Kernel Method
Kernel method 最早由 Vapnik 提出。它是一种基于核函数的机器学习方法。核函数可以看作是一个非线性映射，它将输入数据从一个空间映射到另一个空间，使得它能够执行分类、回归等任务。Kernel method 的一般过程如下：

1. 对数据进行预处理，如数据标准化、降维等。
2. 通过核函数将数据转换成新的空间。
3. 使用训练好的分类器对新数据进行预测。

常见的核函数有 RBF、Sigmoid、Linear、Polynomial。除此之外，还有很多别的核函数可以选择。Kernel method 的优势在于对数据的非线性表示，以及可以处理不同的数据分布。

## 4.2 Convolutional Neural Network （CNN）
卷积神经网络是机器学习的一个子领域，它能够自动学习到图像、视频、文本等复杂数据中出现的模式。它是由 LeNet-5 和 AlexNet 发明的，其结构简单、精巧，并取得了不错的效果。CNN 的一般过程如下：

1. 数据预处理，如数据增强、归一化等。
2. 将原始数据进行图像化处理。
3. 将图像输入到卷积层，进行卷积操作，获得特征图。
4. 在池化层进行特征的降维和采样。
5. 将特征图输入到全连接层，进行分类。

CNN 的卷积层和池化层可以有效地提取图像的全局信息，并丢弃局部不重要的特征。CNN 的输出结果可以反映图像的类别，或者是图像中的具体内容。

# 5.未来发展方向
## 5.1 拓展多体核的研究
目前，DFT 理论还处于起步阶段，并没有完全发掘到双体核等多体核的奥秘。另外，对于核的数量有限，仍然无法建模复杂的多体行为。如何在保持算法的简洁性的情况下，结合更多的核，建模更复杂的多体行为，是 DFT 理论的研究方向。

## 5.2 模块化开发 DFT 软件
目前，大多数的 DFT 程序包都是基于某个领域的前沿技术开发而成。这导致它们只能适应某个领域的计算需求，无法满足全球范围的计算需求。如何设计一款模块化的 DFT 软件，让它既可以高效计算，又可以灵活配置，是一个长久的技术挑战。