                 

# 1.背景介绍


函数式编程（Functional Programming）是一种编程范型，它将计算视作数学函数，即用函数去描述如何从输入得到输出。在很多方面来说，函数式编程与传统编程之间最大的区别就是函数式编程更关注函数而不是指令执行顺序，而且最重要的是它避免了共享状态，使得函数变得易于测试、并行化处理，能够让程序更加易读、可维护。由于函数式编程强调函数的纯性，因此，很少会出现变量的引用，从而减少了Bug出现的可能性。同时，因为其编程模型比较简单、易学习，也有助于理解计算机科学中的一些概念和理论。在过去几年里，函数式编程正在成为开发者必备的工具之一，它的学习曲线平缓、生动，实用的例子很多，在各个领域都得到应用，比如图形学中，基于OpenGL ES的OpenGL shader编程就是采用函数式语言编写的。本文选取了函数式编程的两个主要流派——Haskell和Scheme，为大家介绍一下他们的基本概念和一些基本操作。希望能给初级开发者和Python用户带来更多的帮助。

# 2.核心概念与联系
## 函数定义和调用
函数式编程的基本单位是函数，也就是说，我们可以把函数看成一个小模块，它接受一些输入，对这些输入进行某种操作后返回结果。函数可以作为参数传递给其他函数，也可以由其他函数返回值。函数式编程中，函数是第一公民，也是函数式编程语言的基础语法单元。下面给出一些关于函数的基本概念。

### 函数定义
在函数式编程中，我们首先需要定义函数，包括函数名、参数列表和返回类型。例如，定义一个求两数之和的函数，其定义如下：

```python
def add(x: int, y: int) -> int:
    return x + y
```

这个函数的名称是`add`，它接收两个整数类型的参数`x`和`y`，并返回一个整数类型的值。注意，函数的返回类型是用箭头右边的类型注解表示的，这个注释不是必须的，但推荐使用这种方式显式地声明函数的返回类型。

### 递归函数
递归函数是指自己调用自己的函数，并且要做一些限制条件，这样才能保证每次递归的过程中不发生无穷循环。典型的递归函数就是求阶乘函数：

```python
def factorial(n: int) -> int:
    if n == 1:
        return 1
    else:
        return n * factorial(n-1)
```

这个函数计算$n! = 1\times 2 \times... \times (n-1)\times n $。

### 函数组合
函数式编程中的函数组合，是指通过嵌套或者合并多个函数来创建新的函数。不同的函数组合方式可以实现不同功能，如:

+ 一元函数：一个参数的函数；
+ 二元函数：两个参数的函数；
+ 多元函数：多个参数的函数。

#### 一元函数
一个参数的函数称为一元函数。比如，求绝对值的函数`abs()`就属于一元函数。

```python
>>> abs(-3)
3
```

#### 二元函数
二元函数是指两个参数的函数，例如加法函数`add()`:

```python
def add(x: int, y: int) -> int:
    return x + y
```

当然，还可以有多元函数，例如三元函数，四元函数等。

#### 函数组合示例
用匿名函数实现阶乘的除法形式：

```python
from typing import Callable

div_factorial : Callable[[int], float] = lambda n: sum((lambda i: 1/i)(i) for i in range(1, n+1))
print(div_factorial(7)) # output: 19.085536923187668
```

上面的代码中，`div_factorial`是一个匿名函数，它接受一个整数`n`，然后返回一个浮点数，即`sum((lambda i: 1/i)(i) for i in range(1, n+1))`。其中，`(lambda i: 1/i)`是一个匿名函数，它将`range(1, n+1)`中的每个元素转换为对应的倒数，然后求和。最后的结果再除以`n!`。由于求阶乘的结果是一个浮点数，因此，匿名函数中的返回类型为`float`。