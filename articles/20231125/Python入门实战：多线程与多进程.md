                 

# 1.背景介绍


## 一、简介
计算机编程的重要方式之一就是多线程与多进程。它们允许一个应用在同一时间内执行多个任务或进行多个操作，从而提高效率和节省资源开销。但要注意的是，多线程与多进程之间还是存在一些不同点的。
## 二、什么是多线程？
简单地说，多线程就是操作系统能够同时运行多个任务的机制。它利用操作系统提供的并发性（concurrency）来实现多任务。每个任务都是一个线程，它们共享相同的内存空间，因此可以访问同一块数据，彼此通信也比较容易。
如上图所示，假设有一个应用需要同时执行两个任务A和B，两个任务之间没有任何依赖关系，则可以使用多线程。
## 三、什么是多进程？
相比于多线程，多进程有以下几个显著特征：

1. 稳定性更好: 每个进程都是独立的，一个进程崩溃不会影响其他进程。
2. 创建开销小: 创建新的进程比创建新的线程复杂得多，因为涉及到复制操作系统的所有资源。
3. 适合IO密集型应用: 由于进程间通讯时IPC，多进程可以用来处理那些需要大量读写文件的操作，而线程只能用于CPU密集型任务。
4. 更强的隔离性: 每个进程只能看到自己的内存，互不干扰，所以进程间的相互影响较小。
如上图所示，假设有一个应用需要同时执行两个任务A和B，其中任务A需要大量文件读取和写入，任务B则不需要，则可以使用多进程。
## 四、区别和联系
总体来说，多进程和多线程都是为了提升应用的处理性能和资源利用率。但是两者又存在着很多差异：
### （1）创建方式
多进程创建方式复杂，有一定开销，但其稳定性更好；而多线程创建方式较为简单，但其稳定性不如进程。
### （2）生命周期
多进程的生命周期独立，每个进程有自己独立的地址空间和资源，可以独立启动、停止；而多线程是在主进程中运行的一个线性序列，共享主进程中的堆和全局变量等资源。
### （3）同步问题
由于进程之间的内存空间独立，因此需要更多的方式来协调各个进程之间的同步和通信；而多线程由于共享内存空间，一般情况下就能很好的完成同步工作，因此线程间同步问题相对少一些。
### （4）适用场景
由于多进程与多线程的创建开销与生命周期相关，因此其适用的场景也有所不同：

1. 对于CPU密集型应用，如处理Web请求、后台计算任务，应使用多进程；
2. 对于IO密集型应用，如文件读写、网络传输等，应使用多线程。
# 2.核心概念与联系
## 一、多线程核心概念
### （1）线程
线程(Thread)，是操作系统能够进行运算调度的最小单位，它被包含在进程之中，是CPU调度和分派的基本单位。一条线程指的是进程中一个单一顺序的控制流，一个进程中可以并发多个线程，每条线程并行执行不同的任务。线程在同一个进程中与其他线程共享内存 space，但拥有自己独立的栈 stack 和寄存器 register。如下图所示：
### （2）进程
进程(Process)，是程序在计算机上的一次执行过程，是一个动态的概念，通过系统调用产生或者终止，是一个封闭的环境。一个进程包括运行中的程序，相应的进程映像包括代码段、数据段、Stack和Heap，它占据可用的资源，如内存空间、I/O设备等。如下图所示：
## 二、多进程核心概念
### （1）进程
进程是程序的一次执行过程，在系统中表示为一个任务，是应用程序在系统内的执行实体，是一个动态概念，在其生命周期内存在。在UNIX或类UNIX系统中，每个进程是一个运行中的程序，由指令、数据、进程控制块、系统资源组成。
### （2）多进程
多进程是指在操作系统中能同时执行多个进程的计算机术语，它是操作系统最基本的并发机制。多个进程之间是独立的，每个进程有自己的地址空间，并独立地进行运行，系统分配给它们一定的资源如内存、CPU等，系统根据进程优先级，调度进程运行。多个进程之间要进行通信的话，通常是采用消息传递的方式，也就是说，进程间需要共享信息或数据，就需要通信手段。比如管道、套接字等。在同一时刻，只有一个进程处于运行状态，其他进程都处于等待状态，这样可以提高系统整体的吞吐量。