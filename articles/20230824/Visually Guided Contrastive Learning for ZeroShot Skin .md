
作者：禅与计算机程序设计艺术                    

# 1.简介
  

在现实世界中，医疗图像数据的标注是一个比较耗时费力的过程。传统的基于标注数据集的方法往往需要大量的标记工作量。相比之下，无监督的学习方法通常需要大量的数据，但取得了较好的效果。然而，这些方法往往忽略了图像中的视觉信息。因此，本文提出一种可视化引导的对比学习(VGCL)方法来进行肤纹疾病分类任务。VGCL由两个主要模块组成——自监督预训练(SSL)和对比学习。该模型能够充分利用图像中的视觉信息来提升性能。

## VGCL模型
VGCL模型由两个主要模块组成——自监督预训练(SSL)和对比学习。其中SSL模块将原始图片的特征转换到另一个低维空间中，同时保持原始图片之间的结构关系。对比学习模块通过最小化源域图片与目标域图片之间的距离来促进特征的学习。

### SSL模块
SSL模块包含一个带有可变形卷积神经网络(V-CNN)的编码器网络和一个解码器网络。V-CNN是一种具有可变形卷积的编码器网络，其结构类似于编码器-解码器网络。解码器网络则用于重建原始图片。为了实现可变形卷积，V-CNN采用不同大小的核并且与多个位置偏移共享相同的参数。这样可以允许模型学习不同尺寸的局部特征并且还保留全局上下文信息。

<div align=center>
</div>


#### V-CNN编码器
V-CNN编码器接收原始图片作为输入并输出高维空间的特征表示，如下图所示。特征提取部分由堆叠的VGG-like网络完成，前几层用于提取高阶特征，后面几层用于提取二阶特征。中间的解码器网络用于重构图像。

<div align=center>
</div>



#### V-CNN解码器
V-CNN解码器接收V-CNN编码器输出的特征映射，使用反卷积层重建图像。对于每个特征映射，V-CNN解码器生成一个尺寸与输入相同的特征图。然后将所有特征图拼接起来，生成最终的重建图像。由于V-CNN编码器中的卷积核的可变形性质，不同的位置偏移对应着不同的大小的卷积核。因此，通过不同位置的特征图重建得到不同大小的局部特征，并保持全局上下文信息。

### 对比学习模块
对比学习模块由两个子模块组成——匹配网络和约束网络。匹配网络是一种多标签分类器，它接受源域图片和目标域图片作为输入并输出匹配度得分。约束网络则是一种流形约束，通过将源域图片投影到目标域上来进行约束。最后，对比学习模块产生的最终结果是源域图片和目标域图片的匹配度得分。

#### 匹配网络
匹配网络是个多标签分类器，它可以同时判断图像中的多个类别是否存在。我们使用基于非极大值抑制（NMS）的方法来解决这个问题。首先，对每个类别都训练一个二元分类器。之后，将所有分类器的输出组合成单个得分分布。

<div align=center>
</div>


#### 约束网络
约束网络是在两个特征空间之间进行距离计算，即用源域图片的特征向量映射到目标域上。这里的约束网络是流形约束，即限制图像的形状变化范围。由于没有直接的监督信号，所以约束网络必须自己学习到数据分布中的模式。

<div align=center>
</div>


### 模型总结
<div align=center>
</div>

从整体模型架构来看，VGCL模型包括两个主要模块——SSL模块和对比学习模块。SSL模块用于学习到高阶特征，并生成低维嵌入向量。对比学习模块通过最小化源域图片和目标域图片之间的距离来增强特征的学习。在匹配网络和约束网络的帮助下，对比学习模块可以有效地学习到源域和目标域的相似性。