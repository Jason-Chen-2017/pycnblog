# 离散控制论:从状态空间到z域

## 1.背景介绍

### 1.1 离散控制系统概述

离散控制系统是一种以离散时间为基础的动态系统,其状态变量仅在离散时间点上定义。与连续时间控制系统不同,离散控制系统的输入和输出信号是以采样的形式存在的,系统的状态也只有在离散时间点上才有定义。

离散控制系统广泛应用于数字计算机控制、数字信号处理、数字通信等领域。随着数字技术的飞速发展,离散控制理论在工业自动化、航空航天、机器人等领域也得到了广泛的应用。

### 1.2 离散控制系统的重要性

离散控制系统理论为分析和设计数字控制系统提供了理论基础和系统方法。它将控制理论与现代计算机技术有机结合,使控制系统的设计和实现变得更加简单和高效。

离散控制系统的主要优点包括:

1. 适合数字计算机实现
2. 抗干扰能力强
3. 设计灵活,易于软件编程
4. 存储和处理数据方便

因此,掌握离散控制系统理论对于现代控制系统的分析和设计至关重要。

## 2.核心概念与联系  

### 2.1 状态空间模型

状态空间模型是描述离散控制系统的一种重要数学模型,它使用一组一阶矩阵/向量微分方程来描述系统的动态行为。

对于一个n阶离散控制系统,其状态空间模型可表示为:

$$
\begin{aligned}
x(k+1) &= Ax(k) + Bu(k)\\
y(k) &= Cx(k) + Du(k)
\end{aligned}
$$

其中:
- $x(k) \in \mathbb{R}^n$是系统的状态向量
- $u(k) \in \mathbb{R}^m$是系统的输入向量  
- $y(k) \in \mathbb{R}^p$是系统的输出向量
- $A \in \mathbb{R}^{n\times n}$是系统矩阵
- $B \in \mathbb{R}^{n\times m}$是输入矩阵
- $C \in \mathbb{R}^{p\times n}$是输出矩阵
- $D \in \mathbb{R}^{p\times m}$是直通矩阵

状态空间模型清晰地描述了系统内部状态的演化规律,为系统的分析和设计奠定了基础。

### 2.2 z域模型

z域模型是另一种等效描述离散控制系统的数学模型,它利用z变换将时域信号映射到复频域。

对于一个单输入单输出(SISO)系统,其脉冲传递函数可表示为:

$$G(z) = \frac{Y(z)}{U(z)} = \frac{b_0 + b_1z^{-1} + b_2z^{-2} + \cdots + b_mz^{-m}}{1+a_1z^{-1}+a_2z^{-2}+\cdots+a_nz^{-n}}$$

其中,分子和分母的系数分别对应于系统的零点和极点。

z域模型为分析系统的频率特性、设计补偿器等提供了方便的工具。它与状态空间模型是等价的,可以相互转换。

### 2.3 状态空间与z域的联系

状态空间模型和z域模型是等价的,可以相互转换。具体来说:

- 从状态空间模型到z域模型的转换,需要利用z变换将矩阵/向量微分方程转化为传递函数。
- 从z域模型到状态空间模型的转换,需要将传递函数分子分母的系数与系统矩阵联系起来。

这种相互转换为我们提供了在不同领域分析和设计离散控制系统的灵活性。状态空间模型擅长于时域分析,而z域模型则适合于频域分析。掌握两者及其联系,是全面把握离散控制系统的关键。

## 3.核心算法原理和具体操作步骤

离散控制系统的核心算法主要包括状态空间分析、z域分析、控制器设计等多个方面,下面将逐一介绍。

### 3.1 状态空间分析

#### 3.1.1 可控性与可观性

对于状态空间模型而言,可控性是指能够通过有限时间内的输入信号,将系统从任意初始状态转移到任意其他状态。可观性则是指能够根据有限时间内的输出信号,唯一确定系统的初始状态。

可控性矩阵:
$$
\mathcal{C} = \begin{bmatrix}B&AB&A^2B&\cdots&A^{n-1}B\end{bmatrix}
$$

可观性矩阵:
$$
\mathcal{O} = \begin{bmatrix}C\\CA\\CA^2\\\vdots\\CA^{n-1}\end{bmatrix}
$$

如果可控性矩阵$\mathcal{C}$满秩,则系统完全可控;如果可观性矩阵$\mathcal{O}$满秩,则系统完全可观。

#### 3.1.2 系统性质分析

利用状态空间模型,我们可以分析系统的稳定性、可控性、可观性等重要性质。常用的方法包括:

- 特征值分析:若$A$矩阵的所有特征值模值小于1,则系统稳定。
- 李雅普诺夫方程:通过求解代数李雅普诺夫方程,可以获得系统的平衡点。
- 李雅普诺夫稳定性理论:利用李雅普诺夫函数,可以判断系统在某个平衡点附近的稳定性。

#### 3.1.3 状态反馈控制

状态反馈控制是一种常用的控制策略,通过引入状态反馈矩阵$K$,改变系统的动态特性。

闭环系统矩阵:$A_{\text{cl}} = A-BK$

通过合理选择$K$,可以使系统满足所需的性能指标,如响应时间、稳定性、鲁棒性等。常用的设计方法包括:

- 极点配置法:通过特征值指定,确定$K$使闭环系统具有所需的极点。
- 最优控制:通过最小化某一代价函数,获得最优的反馈矩阵$K$。

### 3.2 z域分析

#### 3.2.1 z变换与反z变换

z变换是将时域离散信号映射到复频域的一种变换,定义为:

$$X(z) = Z\{x(k)\} = \sum_{k=-\infty}^{\infty}x(k)z^{-k}$$

反z变换则是从复频域还原到时域信号:

$$x(k) = Z^{-1}\{X(z)\}$$

z变换为分析离散系统的频率特性提供了有力工具。

#### 3.2.2 系统函数与传递函数

对于一个线性定常离散系统,其系统函数可以表示为:

$$H(z) = \frac{Y(z)}{X(z)}$$

当输入为单位脉冲时,系统函数就成为脉冲传递函数:

$$G(z) = H(z)|_{X(z)=1} = \frac{Y(z)}{U(z)}$$

传递函数全面描述了系统的动态特性,是z域分析的核心。

#### 3.2.3 系统稳定性分析

在z域中,判断系统稳定性的一个重要方法是绘制根轨迹。

- 如果开环传递函数$G(z)$的所有极点模值小于1,则系统稳定。
- 如果闭环传递函数的分母多项式的根模值均小于1,则闭环系统稳定。

另一种常用的稳定性分析方法是采用Jury稳定性判据。

#### 3.2.4 频率特性分析

通过研究系统的频率响应特性,可以评估系统的性能指标,如带宽、相位裕度、增益裕度等。

常用的分析工具包括:

- 波特曲线:绘制开环传递函数$G(j\omega)$的对数幅值曲线。
- 尼克维斯特曲线:绘制开环传递函数$G(j\omega)$的对数频率特性曲线。
- 伯德曲线:绘制闭环传递函数的频率响应曲线。

### 3.3 控制器设计

#### 3.3.1 PID控制

PID控制是一种经典的反馈控制策略,广泛应用于工业过程控制。其控制律为:

$$u(k) = K_p e(k) + K_i\sum_{j=0}^{k}e(j) + K_d[e(k)-e(k-1)]$$

其中$K_p$、$K_i$、$K_d$分别是比例、积分、微分系数。通过调节这三个参数,可以满足不同的性能要求。

#### 3.3.2 状态反馈控制器设计

如前所述,状态反馈控制器的设计目标是通过选择合适的反馈矩阵$K$,使闭环系统满足预期的性能指标。

常用的设计方法包括:

- 极点配置法:指定期望的闭环极点,求解$K$使之满足。
- 线性二次控制(LQR):通过最小化二次型代价函数,获得最优反馈矩阵。
- 线性二次增益(LQG):结合LQR和卡尔曼滤波,设计最优观测器和控制器。

#### 3.3.3 z域控制器设计

在z域中,控制器设计的目标是确定一个合适的控制器传递函数$G_c(z)$,使整个闭环系统满足要求。

常用的设计方法有:

- 根轨迹法:通过绘制根轨迹,选择合适的控制器零点。
- 频率域法:利用波特、尼克维斯特等曲线,设计满足要求的控制器。
- 优化设计:建立优化目标函数,求解最优控制器参数。

## 4.数学模型和公式详细讲解举例说明

为了更好地理解离散控制系统的数学模型,这里将通过一个具体的例子,详细讲解状态空间模型和z域模型的建立过程。

### 4.1 系统描述

考虑一个二阶质量-弹簧-阻尼系统,其运动方程为:

$$m\ddot{x}(t) + c\dot{x}(t) + kx(t) = u(t)$$

其中$m$为质量,$c$为阻尼系数,$k$为弹簧刚度系数,$u(t)$为外加力。

我们的目标是获得该系统的离散状态空间模型和z域模型。

### 4.2 状态空间模型

令$x_1(t) = x(t)$, $x_2(t) = \dot{x}(t)$,则状态方程可写为:

$$\begin{aligned}
\dot{x}_1(t) &= x_2(t)\\
\dot{x}_2(t) &= -\frac{c}{m}x_2(t) - \frac{k}{m}x_1(t) + \frac{1}{m}u(t)
\end{aligned}$$

对上式进行采样,得到离散状态方程:

$$\begin{aligned}
x_1(k+1) &= x_1(k) + Tx_2(k)\\
x_2(k+1) &= x_2(k) + T\left(-\frac{c}{m}x_2(k) - \frac{k}{m}x_1(k) + \frac{1}{m}u(k)\right)
\end{aligned}$$

其中$T$为采样周期。

可以写成矩阵/向量形式:

$$\begin{bmatrix}
x_1(k+1)\\
x_2(k+1)
\end{bmatrix} = \begin{bmatrix}
1 & T\\
-\frac{kT}{m} & 1-\frac{cT}{m}
\end{bmatrix}\begin{bmatrix}
x_1(k)\\
x_2(k)
\end{bmatrix} + \begin{bmatrix}
0\\
\frac{T}{m}
\end{bmatrix}u(k)$$

即状态空间模型为:

$$\begin{aligned}
x(k+1) &= Ax(k) + Bu(k)\\
y(k) &= \begin{bmatrix}1&0\end{bmatrix}x(k)
\end{aligned}$$

其中:

$$A = \begin{bmatrix}
1 & T\\
-\frac{kT}{m} & 1-\frac{cT}{m}
\end{bmatrix}, \quad B=\begin{bmatrix}
0\\
\frac{T}{m}
\end{bmatrix}$$

### 4.3 z域模型

对状态空间模型进行z变换,可以得到系统的脉冲传递函数