
作者：禅与计算机程序设计艺术                    

# 1.背景介绍


范式化设计就是为了满足数据一致性要求而对关系型数据库进行设计的过程。其目的是为了消除数据冗余、系统异常和查询不正确等问题，提高数据完整性、并发访问性能、数据可理解性和系统维护效率。
在现实世界中，数据之间存在着复杂的关联关系，如何有效地管理这些数据关系以及数据的一致性成为数据库设计者们追求的一个重要目标。
范式化设计包含了6个基本原则：1NF（第一范式）、2NF（第二范式）、3NF（第三范式）、BCNF（巴斯-剃尔峰范式）、4NF（第四范式）、5NF（第五范式）。每一范式都有自己的特点，分别解决不同的数据冗余问题。

范式化设计最早是在1971年由巴斯-克劳法尼(Basso-Cardinal Nicolas)提出的，他将其命名为“三范式”(BCNF)。他认为关系型数据库的设计应当符合三个原则：
1. 要求数据库表中的每个字段都是不可分割的原子数据项；
2. 每个非主属性要完全函数依赖于主属性，即属性不能仅依赖于主属性的一部分；
3. 要求所有数据实体的属性都直接决定于主键。

但是随着计算机的普及，各种应用场景的需求越来越多，因而关系型数据库的设计者们也开始不断探索新的范式化设计方法。近几十年，关系型数据库领域的许多研究者都陆续提出了一些更加接近真实世界的范式化设计方法。如，第三范式主要用于处理多对多的关联关系；第四范式用于处理超链接和其它复杂的依赖关系；第五范式用于描述一般化视图，使得视图中的数据可以被共享和推广。

反范式化设计即非规范化设计又称反模式设计，是一种不符合规范的设计方式。它旨在提升数据库性能、降低存储开销、节省磁盘空间、改善查询效率等方面。反范式化设计的目的是减少数据重复存储，优化数据存取，减少关联查询时间，提高数据库检索速度，增加数据库的易用性。反范式化设计主要包含5种方法：1. 继承 - 派生表：对基表的某些字段再创建一个派生表，把同样的数据存在派生表中，从而避免不必要的重复存储。2. 组合 - 视图：通过组合多个表的数据，创建一个逻辑上的一张表，这种表的物理实现可能是多个表的联合。3. 依赖 - 函数：将数据转换成计算得到结果而不是存储的数据，从而避免重复存储。4. 连接 - 嵌套语句：将两个或更多SQL语句合并到一个查询中，减少了网络传输次数，提高查询速度。5. 冗余 - 分区：将表按照不同的存储介质分区，提高查询效率。
正是由于范式化设计和反范式化设计的不断发展，数据库设计中范式化设计方式已经成为标准，而且逐渐成为行业内公认的数据库设计理论和模式。
# 2.核心概念与联系
## 1NF（First Normal Form）
第一范式（1NF）：每列代表一个不可再分的原子数据项，即列不可拆分。即数据单元不可再分裂，例如：姓名和性别。

特点：
1. 确保每一列的值都是不可分割的原子数据项，并且不可缺失。
2. 主键必须包含唯一标识符。
3. 数据不能出现重复值。
4. 不允许NULL值。

## 2NF（Second Normal Form）
第二范式（2NF）：要求实体的属性完全依赖于主键，而不应该存在部分依赖。即属性不能只依赖于主键的一部分。

特点：
1. 属性完全依赖于主键。
2. 主键不应该出现在任何候选键中。
3. 任何非主属性都不得传递依赖于其它非主属性。
4. 唯一性约束必须包含在候选键中。

## 3NF（Third Normal Form）
第三范式（3NF）：删除非主属性之间的多对多依赖。即消除非主属性间的冗余信息，避免了插入和查询时的复杂性。

特点：
1. 属性不应该传递依赖于其他非主属性。
2. 如果存在多对多的关联关系，则不能建立第三范式。
3. 任何非主属性都不得部分依赖于其它非主属性。

## BCNF（Boyce-Codd Normal Form）
巴斯-卡迪夫范式（BCNF）：是一个特殊的3NF，其结构上不是独立的集合，而是根据主键包含的属性集来定义的。是克劳德·欧文(Jean Colomb)提出的。

特点：
1. 所有的主属性都必须完全函数依赖于主键。
2. 在任意一个非主属性集A中，如果有任何一个属性不是部分函数依赖于A的任何一个主属性，那么A一定不是依赖于它的任何一个非主属性集。换句话说，若X→Y，则Y必须直接依赖于X的某个主属性，否则Y不能作为非主属性。
3. 任何一个非主属性，都不应该跨越多个主属性。

## 4NF（Fourth Normal Form）
第四范式（4NF）：消除了对任一码值的非平凡多值依赖。

特点：
1. 关系模式 R 中，不存在非主属性对码值的多值依赖。
2. 所有主属性均直接依赖于主键。
3. 所有属性都不含已在其它规则中定义过的重复内容。
4. 模式上的任何一个属性都不应该依赖于任何其他非主属性。

## 5NF（Fifth Normal Form）
第五范式（5NF）：消除了对参照的属性的多值依赖。

特点：
1. 在关系模式R中，每一个参照属性不应该依赖于任何其它非主属性，也不应该有多值依赖。
2. 对每一元组t(x1,x2,...,xn)，关系模式R(t)的每个码值xi必须在t中确定，且在关系模式R中，xi必须完全函数依赖于主键。