
作者：禅与计算机程序设计艺术                    

# 1.简介
  

TOPSIS(Total Order Preference Similarity Index)是一种评价指标，由<NAME>、<NAME>和<NAME>于1981年提出，用于多维度对评价对象进行排序。它将每个目标对象的优劣程度按各个维度的相对顺序赋予权值，然后求得加权平均值，作为排序依据。


为了解释其缺陷，<NAME>，<NAME>和<NAME>在1997年发表了一篇文章《TOPSIS--A Simple and Efficient Method for
Computing the Ideal Alternative》，阐述了TOPSIS法存在的问题，并给出了一些改进的方法。本文着重分析这些方法的不足之处，以期为读者提供更好的参考。
# 2.基本概念
## 2.1 TOPSIS法
TOPSIS(Total Order Preference Similarity Index)是一种评价指标，可以对多维度的目标对象的偏好进行比较和排序。TOPSIS法将每个目标对象的优劣程度按各个维度的相对顺序赋予权值，然后求得加权平均值，作为排序依据。

对于某个目标对象，用T表示它的特性向量（attribute vector），用j表示第j个特征的权重，用wij表示第i个目标对象的第j个特征的值。

TOPSIS法按照以下原则计算加权平均值：

1. 对优越性而言，要使得两个目标对象的差异最小化；
2. 对劣化性而言，要使得一个目标对象优于其他所有目标对象。

根据上面的原则，TOPSIS法根据下面的公式计算目标对象的总排序得分S：

$$ S = w_o - \frac{\sum_{k=1}^n w_kw'_k}{\sqrt{\sum_{l=1}^{m} \left(\frac{w_{il}}{\sqrt{\sum_{i=1}^{n} w_{il}^2}}\right)^2}},$$

其中o是最佳方案（best alternative）的序号，$w_k$为第k个目标对象的优越性得分，$w'_k$为第k个目标对象的劣化性得分，$m$为特征数量，$n$为目标对象数量。

## 2.2 个体重要性和互补权重
TOPSIS法中，每一个目标对象都有两种类型的权重，即个体重要性权重和互补权重。

个体重要性权重（Closeness Weight）表示某一个特征对该目标对象的影响力大小。若某个目标对象周围没有比它更优秀的目标对象，则该特征的权重就会较小。反之，若该目标对象周围有很多比它更优秀的目标对象，则该特征的权重就会较大。因此，个体重要性权重可以衡量某个特征对该目标对象所起到的辅助作用。

互补权重（Concession Weight）表示特征之间的相关性。若两个特征之间无直接关系，则它们之间的权重就较小，否则就较大。例如，如果特征A和特征B高度相关，而特征B又高度依赖于特征A，则认为特征A和特征B具有相关性。因此，互补权重是用来约束特征之间的冲突，避免出现多重最优解。

# 3.TOPSIS法缺点
## 3.1 不可行性
TOPSIS法是一种有效的多维度比较和选择指标，但其严格条件的要求使其在实际应用中难以实现。首先，TOPSIS法要求目标属性之间存在线性相关，所以要求目标对象之间的差异具有明显的规律性。但是，实际情况往往并非总是满足这一条件。第二，TOPSIS法假定目标对象拥有的特征是互斥的。这种假设存在一个缺陷，因为真实世界中的目标对象往往具有复杂的依赖关系，并且各个特征之间也可能具有依赖关系。第三，TOPSIS法只能处理分类问题，不能处理连续问题。

## 3.2 可替代性
目前已有许多改进版本的TOPSIS法，如V-TOPSIS、MOORA等，它们既保留了TOPSIS法的基本思想，又通过引入新的方法或模型来解决以上三类问题。

# 4.TOPSIS演变过程及应用
## 4.1 V-TOPSIS
V-TOPSIS(Vector-Based Total Order Preference Similarity Index)，是由<NAME>, <NAME>, and <NAME>于1998年提出的一种改进版的TOPSIS法。V-TOPSIS除了保留TOPSIS法的基本思想外，还引入了两个变化，一是引入向量空间，另一是采用概率分布函数（Probability Density Function, PDF）来描述属性之间的相关性。


为了防止负相关项对结果的影响，V-TOPSIS算法会对每个维度的数据进行归一化处理，也就是说，每个数据都会除以对应的标准差，这样使得不同维度的属性值之间呈现的方差就会接近1。另外，由于采用PDF函数，V-TOPSIS可以更好地处理非线性的关系，比如多个属性间存在正相关，但是随着属性值增加，相关性逐渐减弱的现象。

V-TOPSIS的计算公式如下：

$$ S=\max\{0,\left(D-\bar{d}\right)\phi\cdot c+\left[h-\dfrac{1}{K}(1-\beta^K)\right]\epsilon\}, $$

其中，$D$是一个包含全部目标对象的向量，$\bar{d}$表示$D$的均值，$\phi$是一个包含全部特征的向量，$c$是一个包含全部目标对象的个体重要性权重的向量，$h$是一个含全部特征的互补权重的向量，$\beta$是一个控制置信度的参数，$K$是样本数量，$\epsilon$是随机扰动，用于避免过拟合。

V-TOPSIS适用于处理不规则数据、依赖于概率分布的目标对象以及复杂关系的场景。

## 4.2 MOORA
MOORA(Multiple Objective Optimization Using Reference Attribute)，是由Mahmood Kamath和John O'Hara于1999年提出的一种多目标优化的决策指标。其基本思想是基于普适距离理论(Generalized Distance Theory)中提出的最低描述长度准则，对决策问题中的变量及其约束条件进行建模，求解目标函数的极值，从而找到最优的决策边界。MOORA兼顾了TOPSIS法与V-TOPSIS的优点，同时也可以处理多种优化目标。

MOORA对目标对象进行排序，同时考虑决策问题中变量的约束条件。MOORA的计算公式如下：

$$ f_{ij}=a_i+b_jv_j,\forall i,j.$$ 

$$ W=\sum_{j=1}^p\{v_jv_j-\sum_{i\neq j}v_iv_i\}.$$

$$ L=-\dfrac{1}{2}\sum_{i=1}^q[u_i^T(W^{-1}-\delta I)]^{-1}[u_i-1].$$

$$ F(x)=\sum_{i=1}^p\sigma\left(-f_{ij}-\lambda u_i^Tx_i\right),\quad s.t.\quad G_i(x)=0,i=1,...,q.$$

其中，$x=(x_1,...,x_p)$表示决策变量，$v=(v_1,...,v_p)$表示个体重要性权重，$u=(u_1,...,u_q)$表示约束条件，$a=(a_1,...,a_p)$表示最佳方案。

MOORA能够应对各种优化目标，且能够处理不规则的数据，依赖于概率分布的目标对象以及复杂关系的场景。