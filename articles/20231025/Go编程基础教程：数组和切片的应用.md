
作者：禅与计算机程序设计艺术                    

# 1.背景介绍


在Go语言中，数组（Array）和切片（Slice）是两种基本的数据结构。这两个数据结构都是用来存储一系列相同类型元素的集合。但是它们在很多方面都有着不同的特性和用法。本文将介绍Go语言中的这两类数据结构以及它们之间的关系。
## 一、数组 Array
数组是一个固定大小的顺序存储数据的序列，它可以直接访问指定位置的元素。在使用时，要确定好数组的长度并预先分配足够的内存空间。数组的优点是具有预定义的大小，可以通过下标随机访问元素，并且可以使用简单索引的方式进行遍历。缺点则是数组长度固定且需要提前分配内存空间，不灵活。如下图所示：
数组支持多维度，比如二维数组和三维数组等，但很少使用。
## 二、切片 Slice
切片是一个视图，它引用了底层数组的一个连续片段，而不是整个数组。它的长度和容量可以动态变化。切片的容量是指从数组第一个元素到最后一个元素的数量，可以随意增长或缩小。当通过切片赋值或操作切片时，会影响到源数组的值。切片的优点是它对底层数组的引用，只占用较少的内存资源，而且可以方便地扩展或收缩。缺点则是它只能在同一个数组上创建，并且不能超出底层数组的范围。如下图所示：
## 三、数组与切片的相互转换
虽然数组与切片有着根本性的不同，但是它们之间还是存在着一些相似之处。有时需要将数组转换为切片或者反过来，这需要使用内置函数`copy()`。
### 1. 数组转切片
如果有一个现有的数组，想要在它上面创建一个切片，可以直接通过切片语法来完成。数组和切片共享底层数组的内存，因此修改切片也会修改原始数组的内容。
```go
// 创建一个整数数组
var arr = [5]int{1, 2, 3, 4, 5}

// 通过切片语法创建切片
s := arr[2:4] // 从第三个元素到第四个元素
fmt.Println(s) // Output: [3 4]

// 修改切片元素也会修改原始数组
s[0] = 10
arr[2] = 10
fmt.Println(arr) // Output: [1 2 10 4 5]
```
### 2. 切片扩容
在切片的末尾追加新元素时，如果容量不足，则会自动分配新的更大的内存空间。扩容之后，旧的元素仍然保存在原始的内存地址上，不会被释放掉。
```go
// 创建一个整数数组
var arr = [5]int{1, 2, 3, 4, 5}

// 扩充切片的容量
for i := len(arr); i < cap(arr); i++ {
    arr = append(arr, -1)
}

// 创建切片
s := arr[:cap(arr)]
fmt.Println(len(s), cap(s)) // Output: 5 8

// 在切片末尾添加元素
s = append(s, 6)
arr = s
fmt.Println(arr) // Output: [1 2 3 4 5 -1 -1 -1 -1 6]
```
### 3. 切片收缩
如果切片的长度缩短了，超过了它的容量，那么就会发生收缩。实际上，只会丢弃尾部的元素，保留头部的元素，这样做的目的是节省内存空间。
```go
// 创建一个整数数组
var arr = [...]int{1, 2, 3, 4, 5, 6, 7, 8, 9}

// 创建切片
s := arr[3:6]
fmt.Printf("Before shrinking:%v\n", arr)    // Before shrinking:[1 2 3 4 5 6 7 8 9]<|im_sep|>