
作者：禅与计算机程序设计艺术                    

# 1.背景介绍


## 一、简介
什么是偏微分方程？
偏微分方程（partial differential equation，PDE）是利用微积分的偏导数形式表示的方程。一般来说，PDE通常都是指由微元、点、边或区域组成的各种空间量(space-like quantity)上的微分方程。PDE可以是由一个变量和两个或多个变量组成的方程。
举例来说，1D PDE:

$$\frac{\partial u}{\partial x}=c$$

就是一个典型的1D PDE，其中$\partial$表示偏导数符号，u是待求解的空间变量，x是空间位置坐标，c是一个常数参数。二维、三维甚至更高维的PDE也是有的。

为什么要研究PDE？
在实际工程应用中，存在着许多具有非线性、时间性、有限差异性等特征的复杂问题都可以用PDE来描述。例如，流体动力学、结构优化、材料结构设计、股票市场交易等领域都可以用PDE来进行研究。同时，PDE也有很多有用的数学和物理意义。例如，它们可以用来对问题进行数值模拟、求解及理解其特定的解法。

偏微分方程的数值解法有哪些？
目前，常用的PDE求解方法主要有：
1. finite difference methods (FDM)：这种方法是通过离散化整个区域后，利用差分方程近似求解每个点处的函数值。
2. Finite Element Methods (FEM)：这种方法把问题划分为独立的单元或元素，然后用代数方程来近似每个单元内部的微分方程。
3. Variational Formulation and Finite Element Method (VFE): 通过变分法的方法来求解偏微分方程。

对于PDE求解问题，上述各种方法在求解精度、收敛速度、稳定性及运算复杂度等方面都存在区别。因此，如何选择合适的方法、确定迭代公式并进行数值的误差控制，是解决实际问题的关键所在。

## 二、概论
### 1. 定义和特征
#### （1）定义
1D PDE：

$$\frac{\partial u}{\partial t}+a_xx(t)=b_u(t), \quad a_x, b_u:\mathbb{R}_+\rightarrow\mathbb{R}$$

2D PDE：

$$\nabla^2 u = f(x,y,t), \quad f:(\mathbb{R}^2)\times(\Omega\subset\mathbb{R})^n\rightarrow\mathbb{R}^n$$

在此，$t$为时刻，$(x,y)$为空间坐标，$\Omega$为几何区域，$f(x,y,t)$为右端项。

3D PDE：

$$\nabla^2 u = f(x,y,z,t), \quad f:(\mathbb{R}^3)\times(\Omega\subset\mathbb{R}^3)\rightarrow\mathbb{R}^n$$

在此，$z$为第三个坐标轴。

4D PDE：

$$\cdots,\quad f:(\mathbb{R}^4)\times(\Omega\subset\mathbb{R}^4)\rightarrow\mathbb{R}^n$$

5D PDE：

$$\cdots,\quad f:(\mathbb{R}^5)\times(\Omega\subset\mathbb{R}^5)\rightarrow\mathbb{R}^n$$



即，偏微分方程是由微元、点、边或区域组成的各种空间量(space-like quantity)上的微分方程。
#### （2）特征
* 对称性：偏微分方程$\nabla^2 u=f$满足对称性：$a_{i,j}=a_{j,i}$。当取值为0时，对应于平滑的、平均的或线性关系。
* 连续性：偏微分方程$\nabla^2 u=f$满足连续性：$\Delta u=\nabla u\cdot\nabla u=\nabla (\Delta u)=\nabla^2 u$。即，导数$\partial/\partial x_i=0$条件，即边界处的取值为0。
* 常数系数：偏微分方程$\nabla^2 u=f$存在常数项$k$：$\nabla^2 u=k$。此时，方程表示的是一个平衡或恒定的系数，无运动的物质或平衡状态。
* 无偏性：偏微分方程$\nabla^2 u=f$满足无偏性：$\left.\frac{\partial u_j}{\partial x_i}\right|_{\substack{(x,y,z)\\v\in\Omega}}=0$。即，所有点处的偏导数均不随距离而变化。

### 2. 空间变分法(Variational formulation of space problems)
#### （1）Introduction
空间变分法，又称缩小到极小元法、仿射细分法等，是一种求解偏微分方程的有效方法。它利用了物体的局部微分方程的叠加表示来逼近整个区域的边界和梯度场。它的基本思路是：将空间区域划分为微小的元素，对于每个元素，确定边界梯度场；再将边界梯度场等值约束加入微分方程中，消去自由度，获得局部的张量场；最后利用线性代数或Helmholtz公式求解张量场的表达式，得到边界梯度场的近似解。

#### （2）Mathmatical foundation
##### i. The variational principle for the Poisson equation in one dimension
Consider the scalar function $u$ satisfying the Laplace equation $\nabla^2 u = 0$. We can write this equation as follows:

$$-\Delta u = -\int_{x_\mathrm{min}}^{x_\mathrm{max}}\frac{\partial^2 u}{\partial x^2}(x)\,\mathrm{d}x.$$

To approximate $u$, we can introduce an unknown function $u_h$ that satisfies the boundary conditions on both ends of the domain $(x_\mathrm{min}, x_\mathrm{max})$: 

$$u_h = \lim_{\epsilon\rightarrow0}\frac{1}{\epsilon}\int_{x_\mathrm{min}-\epsilon}^{x_\mathrm{max}+\epsilon}\frac{u(x')}{x'-x}\,\mathrm{d}x'$$

where $u(x')$ is the extrapolated value at $x'$ from our data set or model prediction. Using the variational principle, we have:

$$\int_{\mathbb{R}}\frac{\partial}{\partial x}(\alpha u + \beta v)w\,\mathrm{d}x=\int_{\mathbb{R}}\frac{\partial}{\partial x}\alpha w\,\mathrm{d}x+\int_{\mathbb{R}}\frac{\partial}{\partial x}\beta v\,\mathrm{d}x-\int_{\mathbb{R}}\alpha\beta\frac{\partial v}{\partial x}\,\mathrm{d}x,$$

where $\alpha, \beta$ are test functions, $w$ is some trial function, and $v$ is another function to be approximated. By applying the mean value theorem and defining $p := \frac{\partial u}{\partial n}$, where $n$ is the normal vector pointing outward from the surface, we obtain:

$$\int_{\partial\Omega}\sigma(s,t)n_xn_ty_tn_xs_t\,\mathrm{ds}\mathrm{dt}=\int_{\Omega}\frac{p}{\sigma}\frac{\partial}{\partial s}u(s,t)\,\mathrm{d}s+\frac{\partial}{\partial t}u(s,t).\tag{1}$$

In order to determine the values of $\alpha$ and $\beta$, it suffices to solve these two equations simultaneously using any technique suitable for solving linear systems of equations. Specifically, if $\phi_h(x)$ represents the solution to the previous equation, then the approximation $u_h$ to $u$ is given by:

$$u_h = \phi_h(x)-\frac{p}{\sigma}\frac{\partial}{\partial s}\phi_h(x)+\frac{\partial}{\partial t}\phi_h(x).$$

Now, we assume that there exists some $\sigma>0$ such that $\sigma(x,t)\delta^{(1)}(x,t)<\infty$ for all $(x,t)\in\Omega$ with the Dirichlet boundary condition $u=g$, where $\delta^{(1)}(x,t)$ denotes the first derivative of the Dirac delta function. Then, we can use Eq.(1) to express the variation of $u_h$ along the direction $\hat{n}=(0,-1)$:

$$\begin{aligned}
&\partial_{\hat{n}}\int_{\partial\Omega}\sigma(s,t)(-\frac{p}{\sigma}\frac{\partial}{\partial s}u_h(s,t)+\frac{\partial}{\partial t}u_h(s,t))\hat{n}(s,t)\,\mathrm{ds}\mathrm{dt}\\
&=-\int_{\partial\Omega}\sigma(s,t)(-\frac{p}{\sigma}\frac{\partial}{\partial s}\phi_h(s,t)+\frac{\partial}{\partial t}\phi_h(s,t))\hat{n}(s,t)\,\mathrm{ds}\mathrm{dt}.
\end{aligned}\tag{2}$$

We may rearrange the second line to get:

$$-\frac{p}{\sigma}\frac{\partial}{\partial s}\phi_h(s,t)=-\int_{\partial\Omega}\sigma(s',t)u_h(s',t)\frac{\partial}{\partial s}(u-g)\hat{n}(s',t)\,\mathrm{ds}'\tag{3}$$

Using the definition of $\psi:=u-g$, we have:

$$-\frac{p}{\sigma}\frac{\partial}{\partial s}\phi_h(s,t)=-\int_{\partial\Omega}\sigma(s',t)(\psi\frac{\partial u_h}{\partial s}+\frac{\partial}{\partial t}u_h)\hat{n}(s',t)\,\mathrm{ds}'.\tag{4}$$

The last step involves computing the partial derivatives of $\psi$ along directions perpendicular to the normal direction $\hat{n}$. This requires evaluating integrals over the entire surface $\Gamma$, which may not always be possible depending on the geometry of $\Omega$. However, assuming that the problem can be treated locally, each element of $\Omega$ will yield a unique representation of $\psi$ within its boundaries, thus making this method applicable even in complex domains.