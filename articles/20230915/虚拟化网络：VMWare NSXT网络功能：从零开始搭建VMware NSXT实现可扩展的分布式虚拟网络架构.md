
作者：禅与计算机程序设计艺术                    

# 1.简介
  

随着云计算的普及，越来越多的人开始使用基于云服务商的虚拟化解决方案，如AWS EC2、Azure VM、Google GCE等，而这些云服务商都提供了虚拟化网络相关的功能，比如VPC、VPN、安全组等，帮助用户快速部署虚拟机并保障安全性。然而，当业务规模和复杂度不断提升时，传统的虚拟化网络也面临着瓶颈效应——性能、可用性、成本上升。为了解决这个问题，VMWare公司推出了VMWare NSX-T，它是一个基于软件定义的网络（SDN）控制器，它可以实现统一的管理，并通过功能模块化的方法，提供强大的网络功能，包括安全组、负载均衡、动态路由等，将各种虚拟化网络功能集成到一个分布式、高可用、可扩展的架构中，简化网络运维难度，提升系统的整体可靠性和性能。
# 2.概览
NSX-T由三大主要组件组成，分别是Manager、Controller和Agent。其中，Manager负责配置、监控、策略、租户、管理、测试以及报告，Controller接受来自外部环境的请求并处理它们，并通过Agent向底层环境发送命令，最后返回结果给前端界面；Agent则主要运行在虚拟机或容器所在的主机上，并与底层网络设备进行交互。



Manager是VMware NSX-T的控制中心，其功能包括：

- 配置：提供REST API接口，允许管理员创建虚拟机、VLAN、防火墙规则、NAT网关、负载均衡器等资源；
- 监控：监视整个系统的状态、流量和资源利用率；
- 策略：允许管理员设置全局的安全策略，以及基于标签的细粒度策略；
- 租户：为不同的团队、项目或客户创建命名空间，并提供隔离和访问控制；
- 管理：提供Web UI，允许管理员查看、监控和管理系统；
- 测试：提供REST API接口，允许第三方平台调用系统功能和API；
- 报告：生成日常运行情况报告。

Controller接收来自外部环境的请求，并对请求做出响应，同时还会把请求转发给相应的Agent执行。不同的Agent类型负责实现不同的功能，如NSX Manager Agent、NSX Edge Agents和NSX Controller Agents等。

NSX Manager Agent用于管理逻辑交换机和端口，包括创建虚拟机、VLAN、防火墙规则、NAT网关、负载均衡器等资源。它通过VNIC或者DPDK端口连接到交换机，然后安装VMKernel网卡驱动，以便提供VM的网络功能。

NSX Edge Agents一般部署在物理服务器上，负责实现SDN代理角色，负责处理物理网络流量并根据策略转发数据包。当一个新的虚拟机需要被分配到计算资源时，NSX Manager Agent会自动在边缘计算节点部署对应的Agent。

NSX Controller Agents主要负责SDN控制器的功能，如配置路由表、镜像流量、记录审计日志等。NSX Controller Agents也会安装VMKernel网卡驱动，并连接到Manager。

总之，NSX-T可以实现统一管理、分离的控制器和Agnet，并提供完整的网络功能，包括安全组、负载均衡、动态路由等。