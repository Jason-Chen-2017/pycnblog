
作者：禅与计算机程序设计艺术                    

# 1.简介
  

膨胀-腐蚀界面模型（DAE-SI）是一个用来刻画压力相关的流体中界面行为的热传导模型。它由一个平滑的二维表面场方程和两类涡度方程组成。两类涡度方程分别表示界面在各个方向的向上、向下的摩擦涡量，在某些条件下可以用线性方程近似表示，但在其他条件下则需要用非线性方程近似表示。DAE-SI 的目的就是研究压力相关的流体中的界面及其流场行为，用于对界面性质进行预测、控制和优化设计。

在此篇文章中，我们将通过描述 DAE-SI 的原理和应用方法，阐述对DAE-SI 模型求解过程中的数值方法、线性化方法及求解结果的可视化分析。同时我们还会给出DAE-SI 教材中存在的问题、局限和不足，并进而提出改进建议。希望通过阅读本文，读者能够了解 DAE-SI 模型的基本原理和应用。
# 2.基本概念术语说明
## （1）平滑曲面场方程
对于平滑曲面的截面，$\vec{n}$ 是其法向量；$\partial_n \vec{u}$ 表示法向分量；$a(\vec{x})$ 是受压单元内力密度，即受压单元单元外部对该单元表面形成的压力；$\bar{\rho}_f$ 和 $\bar{\rho}_s$ 分别是两个相邻单元的固化密度；$p$ 是冲击面的内应力。那么平滑曲面的截面上的微元场方程就有：

$$\frac{\partial u}{\partial n} = \frac{\partial p}{\partial x}$$

## （2）界面方程
对于二维曲面上的任意一点$(x,y)$，假设存在一维介质中介，根据亚声速律，这个介质的传播速度比液体小得多。介质流速可以由质量流率（mass flux）表示：

$$m_\text{flow}\equiv \rho v\quad \left( \mathrm{kg/m}^2 \right) $$

其中 $v$ 为介质中介速度。那么单位时间内介质中介方向上该点所在的表面积约为：

$$dA=\int_A dxdydz=Av_\text{flow}t$$

介质中介方向的力密度可以由介质流速在该点所在的面积上的切向分量给出：

$$F_{ID}=-\frac{\partial M_{ID}}{\partial y}\quad (-\mathrm{N/m^2})$$

其中 $M_{ID}$ 为介质中介线性力。由于介质是无阻力介质，所以界面的自由曲率取决于介质中介曲率和阻力的组合，而介质的阻力则由冲击面的内应力给出。对于平滑曲面，界面方程可以写成：

$$\frac{\partial u}{\partial n}+\frac{\partial v}{\partial n}=0-\frac{\partial F_{ID}}{\partial n}$$

## （3）涡度方程
界面方程和界面的旋度曲率可以由涡度方程表示。如果表面由单色界面组成，且具有边界法向速度场，那么界面的旋度曲率可以由两个方向的涡度和线性关系给出：

$$k=\frac{(ku+kv)}{2L} \quad (m^{-1})$$ 

其中 $k$ 表示界面的曲率，$L$ 表示界面的长度。

对于二维界面，因其复杂性，一般采用一类涡度方程来描述界面在各个方向的涡度：

1. **横波涡量**  

$$q_{\text{horiz}}=(u^2 + v^2)\sqrt{\frac{K}{R_{\text{wave}}}}\quad (\frac{\mathrm{m}^2}{\mathrm{s}^2})$$

$K$ 和 $R_{\text{wave}}$ 为模拟参数，分别代表了介质中介向流动时的特征系数和波速。$q_{\text{horiz}}$ 称为水平方向的涡量。  

2. **竖波涡量**  

$$q_{\text{verti}}=u\cdot v\sqrt{\frac{\mu K}{R_{\text{mean}}}}\quad (\frac{\mathrm{m}^2}{\mathrm{s}^2})$$

$R_{\text{mean}}$ 是介质线性速率，$\mu$ 是介质粘度。$q_{\text{verti}}$ 称为竖直方向的涡量。  

3. **混合波涡量**  

$$q_{\text{mix}}=\frac{(u^2+v^2)^{\frac{3}{2}}}{r_{\text{smallest}}} - \frac{uv}{r_{\text{closest}}} + \frac{q_{\text{horiz}}}{R_{\text{wave}}} + \frac{q_{\text{verti}}}{R_{\text{mean}}} + C\quad (\frac{\mathrm{m}^2}{\mathrm{s}^2})$$

其中 $C$ 为系数。$r_{\text{smallest}}$ 是最薄弱介质半径，$r_{\text{closest}}$ 是最靠近真空介质半径。

除了水平、竖直、混合方向的涡量外，还有一种额外的关于介质内力的涡量方程：

$$\tau_{\text{in}}=\frac{-S}{c} \cdot q_{\text{mix}} - a \quad (\frac{\mathrm{Pa}}{\mathrm{s}})$$

其中 $S$ 为单位面积上的介质平衡数，$c$ 是介质对流速率的影响系数。

# 3.算法原理和具体操作步骤
## （1）平滑曲面场方程
为了求解DAE-SI模型中的平滑曲面场方程，先假设平滑曲面的截面积分为0。这样，就可以把平滑曲面的截面$\sigma$看作是另一个变量$\psi$，将平滑曲面的几何中心移到坐标原点，将平滑曲面的两个表面分别记为$U_+$和$U_-$,即：

$$\begin{cases}\nabla^2 U_+=0\\\nabla^2 U_-=0\end{cases}$$

其中，$\psi=\sigma/(2\pi r)$ ，$r$ 为圆柱体的半径。由平滑曲面方程可知，在任何一点处，处于任一表面的面元的法向分量等于0，因此面元的法向导数值为：

$$\hat{n}=\left(\frac{\partial U_-}{\partial x}-\frac{\partial U_+}{\partial x},\frac{\partial U_-}{\partial y}-\frac{\partial U_+}{\partial y}\right)/r=\frac{r}{2}\left(-\frac{\partial U_-}{\partial z}+\frac{\partial U_+}{\partial z}\right),$$

由此可得$U_-$和$U_+$的表达式为：

$$U_-=\frac{1}{r}Z(\theta,\phi)-\frac{l_{\text{minus}}}{2}(X(\theta,\phi)+Y(\theta,\phi))$$

$$U_+=\frac{1}{r}Z(\theta,\phi)+\frac{l_{\text{plus}}}{2}(X(\theta,\phi)-Y(\theta,\phi))$$

其中，$Z$是介质厚度，$X$和$Y$分别是介质的表面坐标；$\theta$和$\phi$分别是平面坐标系的$xy$平面和$yz$平面的夹角；$l_{\text{minus}}$和$l_{\text{plus}}$分别是沿着$yz$轴方向的负差分和正差分长度。$U_-,\ U_+$分别对应平坦、受压和裸露状态的界面。由此可以得到两类微元场方程：

$$\frac{\partial U_-}{\partial t}+\nabla_h u_{\text{plane}}/r = \frac{\partial P_{\text{imp}}}{r} + \frac{\eta}{\rho_s} \sum_{j=1}^{N}\delta_{ij}(\bar{\rho}_f-D_{\alpha}/\epsilon|\vec{e}_{ij}|)\frac{W_{ij}}{r_{\text{ij}}}((U_-)(\vec{e}_{ij}))$$

$$\frac{\partial U_+}{\partial t}+\nabla_h v_{\text{plane}}/r = \frac{\partial Q_{\text{imp}}}{r} + \frac{\eta}{\rho_f} \sum_{j=1}^{N}\delta_{ij}(\bar{\rho}_s-D_{\beta}/\epsilon|\vec{e}_{ij}|)\frac{W_{ij}}{r_{\text{ij}}}((U_+)(\vec{e}_{ij}))$$

其中，$\eta$ 是体积配分函数，$\rho_s$ 和 $\rho_f$ 分别是固化和液体的密度，$D_{\alpha}$ 和 $D_{\beta}$ 分别是两个相邻单元的平均渗透率；$\vec{e}_{ij}$ 是从单元$i$到单元$j$的单位矢量；$W_{ij}=w_{ij}(s_{\text{ij}},t_{\text{ij}})$ 表示由单元$i$到单元$j$的切分面积；$s_{\text{ij}}$ 和 $t_{\text{ij}}$ 分别是从单元$i$到单元$j$的位移。$P_{\text{imp}}$ 和 $Q_{\text{imp}}$ 分别是包含外力的压强，用于表示微元相互作用。$\bar{\rho}_f$ 和 $\bar{\rho}_s$ 可以被替换为固化和液体的密度均值。

## （2）界面方程
界面方程用边界形式表示，将界面分为两部分：自由曲面和外表面。自由曲面为没有边界条件的曲面，在这里一般是由直线、矩形、三角形等构成。外表面是受压单元的外部表面，一般也由一系列边界条件所定义，主要包括对受压单元内力密度的压力和界面法向速度场的定义。

先求解外表面的流场方程，利用Hagen-Poiseuille方程：

$$\left[\frac{dp}{dx}+\frac{dy}{dz}\right]=\frac{q_{\text{ext}}}{A_{\text{perim}}}\quad (p,\vec{u})\quad (p=\frac{1}{2}(p_{\text{top}}+p_{\text{bot}})$$

其中，$q_{\text{ext}}$ 为外表面流入的内力密度，$A_{\text{perim}}$ 为外表面周长。

再求解自由曲面的流场方程，对于自由曲面的任一点$(x,y,z)$，定义其法向$\hat{n}=(nx,ny,nz)$，然后考虑对流粘性对表面扩散的贡献。一般来说，当扩散系数满足湍流方程时，可以近似为：

$$\frac{\partial^2 u_h}{\partial x^2}+\frac{\partial^2 u_h}{\partial y^2}+\frac{\partial^2 u_h}{\partial z^2}=0$$

引入表面张力项：

$$\sigma(x,y)=\frac{F}{A_{\text{perim}}}$$

即表面张力密度的梯度等于外表面内力密度的密度。引入拉普拉斯算子：

$$\mathcal{L}=D_{\text{smooth}}\Delta_h+\frac{1}{r}\left(\nabla_h u_h\cdot\nabla_h u_h+\frac{\partial u_h}{\partial t}\frac{\partial u_h}{\partial t}\right)$$

将拉普拉斯算子作用到曲面$u_h$的分量中，就得到由系统第二微分方程组表示的界面方程。该方程可由边界条件来表达，或者也可以用面元形式来表达，如下图所示：


## （3）涡度方程
涡度方程反映出界面在各个方向的旋度曲率。

- 横波涡量：水平方向的涡量可由双向矩形边界条件来表示：

  $$\left[(\frac{\partial u}{\partial x}-\frac{\partial u}{\partial y})\frac{\partial q_{\text{horiz}}}{\partial x}+\frac{\partial v}{\partial x}\frac{\partial q_{\text{horiz}}}{\partial y}\right]=(u_{\infty}+v_{\infty})(u^2+v^2)^{3/2}\quad (\frac{\mathrm{m}^2}{\mathrm{s}^2})$$
  
  其中，$u_{\infty}$ 和 $v_{\infty}$ 分别是垂直方向的速度场。
  
- 竖波涡量：竖直方向的涡量可由对流介质中的浮力、表面扰动和随意载荷所引起的漂移产生：

  $$\left[(u\cdot v)\frac{\partial q_{\text{verti}}}{\partial x}+\frac{\partial w}{\partial x}\frac{\partial q_{\text{verti}}}{\partial y}\right]=w_{tot}\cdot B_{\text{surf}}(s,t)\quad (\frac{\mathrm{m}^2}{\mathrm{s}^2})$$
  
  其中，$w_{tot}$ 是单位面积上的总体静止位移，$B_{\text{surf}}$ 是单位面积上的表面阻力密度。
  
  通过假设介质为无阻力介质，等效简化为：
  
  $$\frac{\partial q_{\text{verti}}}{\partial x}=-(u^2+v^2)\quad (\frac{\mathrm{m}^2}{\mathrm{s}^2})$$

- 混合波涡量：当相邻单元之间的平均渗透率$\bar{D}$存在差异时，可以用混合波涡量来近似。该涡量可用下列方程来描述：
  
  $$q_{\text{mix}}=\frac{(u_{\infty}^2+v_{\infty}^2)^{\frac{3}{2}}}{r_{\text{smallest}}} - \frac{uv_{\infty}}{r_{\text{closest}}} + \frac{q_{\text{horiz}}}{R_{\text{wave}}} + \frac{q_{\text{verti}}}{R_{\text{mean}}} + C\quad (\frac{\mathrm{m}^2}{\mathrm{s}^2})$$
  
  其中，$C$ 是混合波涡量的系数，$r_{\text{smallest}}$ 和 $r_{\text{closest}}$ 分别是最薄弱介质和最靠近真空介质的距离。