
作者：禅与计算机程序设计艺术                    

# 1.简介
  

在“贝叶斯推断”这个领域里，每一个学科都用自己的语言来解释和定义它，但其核心就是概率论。概率论的研究总是围绕着事件发生的可能性展开的，而贝叶斯推断则是概率论的一个重要分支，它的理念是通过已知数据对未知数据进行估计，并据此做出决策或预测，可谓是概率论领域中最重要的理论之一。所以，了解一下概率论及贝叶斯推断的背景和由来，对于后续的研究工作和应用实践是非常有帮助的。
## 概率论简介
概率论是一个从统计学派衍生出的分支学科，由伯努利提出。它是对一组元素的集合进行概括的基础理论，所关心的问题是元素之间是否存在某种联系或者关系。概率论中最重要的两个概念是样本空间（sample space）和事件（event）。
### 样本空间
设有n个元素的集合S={x1,x2,…,xn}，称为样本空间（sample space），其中xi=(x1,x2,…,xk)表示第i个元素，k为自变量个数。一般情况下，当事件的发生是随机且独立时，我们可以用S来代表所有可能的事件发生序列。例如，抛掷两枚硬币正面朝上的概率为1/2，那么事件{H}就代表硬币投出正面的结果；抛掷三枚硬币时出现正面的概率为3/4，那么事件{HHH}就代表3连投出正面的结果。
### 事件
设S为样本空间，A为事件的子集，如果存在一个样本空间X=S-A，使得P(X)>0，则称事件A为X的条件下发生的事件，记作A|X。上式中的“>0”表示P(X)不是无穷小值。我们把满足上述条件的样本空间称为事件X的基本事件。一般来说，如果事件A包含了X的全部样本空间，即A=X，则称事件A为简单事件。
### 随机变量
在概率论中，给定样本空间S，设F为S到R的映射函数，称F为随机变量，F(x)为随机变量取值于x的值。若定义F(x)和F(y)，我们可以说F和G是同一个随机变量，当且仅当它们的所有取值相同。在这里，概率论所关心的是随机变量的分布情况。
### 概率分布
设X为一个随机变量，X的概率分布是一组描述X所有可能取值的概率值的函数，也叫做概率密度函数（probability density function，pdf）。给定随机变量X，其概率分布记作P(X)。其中，Pr(X=x)=P(X=x)，即在X=x的条件下，随机变量X取值为x的概率。概率分布具有如下几个性质：

1. 非负性：P(X)>=0
2. 规范性：∑P(X)=1
3. 可加性：对于任意两个事件A、B，有P(A∩B)=P(A)P(B)
4. 分配律：P(X∪Y)=P(X)+P(Y)-P(X∩Y)

### 期望、方差与协方差
设X、Y都是随机变量，X的期望（expected value）E[X]是指X所有可能取值的加权平均值，即: E[X]=∑xPx(x), x∈S。类似地，Y的期望E[Y]，var(X)是X的方差，cov(X,Y)是X、Y之间的协方差，均为随机变量的度量。
### 连续型随机变量及其分布
连续型随机变量的分布为连续函数，并且分布函数可以直接用积分计算出来。比如常见的正态分布，其概率密度函数（pdf）为: f(x)=1/(sqrt(2π)*σ)(exp(-(x-μ)^2/(2σ^2)))，μ为均值，σ为标准差。另外，泊松分布也是一种典型的连续型随机变量分布。
## 贝叶斯定理
贝叶斯定理（Bayes' theorem）是一个重要的应用概率论的定理。它提供了一种基于观察的数据分析的方法。假设我们要对某个事物进行推测，如赌博游戏中抛硬币的结果。先验分布（prior distribution）是指关于某事物当前状态的知识，包括对事件的不确定性程度，或者对某些事物的个人经验。根据这条信息，利用贝叶斯定理可以计算出后验分布（posterior distribution）。后验分布是指考虑新证据后的 updated belief of a situation after observing new evidence, or having new information about it. 通过计算后验分布，我们可以得出更有针对性的推测或结论。下面我们来详细阐述贝叶斯定理。
### 基本思想
贝叶斯定理的基本思想是利用已知的信息，根据这些信息来更新我们对待检测事件的认识。换句话说，给定某些事实或数据的支持，我们可以使用贝叶斯定理来建立事件A的后验概率。这种方法就是“贝叶斯法”。贝叶斯定理涉及到三个重要术语——似然、先验分布、后验分布。下面将详细讨论这三个术语。
### 演示
首先，我们用抛硬币的例子来举例说明贝叶斯定理。抛硬币时，硬币只有两种可能的结果——正面或反面。我们没有任何关于硬币的先验知识，所以我们认为硬币有50%的可能性会面朝上方，另外50%的可能性会面朝下方。我们抛一次硬币，观察结果是正面，那么根据前述知识，我们可以计算出后验分布，也就是根据抛硬币这一事件，我们得到关于正面朝上的概率。我们知道抛硬币的过程是确定的，而且每次抛都是独立的，那么我们只需要根据观察到的正面或反面，来重新计算硬币的后验分布。下面我们来求解硬币抛出正面时，硬币面朝上的概率。
### 似然
在统计学中，似然又称做参数的最大似然估计，是指给定模型参数θ，已知观测数据x，对模型的输出y的条件概率分布P(y|x;θ)的计算。记L(θ)=P(D|θ)，其中D表示观测数据，θ为模型参数，即θ属于Θ，θ∈R^(m×n)，L(θ)是一个n维向量。当θ取不同值时，似然函数L(θ)将有不同的取值。
### 先验分布
先验分布是指关于某事物当前状态的知识，包括对事件的不确定性程度，或者对某些事物的个人经验。这里，我们假设硬币是公平的，双面的，即硬币的两面各被抛一次的机会是相同的。因此，硬币的先验分布是一个均匀分布。即P(H)=P(T)=0.5。
### 后验分布
贝叶斯定理给出了如何利用似然函数和先验分布，计算出后验分布的方法。先验分布告诉我们事件H的可能性有多大，而似然函数L(θ)告诉我们在θ确定的情况下，事件H发生的概率有多大。因此，可以计算出后验分布。注意，后验分布并不是唯一的，因为还有其他的先验知识。下面，我们根据观察到正面后，再次计算硬币的后验分布。根据贝叶斯定理，我们可以用下式来计算后验分布。

P(H|D)=P(D|H)P(H)/P(D)

根据观察到硬币的结果是正面，计算P(D|H)和P(H)的概率值。P(D|H)即事件H发生的概率，等于1/2，因为抛硬币是公平的，每次抛都是等可能的。P(H)是先验分布，等于0.5。因此，P(D|H)P(H)/P(D)等于0.5。至此，我们已经计算出了硬币的后验分布，等于0.5。
### 联合概率
联合概率（joint probability）是指两个或多个事件同时发生的概率。在这里，硬币的结果和抛硬币的过程都是两个互相独立的事件。也就是说，我们不能排除由于不同的原因导致硬币的结果不同，而导致两个事件同时发生的可能性。但是，抛硬币的过程不会影响第二次抛硬币的结果，因此我们可以忽略它。因此，事件H和D的联合概率等于0.5。
### 条件概率
条件概率（conditional probability）是指在给定另一个事件已发生的情况下，第一个事件发生的概率。在这里，我们已经知道硬币的结果是正面，所以我们只能根据这一信息来计算事件D的发生概率。因此，事件D的条件概率等于1/2。
### 对数概率
在概率论中，很多时候我们采用对数形式来表示概率。这时，我们通常使用对数似然函数，即ln(L(θ))，来表示似然函数。下面，我们将分别采用数学方式和对数形式来表示事件D的发生概率。对于硬币的抛掷，我们可以计算其面朝上的概率的几何形式：

P(H=h)=0.5*sinθ+0.5, h=1, θ=π/6

这是一个三角形，其高度为θ，底边为1。我们画一条从顶点到坐标轴的直线，然后垂直线交于点M=(0,0.5)，半径为cosθ，那么就可以计算出该直线上的圆弧长度。如果θ=π/6，则对应的圆弧长度为0.5，即正面的概率。

也可以用对数形式来表示：

ln(P(H=1))=ln[(0.5*sinθ+0.5)]=ln(0.5)+ln(sinθ+1)=ln(0.5)+θ+ln(2)=-0.798<0

我们看到对数似然比真实概率小很多，这是因为数字形式太小而引起精度误差。不过，似然比真实概率小的情况并不少见，实际中往往更关心似然比或者证据比。