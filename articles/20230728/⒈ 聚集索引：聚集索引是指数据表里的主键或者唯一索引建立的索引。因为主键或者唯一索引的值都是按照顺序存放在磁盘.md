
作者：禅与计算机程序设计艺术                    

# 1.简介
         
 在关系数据库中，通常都存在着聚集索引，即聚集索引是一个逻辑存储单元上的索引结构，它将数据行物理顺序映射到记录的物理位置上。由于聚集索引的存在，使得对数据库的搜索和排序操作变得异常快速。
          
         ## 概念定义及说明
        - 聚集索引（clustered index）: 是索引中一种，它将数据按逻辑顺序存储在表的主体数据区(data area)中。
        - 数据表的主体数据区称为堆（heap），一个聚集索引只能对应一个堆。
        - 非聚集索引（non-clustered index）: 是另一种索引结构，它将数据存储在一个单独的数据区(index area)中，该区域跟堆分离。
        - 当执行 SQL 查询时，MySQL 可以利用聚集索引来加快检索速度；如果没有找到满足条件的索引，则需要进行回表查询。
        
        ## 设计目的
        通过聚集索引来提高数据检索速度，主要有以下几个原因：
        
        1.聚集索引的数据存储结构使得数据访问更加简单、快速，也就意味着查询速度的提升。

        2.通过聚集索引，数据库系统可以识别出快速定位所需数据的关键码，从而直接定位到磁盘上的对应数据页，从而减少随机读取时间，提高查询效率。

        3.聚集索引的数据是排好序的，因此对于范围查询、排序等操作非常有效。

        4.聚集索引总是占用较少的磁盘空间，可以极大地提升数据库性能。

        5.对于频繁更新的数据表来说，聚集索引也可提供很好的查询性能。
        
        ## 优点
        1. 提升数据检索速度。
        2. 减少随机读取时间。
        3. 聚集索引总是占用较少的磁盘空间。
        4. 更容易维护数据表。
        
        ## 缺点
        1. 更新操作需要整行锁定，造成阻塞。
        2. 索引失效率可能较低。

        ## MySQL 的聚集索引实现
        
        下面以 `employees` 表为例介绍 MySQL 中如何创建聚集索引。
        
        ```sql
        CREATE TABLE employees (
            emp_no INT NOT NULL PRIMARY KEY,
            first_name VARCHAR(14),
            last_name VARCHAR(16),
            birthdate DATE,
            hire_date DATE
        ) ENGINE=InnoDB;
        ```
        
        创建聚集索引时，只需要在字段名后添加 `ASC` 或 `DESC`，表示索引的排序方式即可。例如：
        
        ```sql
        ALTER TABLE employees ADD INDEX idx_birthdate (birthdate ASC);
        ```
        
        此处，我们创建了一个 `idx_birthdate` 索引，其中的 `birthdate` 表示该索引所依据的字段。在 MySQL 中，默认情况下，所有列都为 `NOT NULL`。因此，`emp_no` 和 `first_name`、`last_name`、`hire_date` 这些字段可以选择设置为 `NULL`，但不能设置为默认值 `DEFAULT NULL`。
        
        ## 使用聚集索引的注意事项
        
        1. 主键或唯一键不能设置为空。
        2. 如果索引不是覆盖索引，那么就无法完全利用索引来加速查询，除非查询语句包含所有的列。
        3. 不要过多索引。
        
        
        ## 聚集索引的局限性
        1. 聚集索引并不能完全替代索引。
        2. 聚集索引要求每张表只有一个聚集索引。