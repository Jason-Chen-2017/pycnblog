                 

# 1.背景介绍


## 1.1 函数式编程
函数式编程(Functional Programming)是一种抽象程度很高的编程范型。函数式编程把计算视为数学函数应用，并且避免共享状态，使得函数式编程更加易于理解、调试和扩展。函数式编程倡导利用函数组合来构造程序，函数式编程语言具有自动推导类型功能，可以让程序员摆脱对类型系统的束缚，开发出干净简洁的代码。
函数式编程包含三大要素：
- 纯函数：只根据输入参数返回值，不产生任何可观察副作用；
- 惰性求值：函数调用时才进行运算，适用于需要延迟执行的情景；
- 无副作用：函数不会改变其外部变量的值，保证了函数的确定性。
函数式编程的一个重要特征就是抽象程度很高，函数式编程支持高阶函数，即函数作为参数或结果传递给其他函数。在函数式编程中，将一个大任务拆分成多个小任务并用函数组合起来完成整个任务。因此，函数式编程编程模型常用惰性求值的特性来实现延迟执行。同时，函数式编程还有很多纯粹的优点，如逻辑简单、易于测试、数据不可变等。

## 1.2 Lambda表达式
Lambda表达式是一个匿名函数，它允许用户定义没有名字的函数。可以使用Lambda表达式来代替传统函数式编程语言中的def关键字定义的命名函数。Lambda表达式是轻量级对象，可以被当做参数传入方法或者存储到集合中，还能用于创建其它高阶函数。通过Lambda表达式，就可以对数据的操作和处理，用函数式编程的方式来编写代码。Lambda表达式语法如下：
```java
() -> expression // 只包含表达式的Lambda表达式
(parameter list) -> { statements; } // 有块语句的Lambda表达式
```

Java 8引入了新的函数式接口，它的目的是为了兼容现有的函数式编程风格，并且减少学习成本。函数式接口主要包含一个抽象方法且仅有一个方法体的方法。这样的接口称之为函数式接口，可以通过注解@FunctionInterface标识出来。比如Runnable接口就是一个函数式接口。
```java
@FunctionalInterface
interface MyFunc{
    void method();
}
```
在Lambda表达式中，也可以引用某些内置函数或类库中的方法，如排序、过滤、遍历等。例如，下面的Lambda表达式使用了Arrays类的sort方法对字符串数组进行排序：
```java
String[] strArr = {"hello", "world"};
Arrays.sort(strArr, (s1, s2) -> s1.compareToIgnoreCase(s2));
```

# 2.核心概念与联系
## 2.1 一等公民与闭包
### 2.1.1 一等公民
函数式编程认为所有的变量都是第一类对象，也就是说函数式编程语言中的变量可以赋予绑定值，可以作为参数传入函数，也可以在函数间传递。因此，一切变量都可以被赋值给变量，并可以在运行期间修改。这就意味着函数式编程语言支持高阶函数、函数作为参数和返回值、闭包等特性。

### 2.1.2 闭包
闭包（Closure）是指能够访问自由变量的函数。换句话说，闭包就是能够读取其他函数内部变量的函数。例如：
```java
public class ClosureDemo {

    private int x = 0;
    
    public int getValue() {
        return this.x++;
    }
    
    public static void main(String[] args) {
        
        ClosureDemo c1 = new ClosureDemo();

        for (int i=0;i<10;i++) {
            System.out.println("c1 value: "+c1.getValue());
        }
        
    }
    
}
```

上面例子中，ClosureDemo类有一个值为私有变量x的字段，并且提供一个方法getValue()用来获取该变量的值，每调用一次该方法，这个变量就会自增一次。但是，由于getValue()方法是一个闭包，它能够访问到外部的变量x，所以每调用一次getValue()方法，都会看到x自增后的值。这正是闭包的作用——它能够保存外部变量的值，使得局部变量的值能够保持在内存中，从而达到一些特殊的效果。