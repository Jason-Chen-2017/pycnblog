
作者：禅与计算机程序设计艺术                    

# 1.简介
         
2017年6月，美国政府颁布了《支付卡行业数据安全标准（Payment Card Industry Data Security Standard）》(PCI DSS)，作为该领域的一个重要基准标准。2019年10月，联邦贸易委员会（FTC）又发布了《支付处理机构安全规范（Federal Payment Processing Regulatory Standard）》，其中明确要求企业需要满足PCI DSS认证才能成为合格的支付处理机构。那么，对企业来说，如何确保其网络安全，尤其是支付网络的安全呢？这就要从网络攻击面、网络攻击方法、网络防护措施三个方面来谈起了。

# 2.背景介绍
## 网络攻击面
目前，支付网络的攻击面主要集中在“业务接口”、“交易管理”和“服务访问”。
### （一）业务接口
支付网络的业务接口涉及到支付协议、指令、报文等数据的传输。黑客通过控制这些接口能够获取信息，如交易流水、支付凭证等。比如，一款成熟的支付系统，通常会有多个网络端点供用户进行交易，包括线上支付网关、POS终端、第三方支付平台等。黑客如果控制了其中某一个网络端点，就可以获取用户的支付账户和交易数据，进一步违反隐私、篡改数据等目的。另外，黑客还可以通过中间人攻击（Man-in-the-Middle attack，MITM）攻击或入侵其他网络设备，获取敏感信息甚至控制整个支付系统。因此，网络安全的第一步就是要保障支付系统的各个接口不被未经授权的访问。

### （二）交易管理
支付系统交易管理涉及对交易信息的完整性、可靠性、可用性和完整性的维护。支付系统的商户在付款前，需要完成相关信息的验证和身份核实，才能成功下单付款。黑客如果能获知用户的真实姓名、信用卡号、有效期限等敏感信息，那么他可以利用此信息冒充他人或模拟支付，导致欺诈交易或付款。因此，支付网络的交易管理也需要防范攻击。

### （三）服务访问
支付网络的服务访问则涉及支付系统用户的账号和密码等安全信息的泄露。黑客入侵目标网站后，可以收集登录信息和个人资料，进一步获取用户的账户和交易数据。攻击者还可以通过其他方式绕过支付系统的身份验证，例如盗取验证码、仿冒用户、垃圾邮件等。因此，网络安全的第四步就是要保障支付系统的服务访问不被未经授权的访问。


## 网络攻击方法
支付网络存在多种攻击方式，如垂直渗透、水平渗透、拒绝服务攻击、中间人攻击等。
### （一）垂直渗透
垂直渗透攻击针对某个支付平台或系统的漏洞，目标是直接获取数据库用户名和密码，进一步破坏系统权限，获取敏感数据。垂直渗透攻击也可以用于探测系统的内部结构，或者找出潜在的攻击点。黑客首先需要获得目标公司或系统的权限，然后尝试猜测或破解加密密钥、口令、API KEY等，进入数据库查询或修改数据。

### （二）水平渗透
水平渗透攻击是指黑客从多个角度接触目标系统或网络，以发现系统漏洞、窃取敏感数据、持续控制网络、影响业务运营。水平渗透攻击的方式一般分为社会工程学攻击和信息收集两种。

社会工程学攻击是指黑客通过构造恶意的电子邮件、垃圾短信等，向受害者发送恶意链接或病毒等木马，诱导用户点击链接或打开附件，自动安装恶意软件或捕获数据。由于黑客入侵容易，黑客往往会选择比较弱的攻击方式，即仅通过网络攻击达到目的。

信息收集攻击则是指黑客主动搜索目标公司或系统的信息，包括系统的IP地址、域名、服务器配置、网络拓扑图、服务器日志、用户注册信息、敏感数据等。攻击者使用各种手段收集目标系统的信息，包括搜集目标公司的公开信息、搜索引擎爬虫、截屏、键盘记录、摄像头监控、DNS记录、端口扫描、NMAP扫描等。通过这些信息，攻击者可以了解到目标公司的业务情况、网络拓扑、系统配置、人员信息等，帮助他们制定策略、打击犯罪分子。

### （三）拒绝服务攻击
拒绝服务攻击是一种重大安全风险，黑客通过大量消耗系统资源或占用带宽的方式阻碍正常通信，造成严重经济损失。攻击者会使用诸如 SYN flood、Smurf attacks、Ping of death、land attacks、DDoS 等手法，通过不合理的请求次数、带宽限制等，占用网络资源、拒绝服务。为了防止拒绝服务攻击，支付系统应当采取流量整形、QoS机制、CAPTCHA 验证、请求阈值控制等措施。

### （四）中间人攻击
中间人攻击（man-in-the-middle attack，MITM），也称为钓鱼攻击，它是指黑客攻击双方之间不存在直接联系的攻击方式，而是在双方间加入第三者，代理双方的通信。攻击者篡改通信内容或插入垃圾信息，且未得到双方的同意，让双方感觉不到任何异常。由于黑客通过中间人攻击获取信息后，很可能会篡改数据或让用户付款，因此，支付系统应当建立可信赖的网络通道、部署高级防御体系和有效的审核流程。

## 网络防御措施
支付网络的防御措施大致可以分为两类，一类是网络安全控制措施，主要用于提升网络通信的安全级别；另一类是应用安全防护措施，主要用于防止应用自身的代码和数据泄露和攻击。
### （一）网络安全控制措施
网络安全控制措施主要包括以下几项：
#### 1.业务访问控制
该措施用于控制不同业务方的系统访问权限。比如，限制特定业务方IP地址对整个网络的访问，将对系统的不同组件或模块的访问权限设置得更加严格，减少未授权访问的风险。
#### 2.信息泄露防护
该措施用于避免信息泄露。比如，采用最低权限访问账户数据，配置加密传输、数据分级分类、限定数据访问时间等措施，避免数据泄露风险。
#### 3.日志审计和分析
该措施用于检测和分析网络日志。比如，对日志内容进行解析、过滤和分析，确定网络活动异常、攻击行为、恶意操作、网络攻击、可疑访问等。
#### 4.攻击检测和防护
该措施用于识别和抵御网络攻击。比如，通过日志审计、流量分析等手段，识别网络上的攻击活动，并进行封堵、检测、预警等防护。
#### 5.网络安全配置管理
该措施用于实现网络安全配置的管理和更新。比如，制定网络安全基线，定期评估网络的安全状况，发现新出现的安全漏洞、攻击行为等，及时修补漏洞。
### （二）应用安全防护措施
应用安全防护措施主要包括以下几项：
#### 1.静态代码检查
该措施用于检测应用程序中的语法错误、编码规范 violations、安全漏洞等。
#### 2.输入验证
该措施用于防止恶意输入数据被误入后台。比如，采用白名单过滤掉非法的请求参数、采用验证码或滑块验证等手段，增加系统的安全性。
#### 3.敏感数据加密
该措施用于保障敏感数据在传输过程中不被偷窥、被篡改。比如，采用RSA、AES等加密算法加密敏感数据，提升传输过程的安全性。
#### 4.数据库防火墙
该措施用于控制数据库访问权限，通过审核确认合法的数据库连接请求。
#### 5.应用配置管理
该措施用于实现应用配置的管理和更新。比如，引入配置管理工具来管理配置文件，增强系统的可移植性、灵活性和可维护性。

