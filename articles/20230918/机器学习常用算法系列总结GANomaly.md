
作者：禅与计算机程序设计艺术                    

# 1.简介
  

传统的 anomaly detection 方法都是基于距离度量的方法，即衡量样本与所有训练样本之间的距离并根据统计规律来判断是否异常，因此其主要的弊端在于对欺骗性样本（即一些高度相似但实际上并非异常的样本）具有较强的抗攻击能力。为了解决这一问题，近年来出现了一种基于 Generative Adversarial Networks (GAN) 的无监督异常检测方法。该方法通过生成器网络生成看起来像真实样本的虚假样本，并且在判别器网络的辨别下区分出合格的样本和异常的样本。

GANomaly 是 GANs 的一个应用。它不仅能够从数据中提取出高维特征，还能够实现隐空间到数据空间的映射，从而将不规则的数据分布映射成比较规则的数据分布，并且将数据的某些维度进行合并压缩，使得特征空间更加紧凑、简洁，并且可以有效地降低维度。此外，GANomaly 可以训练生成模型同时也训练判别模型，这使得它具备良好的鲁棒性。

GANomaly 的整体框架如下图所示：

GANomaly 分为两步：

1. Generator network: 生成器网络用于生成假样本。输入的是随机噪声 z ，输出的是生成的假样本 x 。

2. Discriminator network: 鉴别器网络用于区分真实样本和假样本。它输入的是真实样本 x 和假样本 x‘，输出的是概率值 p(x is real or generated)。

通过训练生成器网络来产生假样本，通过训练鉴别器网络来区分真实样本和假样本，最终得到分类结果。



# 2.基本概念术语说明
## （1）GAN
Generative Adversarial Network 翻译过来就是生成对抗网络，GAN 是由 Ian Goodfellow 提出的一种无监督学习的深度学习方法。GAN 是两层神经网络，分别叫做生成器 Generator 和鉴别器 Discriminator。生成器接收随机噪声 z 作为输入，输出可信度高的假样本 x'。鉴别器接收真实样本 x 和假样本 x' 作为输入，输出其属于真实样本的概率 p(x is real or generated)，进而更新生成器网络参数。通过训练生成器网络和鉴别器网络，可以完成对抗训练。

## （2）Anomaly Detection
异常检测是指识别异常数据，或者检测未知异常行为的过程。在传统的异常检测方法中，通常是采用距离度量的方式，即衡量样本与其他训练样本之间的距离，并根据统计规律来判断是否异常。但是这样的方法会存在一些缺陷：

1. 对欺骗性样本具有较强的抗攻击能力；

2. 只能处理低维数据；

3. 不具有泛化能力。

为了解决这些问题，最近几年出现了基于 GAN 的无监督异常检测方法，如 DBSCAN、Autoencoder、Isolation Forest、One-Class SVM、Local Outlier Factor、Histogram-based Outlier Score等。这些方法均没有直接使用距离度量的方式，而是借助 GAN 的特性来训练出一套生成模型和判别模型，来学习数据中的高维特征，并将不规则的数据分布映射成比较规则的数据分布。最后，利用判别模型预测出数据的异常程度，进而做出相应的判断。