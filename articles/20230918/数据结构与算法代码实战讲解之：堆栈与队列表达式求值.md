
作者：禅与计算机程序设计艺术                    

# 1.简介
  

## 概述
在计算领域中，很多时候我们需要对一些表达式进行求值。这些表达式通常都是由算术运算符、逻辑运算符和函数调用等符号组成，比如：3+4*5，(2-1)*(3+4)，abs(-3)。表达式求值的过程就是将表达式的各个元素按照特定顺序排列并依次进行计算得到最终结果的过程。表达式求值算法一般分为两类：
- 后缀表达式求值（Reverse Polish Notation, RPN）算法
- 中缀表达式求值（Infix Expression Evaluation）算法
今天，我们要介绍一种基于堆栈的数据结构——栈（stack），并且结合上述两种不同的表达式求值算法一起进行讨论。具体来说，我们将用到的堆栈包括：
- 运算符栈（operator stack）：用于存储所有参与运算的算术运算符或逻辑运算符
- 操作数栈（operand stack）：用于存储所有的参与运算的数字或函数调用的参数
通过上述两个堆栈，我们就可以实现对表达式求值的算法了。
## 算法描述
### 一、后缀表达式求值（RPN）算法
后缀表达式求值算法的步骤如下：
1. 从左至右扫描输入表达式，遇到数字则入操作数栈；
2. 如果遇到运算符，则判断其运算优先级，如果当前运算符比栈顶运算符的优先级低或者相同，则入运算符栈；否则，弹出栈顶运算符及其对应的操作数，并把该运算符压入栈；直到栈顶运算符优先级高于当前运算符，或者栈空，才把当前运算符压入栈；
3. 当表达式扫描完成后，从栈中依次弹出操作数，并计算出相应的结果；最后，栈中剩下的全部操作符都弹出，因为它们没有对应的操作数，不构成完整的表达式。因此，此时得到的结果即为表达式的值。

举例：假如有一个后缀表达式 34*5-，它的过程如下图所示:
分析过程：
1. 在扫描过程中，遇到数字3和4，分别入操作数栈；
2. 接着遇到运算符'*'，由于它优先级比栈顶的'+'低，所以把'+', '*', '(', ')'分别压入运算符栈；
3. 然后遇到数字5，入操作数栈；
4. 继续扫描，遇到减号'-',因为它没有对应的操作数，所以把它弹出，再把之前计算出的'5'、'3'和'4'相加得到结果'23'，再计算得到最终结果'-20'。

### 二、中缀表达式求值（INFIX EXPRESSION EVALUATION）算法
中缀表达式求值算法又称为逆波兰表示法，它的步骤如下：
1. 从左至右扫描输入表达式，遇到数字则读入操作数栈；
2. 如果遇到括号‘(’, ‘[’, ‘{’,则读入下一个字符作为新的括号表达式，并递归地调用自身对其求值，并将其结果入栈；
3. 如果遇到运算符，则读取操作数栈的最顶层操作数和运算符，根据运算符进行计算，并将结果入栈；
4. 如果扫描结束，则整个表达式的值就是栈顶的操作数；若存在运算符栈中的符号，则说明表达式格式不正确。

举例：假设有一个中缀表达式 (3 + 4) * 5 - ，它的过程如下图所示:

1. 读入'('和'3'作为第一个操作数；
2. 遇到'+'，则读入第二个操作数'4'和'+';
3. 此时栈顶是‘3’，然后‘4’被压入运算符栈；
4. 接着扫描'+'，读入第三个操作数'4'和')'；
5. 栈顶为‘+’，然后‘4’被压入运算符栈；
6. 栈顶为‘3’，然后‘4’被压入操作数栈；
7. 扫描结束，计算‘3’和‘4’的和为‘7’，然后计算‘7’和‘5’的乘积为‘35’，最后计算‘35’和‘-’的差值为‘-32’，所以这个表达式的值为'-32'。