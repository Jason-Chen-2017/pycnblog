
作者：禅与计算机程序设计艺术                    

# 1.背景介绍


什么是 Hyperledger Fabric？它是一个开源分布式账本框架，由IBM、Linux基金会和英国伦敦银行设计开发，用于构建企业区块链应用，并于2017年加入Linux基金会。

分布式账本，或者说区块链，是指多个节点通过共识算法，在去中心化的网络上保持数据的全面一致性，使得不同节点的数据实现共享，任何人都可以访问这些数据，从而实现价值的流通和共享。在分布式账本中，记录信息的叫做交易（transaction），记录交易的地方叫做区块（block）。区块链由很多区块组成，并且每个区块都串联着前一个区块，形成一条链条，且所有节点都要认同该链条上的信息都是有效的。分布式账本具备以下特点：

⒈ 分布式：分布式账本的节点都是平等的，不存在中心节点，整个网络由众多的节点构成。

⒉ 匿名性：不对参与者进行身份验证，不暴露个人隐私信息，提高了隐私保护水平。

⒊ 智能合约：分布式账本中的智能合约是分布式的，其代码存储在区块链网络内的每台计算机上。

⒌ 可追溯性：分布式账本记录的交易被分成区块，每一个区块都与前一个区块链接，从而形成一条链条，所有的交易记录都可以通过区块链快速查到。

⒍ 免信任：分布式账本网络中的各个节点没有相互信任的关系，只需要少量的共识就可以确保整个网络的运行安全。

那么， Hyperledger Fabric 是如何工作的呢？

Fabric 使用了一个基于gossip协议的可靠传输层，用来处理交易和区块信息，其中gossip协议是一种自学习协议，不断地选择最优的路由方式。 Hyperledger Fabric 还包括一个账本组件和一套完整的SDK工具包，允许应用开发者创建智能合约，并部署到Fabric网络上。

为了更好地理解 Hyperledger Fabric 的工作原理和特性，我们先来看一下下面的图示：


上图是 Hyperledger Fabric 的基本架构。从上图可以看到，Hlfabric主要包括三个子系统：

⒈ Gossip 通信子系统：这是 Hyperledger Fabric 中用于管理节点之间通信的组件，其中 gossip 协议采用自学习的方式，不断地选择最优的路由方式。

⒉ 交易排序子系统：用于对交易进行排序，保证交易的顺序一致性。

⒊ 账本状态数据库：这个子系统的作用是维护当前区块链的状态。

下面，我们进入正文，聊聊 Hyperledger Fabric 中的一些关键概念和原理。

# 2.核心概念与联系
## 2.1 区块链与分布式账本的区别及联系
区块链和分布式账本都是分布式数据库，但两者也存在很大的不同。

区块链是比特币和其他数字货币等金融科技所采用的存储信息技术方案，具有去中心化、不可篡改等特点；分布式账本则是基于共识算法的分布式数据库，具有不同于传统数据库的特征。

区块链的主要特点有：

⒈ 去中心化：区块链的节点都是平等的，不存在中心节点，整个网络由众多的节点构成。

⒉ 不可篡改：区块链中的每个节点只能添加新的区块，不能修改或者删除已有的区块。

⒊ 透明度：区块链中的数据记录是公开透明的，任何人都可以查看。

⒌ 匿名性：不对参与者进行身份验证，不暴露个人隐私信息，提高了隐私保护水平。

分布式账本的主要特点有：

⒈ 协作性：分布式账本之间的交易完全自动化，不需要像现实世界中的交易一样由双方进行交易协商。

⒉ 真实性：分布式账本将记录的交易放在区块链上，所以它们之间是有真实存在的，并且是不可否认的。

⒊ 快速查询：分布式账本通过在区块链上建立索引，能够让用户快速查询到某些交易。

⒌ 低延迟：分布式账本能满足快速响应时间，大大减少交易延迟。

区块链和分布式账本都属于分布式数据库的范畴，因此也存在很多相同之处，比如：

⒈ 数据存储：两者都是对信息进行存储，并确保数据一致性的方法。

⒉ 访问控制：区块链或分布式账本都有访问控制的机制，限制只有授权的用户才能访问、修改数据。

⒊ 容错性：两种分布式数据库都拥有较好的容错能力，即便某个节点出现故障，也不会影响整体系统的运行。

区块链与分布式账本在设计时也有很多不同，如：

⒈ 数据结构：区块链是中心化的，数据的存放是分散的，节点之间通过共识算法实现数据的共享，不存在“集中式”的集中节点，其数据结构相对复杂。

⒉ 技术实现：区块链与分布式账本都采用不同的技术实现，区块链是通过共识算法来确保信息的正确性，而分布式账本则是采用了一致性哈希来维护数据分布。

总结：区块链和分布式账本是两个截然不同的分布式数据库解决方案。区块链旨在建立一个开源、去中心化、不可篡改、透明度极高、不受任何控制的区块链系统，它的优点是非信任、分布式、匿名性，缺点是快速转账时间长。分布式账本是一种分布式的、协作的、真实的数据库，其优点是快速查询、真实性、低延迟，缺点是数据集中、非密码学安全、交易费用高。区块链与分布式账本有许多相同之处，比如数据存储、访问控制、容错性，但是又存在很大差异。