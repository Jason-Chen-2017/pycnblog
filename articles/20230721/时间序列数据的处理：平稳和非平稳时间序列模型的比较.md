
作者：禅与计算机程序设计艺术                    
                
                
## 概念
时间序列数据是指随着时间的推移而产生的数据记录，其特点是具有时序性、动态性、不定量特征。时间序列数据可以帮助我们更好的理解自然界中复杂系统在不同阶段的变化规律。比如经济领域的财政金融市场数据、军事领域的战争事件数据等都属于时间序列数据。我们可以使用时间序列数据进行预测分析、制定决策。

对于时间序列数据来说，常用的分析方法主要有平稳时间序列分析（stationary time series analysis）、非平稳时间序列分析（non-stationary time series analysis）。前者研究的是定常系统的行为模式，即只要初始条件确定，时间序列的发展趋势应该保持一致；后者则研究的是变动系统的变化规律，即时间序列中的长期变化往往会影响到系统的行为。

## 模型种类
平稳时间序列模型主要包括平均值趋势法（Moving Average Model）、移动平均回归法（Moving Average Regression Model）、季节性加权移动平均法（Seasonal Moving Average Model with Seasonality Weighted Moving Averages）、持续时间比例法（Continuous Time Proportion Model），非平稳时间序列模型主要包括白噪声模型（White Noise Model）、随机游走模型（Random Walk Model）、趋势跟踪模型（Trend Tracking Model）、趋势和周期分解模型（Trend and Cycle Decomposition Model）、互相关性检验模型（Autocorrelation Test Model）、结构函数模型（Structure Function Model）。

下表对上述模型进行了总结和比较，并给出了各个模型之间的联系和区别：

|名称|解释|优缺点|联系|备注|
|---|---|---|---|---|
|**平均值趋势法**|将时间序列变量X(t)的当前值作为平均值，用历史平均值的趋势来预测当前值：<br>y(t)=E[X(t)]|<ul><li>简单易懂</li></ul>|<ul><li>无关联性：任何两个样本点之间的相关性均为零。</li></ul>|适用于短期的平均值变化。|
|**移动平均回归法**|用过去k期间的平均值做多项式回归，得到趋势：<br>y(t)=a_0+a_1*E[X(t-1)]+...+a_k*E[X(t-k)]|<ul><li>时间序列信号能够较好地反映出局部平均值趋势。</li></ul>|<ul><li>当k=1时，为平均值趋势法。</li></ul>|最常用，但是当k较大的时候，预测结果可能波动剧烈。|
|**季节性加权移动平均法**|对时间序列信号进行季节性分解，将每年的波动分别用不同数量的移动平均模型进行描述：<br>y(t)=w_1MA_1(t)+w_2MA_2(t)+...+w_nMA_n(t)<br>其中，$w_i=\frac{sin[(2\pi it)/n]+1}{2}$；$MA_{ij}(t)$表示第j个季节中第i个移动平均模型在时间t时的输出。|<ul><li>考虑了季节性因素对时间序列信号的影响。</li><li>可以实现更精细化的时间段级分解。</li></ul>|<ul><li>季节性分解可以将季节性效应分解为多个季节性模型的叠加。</li></ul>|对于非平稳时间序列来说，可以提取每个季节的显著特点，更有效的预测长期趋势。|
|**持续时间比例法**|将时间序列信号按照一定的持续时间窗口分成多个子序列，假设每个子序列独立同分布地从起始时间开始持续到结束时间：<br>y(t)=c_1*S1(t)+c_2*S2(t)+...+c_n*Sn(t)<br>其中，$S_i(t)$表示子序列i在时间t时的输出。<br>通过最小化下面的损失函数求得参数c_i：<br>$L(\vec{c})=\sum_{i=1}^n||y_i-\hat{y}_i(t)||^2$, $\hat{y}_i(t)=\int_{t-d}^{t}f_i(u)\mu(t-u)du$|<ul><li>考虑了长期趋势。</li><li>适合高频交易的情况。</li></ul>|<ul><li>假设子序列间独立，实际上不一定是真实的。</li></ul>|可以看作是用短期平均值来预测长期趋势，但不需要特定模型来描述子序列的依赖关系。|
|**白噪声模型**|假定时间序列信号具有正态分布，其均值$\mu_0$和方差$\sigma_0^2$未知：<br>y(t)=\epsilon(t)|t|$+\mu_0$|where $|\epsilon(t)|\sim N(0,\sigma_0^2)$|<ul><li>简单，计算代价小。</li><li>适合非周期信号。</li></ul>|<ul><li>不适合周期信号。</li></ul>|假设时间序列信号是平稳的，否则可以拆分为多个子序列。|
|**随机游走模型**|假定时间序列信号只有一个参数，即每个时间步的状态只受前一状态的影响，并且该过程是平稳的：<br>y(t+1)=F(y(t),t)<br>where F is the state transition function|<ul><li>简单，计算代价小。</li></ul>|<ul><li>没有定义初始值，难以处理非平稳情形。</li></ul>|可以看作是无状态模型。|
|**趋势跟踪模型**|对时间序列信号建模时，同时采用多个模型来拟合平稳部分和趋势部分：<br>y(t)=b+(t-t_0)*v*<br>where v*=min{(1/L)*(t-t_0),1}, b = E[y_{t-1}]|<ul><li>考虑了局部趋势。</li><li>可以找到最佳的模型组合。</li></ul>|<ul><li>需要指定模型的个数。</li><li>难以处理非平稳数据。</li></ul>|可以同时包含局部线性趋势模型和长期趋势模型。|
|**趋势和周期分解模型**|对时间序列信号进行分解，将整体的时间序列信号分解为两个部分，即趋势部分和周期部分：<br>y(t)=l(t)+s(t) + ε(t)|t|<br>where l(t) is a local linear trend model, s(t) represents the seasonal component of the signal (such as a sinusoid or Fourier series), and ε(t) is white noise|<ul><li>适用于复杂信号。</li></ul>|<ul><li>无法完全解释长期的系统特性。</li><li>难以处理非平稳数据。</li></ul>|对时间序列信号进行分解的方法已被证明可靠，且对不同的信号都能找到最佳的分解方式。|
|**互相关性检验模型**|对时间序列信号进行平稳性检测：<br>H(m,n)=\frac{cov(x(t_m),x(t_n))}{\sqrt{var(x(t_m))}\sqrt{var(x(t_n)))}}|<ul><li>直接计算协方差矩阵，快速。</li><li>适用于任意阶自相关系数。</li></ul>|<ul><li>不知道判据是否充分。</li></ul>|以卡方统计量为判据的互相关性检验模型。此外还有其他方法如乌拉索尔变换、三角检验等。|
|**结构函数模型**|对时间序列信号进行结构分析：<br>Y(z)=1/(1-zB)^Texp(-At)|t|<br>where Y(z) is the spectrogram of the signal, B is the block diagonal matrix describing the eigenvalues of A, and T is the sampling period|<ul><li>可视化工具。</li><li>适用于复杂信号。</li></ul>|<ul><li>要求样本量足够大。</li></ul>|分析得到的瞬时频谱图反映了信号在频率上的演化，而且可以发现循环和预测的重要信息。|


## 2. 基本概念术语说明
### 2.1 时间序列数据
#### 2.1.1 形式
时间序列数据（time series data）一般是指随着时间的推移而产生的数据记录，其特点是具有时序性、动态性、不定量特征。一般情况下，时间序列数据一般采用观察值（observation value）或称实值（realization）的形式表示。

#### 2.1.2 时间
时间序列数据通常是关于时间的连续性。时间的维度可以是一维（时钟时间）、二维（日期时间）或多维（同时刻）。时间序列数据通常以时间点为坐标，记录相应的观察值或实值。时间点的具体单位可以是秒、毫秒、微秒、纳秒，也可以是日、月、年、星期、季节、半年等时间跨度的单位。

#### 2.1.3 观测值及实值
观察值（Observation Value）指的是某个时间点上所发生的现象或事物的具体数字值。在一般的描述中，观察值通常是有限的、实时的、整数的或离散的。

实值（Realization）是一个数学概念，指的是时间序列数据经过某种标准化或抽样的方式生成的一系列观察值。在许多应用场景中，一个时间序列数据往往由多个观察值组成，但为了方便对其进行分析，通常都会采用统一的抽样频率或时间间隔，并将其转换成一系列离散的实值。

#### 2.1.4 时间间隔与采样频率
时间间隔（Time Interval）通常用来衡量时间序列数据的一段连续性。如果时间序列数据采用观察值或实值的形式表示，那么时间间隔就是观察值的变化频率。对于一维的时间序列数据，时间间隔通常是连续的、可测量的、固定不变的。对于多维的时间序列数据，时间间隔可以是任意的，甚至可以是非连续的或不可测量的。

采样频率（Sampling Frequency）与时间间隔的概念非常相似。采样频率是指对时间序列数据进行采样获得观察值或实值的方式。采样频率越高，则时间序列数据中出现的跳跃点越少，但时间序列数据的真实动态特性也就越模糊。采样频率越低，则时间序列数据中出现的跳跃点越多，但是由于采样过程中丢弃了一些无关紧要的点，因此时间序列数据的真实动态特性就显得更加清晰。

#### 2.1.5 时序曲线
时序曲线（Time Series Curve）是一个连续函数，它的输入为时间，输出为观察值或实值。时序曲线具有时间的两个维度，即时间和观察值或者实值。时序曲线可以是单变量的、多变量的、混合的。

#### 2.1.6 时序图
时序图（Time Series Graph）是由多个时序曲线组成的。时序图可以表示观察值或实值随时间的变化趋势。时序图可以是静态的、交互式的、动画的、时序轴的。时序图可以用于描述、分析和预测时间序列数据。

### 2.2 平稳时间序列与非平稳时间序列
#### 2.2.1 平稳时间序列
平稳时间序列（Stationary Time Series）是一个特殊的时间序列，它处于一种平稳状态，即它的统计特性（例如均值、方差等）在时间的任何一个时刻都不随时间的流逝而发生变化。这种统计特性称为自相关性（autocorrelation）。

#### 2.2.2 非平稳时间序列
非平稳时间序列（Nonstationary Time Series）是一个时间序列，它的统计特性在时间的任何一个时刻都可能发生变化。通常情况下，非平稳时间序列可以通过以下三个过程之一发生变化：

1. 趋势（Trend）：非平稳时间序列在时间的某个时刻呈现出一个突变的现象。趋势通常是由随机漫步过程或时间结构驱动的。

2. 波动（Variation）：非平稳时间序列在某个时间点附近呈现出一定的波动性。波动性的大小取决于一组随机变量的分布情况。

3. 混合效应（Mixture Effect）：非平稳时间序列存在多个影响因素的作用。例如，财政政策、商品价格、供应需求等。

非平稳时间序列的另一种分类方法是依据它们的依赖关系分为自相关时间序列和非自相关时间序列。非自相关时间序列的自相关性依赖于所选择的时间窗口的长度。自相关时间序列的自相关性仅仅依赖于所观察到的部分时间内的时间序列。

### 2.3 模型与方法
#### 2.3.1 模型
模型（Model）是一个数学概念，用来刻画一组具有相同或类似结构的随机变量的集合。随机变量之间的依赖关系可以用概率分布函数表示。模型既可以描述观察到的现象，也可以用来进行预测。模型是数据分析的基础。

#### 2.3.2 方法
方法（Method）是一个数学概念，用来刻画如何利用模型进行分析和预测。方法包括数据准备、模型建立、模型估计、模型评价、预测结果的解释等过程。

