
作者：禅与计算机程序设计艺术                    
                
                
## 一、图分类简介
图分类(Graph Classification)是指对一个图结构的数据进行分类或者聚类。在很多实际场景中，我们会遇到图数据的处理。比如社交网络、推荐系统中的用户行为数据、文本信息网络等等。图数据由于其复杂性，特征维度高，难以用传统的机器学习方法如KNN或SVM等进行有效分类。图分类正是为了解决这一问题而提出的一种机器学习方法。图分类可以从两个方面入手：
- 将图结构中的节点划分为多个类别。这就是典型的“图聚类”问题。
- 根据节点之间的相互关系进行分类。这就是“图分类”问题。

根据图分类的目标和任务，通常可以将其分为两大类：
- 弱监督分类：无标签数据，利用节点之间的相互关系进行分类。如无监督图聚类的DBSCAN和谱聚类，无监督图分类的GCN，DeepWalk，LINE算法。
- 有监督分类：有标签数据，利用节点的属性信息进行分类。如网络安全日志中的攻击类型预测，网络流量监控中的网页分类，社会网络中的用户划分等。

此外，图分类还可分为多种子任务：
- 属性标签分类：给定一个节点，通过已有的标签数据预测它的属性标签，如电影评论情感分析中的“喜欢”或“不喜欢”。
- 多标签分类：给定一个节点，判断它所属的多个标签之一，如在一个社交网络中，给定一张照片，判断该照片所属的多个兴趣分类（如游戏、旅游、文化）。
- 多重分类：给定一个图，判断其所有节点的所有可能的标签，如一个电商网站，需要对每个产品分类确定不同的类目标签。

图分类的应用范围非常广泛，如网络安全防御、图数据挖掘、推荐系统、社会网络分析、生物信息学等领域。下面，我们将对图分类中最经典的三种模型——图聚类模型、图神经网络模型、图卷积网络模型进行详细介绍。

## 二、图聚类模型
### （一）DBSCAN模型
DBSCAN（Density-Based Spatial Clustering of Applications with Noise），即基于密度的空间聚类模型。这种模型主要用于无监督的图聚类。其工作过程如下：
1. 从样本集中选择一个点作为初始中心点；
2. 以这个中心点为半径，找出距离中心点距离较近的样本点，这些样本点成为聚类中心；
3. 对每一个新的聚类中心，继续找出距离其距离较近的样本点，加入到同一个聚类当中；
4. 不断重复第2步和第3步，直至不再有新加入的样本点，聚类完成。

如下图所示：
![dbscan](https://github.com/tsujiwai/article/blob/master/graph%E5%88%86%E7%B1%BB/img/dbscan.png?raw=true "dbscan")


DBSCAN的优缺点如下：
- 优点
  - 简单快速：不需要任何参数设置，算法运行速度快。
  - 可任意拓扑划分: DBSCAN能够检测到任意形状的聚类区域。
  - 适合低维数据：对高维数据的聚类效果尚可。
  - 没有精确的数值结果: 只输出簇个数以及每个簇中的成员，没有具体的数值。
  
- 缺点
  - 容易陷入局部最小值: 在噪声比较少时能够达到很好的结果。但当噪声比较多时，可能会陷入局部最小值，导致无法找到全局最佳解。
  - 不考虑样本间的空间依赖关系: 只能发现离散点的聚类，不能理解不同区域之间的相关性。
  - 无法识别稀疏子图中的孤立点: 会忽略掉孤立点。
  
### （二）谱聚类模型
谱聚类(spectral clustering)，又称Laplacian Eigenmaps模型，一种图聚类模型。其工作过程如下：
1. 用Laplacian矩阵表示图的拉普拉斯特征向量，得到特征向量X；
2. 使用谱分解求解X的幂次多项式，得到对应于每一个X的频率值λi；
3. 把所有的频率值按大小排序，选取前k个最大的频率值对应的特征向量组成新的矩阵Y；
4. 通过线性变换将X映射到Y，得到新的图向量X’；
5. 使用KMeans对X‘进行聚类，得到最终的图聚类结果。

如下图所示：
![spectralclustering](https://github.com/tsujiwai/article/blob/master/graph%E5%88%86%E7%B1%BB/img/spectralclustering.png?raw=true "spectralclustering")

谱聚类模型的优点如下：
- 效率高：通过谱分解可以直接得到图的特征向量，并不需要复杂的计算；
- 拥有更强大的能力：通过KMeans对图的特征向量进行聚类，可以实现更加丰富的图聚类方式；
- 适应高维度数据：可以很好地处理高维度的图数据。

但是，谱聚类模型也存在着一些限制和局限性，如下：
- Laplacian矩阵的生成需要遍历整个图，计算量大，时间开销大；
- KMeans对数据进行聚类后，无法反映出真实的聚类分布，只能提供一种粗糙的聚类方案。

### （三）GCN模型
Graph Convolutional Network (GCN), 图卷积网络模型，是一种无监督的图分类模型。其主要特点是：
- 模拟传播过程，捕获节点之间潜在的关系；
- 提供了一种对图进行表示的方法，用简单的方式构造图特征；
- 可以解决图的孤立节点和多重连接问题；
- 可以处理异构图数据。

其工作流程如下：
1. 对图进行邻接矩阵转换，得到邻接矩阵A。
2. 定义一个带有激活函数的卷积层Conv，卷积核Ci，以及一个非线性激活层ReLU。
3. 对图卷积层Conv的输出做非归一化的缩放，得到X。
4. 通过一次全连接层Fc得到最终的预测结果Y。

如下图所示：
![gcn](https://github.com/tsujiwai/article/blob/master/graph%E5%88%86%E7%B1%BB/img/gcn.png?raw=true "gcn")

GCN模型的优点如下：
- 采用邻接矩阵，可以学习节点间的空间关联关系；
- 采用卷积操作，不仅可以捕捉空间上的关系，还能捕捉节点的局部结构；
- 采用非线性激活函数，可以避免过拟合的问题。

GCN模型的缺点如下：
- 需要设置参数较多，训练速度慢；
- 训练过程中需要进行多次梯度下降，容易陷入局部最小值。

### （四）DeepWalk模型
DeepWalk，深度随机游走模型，是一种无监督的图分类模型。其主要特点是：
- 对节点进行采样，模拟从节点出发的随机游走；
- 依据每个节点周围的游走路径，为每个节点赋予一个向量表示。

其工作流程如下：
1. 设置一个窗口W，每隔W步取一个相邻节点作为中心节点；
2. 从中心节点出发，进行多步随机游走，记录游走路径；
3. 对于每个节点，根据其游走路径的长度及方向，构造一个词袋模型，对路径上出现的单词计数，得到一个向量表示V。
4. 使用词袋模型，得到所有节点的向量表示。
5. 使用KMeans对向量表示进行聚类，得到最终的图聚类结果。

如下图所示：
![deepwalk](https://github.com/tsujiwai/article/blob/master/graph%E5%88%86%E7%B1%BB/img/deepwalk.png?raw=true "deepwalk")

DeepWalk模型的优点如下：
- DeepWalk可以模拟节点间的随机游走过程，产生抽象的表达；
- DeepWalk可以使用词袋模型统计节点间的路径信息；
- DeepWalk训练起来简单，且可以快速收敛。

DeepWalk模型的缺点如下：
- DeepWalk对图的空间结构有严格假设；
- 如果图中存在孤立节点，DeepWalk可能无法产生有效的表示；
- DeepWalk并不能捕捉节点的局部结构。

