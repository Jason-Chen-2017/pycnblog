
作者：禅与计算机程序设计艺术                    

# 1.简介
  

数据库范式化是一个为了提升数据库效率和数据的完整性而进行的数据模型设计方法，它由12个标准组成，主要包括1NF、2NF、3NF、BCNF、4NF、5NF、6NF、7NF和8NF等。在设计数据模型时，需要选取符合当前应用场景中最合适的数据模型范式，才能保证数据库的查询效率高且数据的一致性较强。反范式化则相反，它的目的在于优化数据模型以减少数据冗余，从而提升数据库性能。本文将通过对数据库设计范式与反范式的介绍，从理论和实践两个方面，深入浅出地剖析这一重要概念。 

# 2.基本概念术语说明
## 2.1 概念定义
范式化（normalization）是数据库建模的过程，目的是为了消除重复数据及数据依赖，提高数据存储效率和查询效率。具体来说，范式化就是建立关系型数据库表，使得每一个字段都不受其他字段的影响，也就是说每个字段都只能取值唯一，并且非主属性不能包含派生属性；每张表只包含一个候选键，或者满足主键唯一约束条件的候选键；不存在多值依赖，即任何两个相关的记录必须存放在不同的表中。按照规定对数据库设计时，符合最低要求的范式模型才可能发挥良好的性能。


反范式化（denormalization）是在规范化的基础上增加了一项优化策略，即根据具体需求对数据库进行分解或合并，以减少数据冗余并提高数据访问速度。反范式化的目标是在关系数据库设计过程中尽量避免建立冗余数据，从而提高数据库性能。

## 2.2 标准定义
### 2.2.1 第一范式（1NF）
**1NF**：每列都是不可分割的原子数据项，确保每行只有一个值。如，每一列必须只有一个值，即没有重复的单元格。

**示例**：一个学生信息表：
| 学号 | 姓名   | 性别    | 班级   |
| ---- | ------ | ------- | ------ |
| 2019 | 小明   | 男      | 111班  |
| 2020 | 李四   | 女      | 111班  |

该表不满足1NF，原因如下：
- 存在重复单元格："李四"重复出现两次。
- "性别"列中有男、女两个单独的值。

正确的解决办法是：

| 学号 | 姓名   | 性别 | 班级   |
| ---- | ------ | ---- | ------ |
| 2019 | 小明   | M    | 111班  |
| 2020 | 李四   | F    | 111班  |

### 2.2.2 第二范式（2NF）
**2NF**：在1NF的基础上，非主属性完全依赖于主键，而不能只是部分依赖。即实体的任意两个不同属性之间都不能有函数依赖关系。

**示例**：一个学生选课表：
| 学号 | 课程名称 | 选课时间 |
| ---- | -------- | -------- |
| 2019 | 英语     | 上午     |
| 2020 | 语文     | 下午     |

该表不满足2NF，原因如下：
- “选课时间”非主键的一部分，故不应作为主键。
- “选课时间”依赖“课程名称”，但“课程名称”并非所有选课信息都必须要显示。

正确的解决办法是：

| 学号 | 课程名称 | 选课时间 |
| ---- | -------- | -------- |
| 2019 | 英语     | 上午     |
| 2020 | 语文     | 下午     |
| NULL | 数学     | 下午     |
| NULL | 物理     | 上午     |

将“选课时间”列拆开，新增一张选课详细信息表。

| 学号 | 课程名称 | 选课时间 |
| ---- | -------- | -------- |
| 2019 | 英语     | 上午     |
| 2020 | 语文     | 下午     |

| 学号 | 课程名称 | 选课时间 | 上午/下午 |
| ---- | -------- | -------- | --------- |
| NULL | 数学     | 下午     | 下午       |
| NULL | 物理     | 上午     | 上午       |

### 2.2.3 第三范式（3NF）
**3NF**：在2NF的基础上，任何非主属性不传递依赖于其它非主属性。即实体的任意两个不同属性之间都不存在传递函数依赖关系。

**示例**：一个学生考试成绩表：
| 学号 | 课程名称 | 考试时间 | 分数 |
| ---- | -------- | -------- | -----|
| 2019 | 英语     | 上午     | 80   |
| 2020 | 语文     | 下午     | 85   |

该表不满足3NF，原因如下：
- “考试时间”非主键的一部分，故不应作为主键。
- “考试时间”依赖“课程名称”，但“课程名称”并非所有考试信息都必须要显示。
- “分数”依赖“课程名称”和“考试时间”。

正确的解决办法是：

| 学号 | 课程名称 | 考试时间 | 分数 |
| ---- | -------- | -------- | -----|
| 2019 | 英语     | 上午     | 80   |
| 2020 | 语文     | 下午     | 85   |
| NULL | 数学     | 下午     | 90   |
| NULL | 物理     | 上午     | 80   |

同样，将“考试时间”列拆开，新增一张考试详细信息表。

| 学号 | 课程名称 | 考试时间 | 场所 | 日期 | 时段 |
| ---- | -------- | -------- | ---- | ---- | ---- |
| NULL | 数学     | 下午     | 1教   | 19-20 | 下午 |
| NULL | 物理     | 上午     | 2教   | 19-20 | 上午 |

再新增一张成绩表。

| 学号 | 课程名称 | 考试时间 | 上午/下午 | 场所 | 日期 | 时段 | 分数 |
| ---- | -------- | -------- | --------- | ---- | ---- | ---- | -----|
| 2019 | 英语     | 上午     | 上午       | 1教   | 19-20 | 上午 | 80   |
| 2020 | 语文     | 下午     | 下午       | 2教   | 19-20 | 下午 | 85   |

最后，该表满足3NF。

### 2.2.4 BC范式
**BC范式**: 在3NF的基础上，数据按列进行分区。即不存在部分函数依赖，所有多重依赖关系均已被消除。它适用于高度关联的数据库。

**示例**：一个餐馆订位表：
| 顾客ID | 餐厅ID | 预订日期 | 用餐类型 | 用餐人数 |
| ------ | ------ | --------| --------| ----------|
| 1001   | A123   | 2020-07-10| 标间    | 4         |
| 1002   | B456   | 2020-07-12| 拼桌    | 2         |

该表满足BC范式。因为其不存在部分函数依赖，所有多重依赖关系均已被消除。