
作者：禅与计算机程序设计艺术                    

# 1.简介
  

随着计算机视觉领域的不断发展，医疗图像的处理也变得越来越复杂。在这个过程中，不同类型的数据之间需要匹配、融合、迁移等过程才能实现精准的分析。传统的方法采用专门设计的特征提取器，通过不同的技术手段将原始的模态数据转换成相同的特征表示，然后再进行信息的传递和学习，实现最终的分割结果。然而，这种方式往往受到数据量的限制，且特征表达能力较弱。为了解决这一问题，本文提出了一种新的跨模态配准（cross-modal matching）方法，并结合迁移学习的方法，利用多模态的医疗图像对脑部 Lesion 的分类任务进行研究。

# 2.相关工作
同样需要处理多模态的数据，最近也出现了一些基于CNN的图像配准方法，比如ICP、RANSAC等，这些方法都是针对单个模态数据的。但是，如何有效地处理不同模态之间的特征重用是目前仍存在很多的挑战。其中最重要的是数据量和计算资源的问题，因为要同时处理多个模态的数据，因此其采用的算法和模型都需要更高效的实现。

# 3.主要贡献
## 3.1.多模态配准方法的介绍
本文提出的跨模态配准方法可以根据多种不同类型的特征提取器生成的特征向量来实现不同模态间的配准。它由以下几个步骤组成：

1. 对输入数据进行预处理和规范化，使其具有统一的结构和大小。

2. 通过每个模态的特征提取器生成对应的特征向量。

3. 将不同模态的特征向量在特征空间中进行匹配，得到一个合适的映射关系，使得对应特征点在不同特征向量中的位置能够对应。这里包括最近邻配准(NN)和超确定性配准(SMP)。

4. 使用这个映射关系将不同模态的特征从源特征空间映射到目标特征空间，得到配准后的特征向量。

5. 最后，应用分类器或分割器对配准后的特征向量进行预测，得到最终的分割结果。

图1展示了整个流程的示意图。如上所述，本文的关键点是通过不同模态的特征向量实现特征重用，并且采用两种不同的配准算法来处理相似性和区别性，以达到一种均衡的方式来适应不同的场景。


## 3.2.论文实验环境搭建及代码复现
环境搭建：
该项目依赖于pytoch-medical项目，可按照该项目的readme文档安装环境，如果安装过程出错，可以尝试下载源码自己编译安装。 pytorch版本推荐使用1.0以上。
```
git clone https://github.com/pfjaeger/pytorch-medical.git
cd pytorch-medical
python setup.py install
```

下载代码，下载链接：https://pan.baidu.com/s/1kM8TJDXnfFqYDLwMZIBCHQ 提取码: ebyq。该项目包括多个分割模型的代码，对于没有资源条件的用户可以先下载测试用到的网络模型进行测试。

进入项目根目录，启动jupyter notebook或者vscode打开文件`pytorch-medical-seg/train.ipynb`。配置运行环境，启动notebook即可。

### 训练配置
选择`pytorch-medical-seg`文件夹，点击右上角菜单栏：Kernel-->Change Kernel-->PyTorch with Pytorch-Medical

根据提示修改`config/test_lits.yaml`，更新路径为自己的路径。修改完毕后保存。

运行前需要设置一下环境变量`export CUDA_VISIBLE_DEVICES=0`。

### 模型训练
点击菜单栏Cell-->Run All，开始训练。此时可以在`runs`文件夹下看到日志文件，用tensorboard查看实时的训练指标。

训练完成后会生成权重文件保存在`output_dir`中。

## 3.3.作者总结
该项目是利用多模态配准的方法对脑部Lesion进行分类，从多个视角、模态中提取深层特征，建立脑部Lesion分类的通用框架。作者通过简单易懂的实验、代码复现，已经证明了这项工作的有效性和效率。