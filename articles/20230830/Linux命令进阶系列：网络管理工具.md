
作者：禅与计算机程序设计艺术                    

# 1.简介
  

Linux系统是一个开源的类UNIX系统，它提供了多种网络管理工具，可以用于配置路由、防火墙、DNS解析等网络基础设施功能。本系列教程将详细介绍一些常用的网络管理工具的用法和实际操作方法。

# 2. 环境准备
- 操作系统：Ubuntu 16.04 LTS（或者其它LTS或正式版系统）；
- 网卡：推荐安装有线网卡，保证能够通过有线网络连接外网；
- 其他要求：1、关闭防火墙、开启SSH服务；2、了解计算机网络基础知识。

# 3. IP地址管理工具ip
## 3.1 ip命令概述
IP(Internet Protocol)地址管理工具，主要用来管理本地主机的IP地址。此工具是Linux系统中最重要的工具之一，可用来设置IP地址、查询网络设备状态及相关信息、显示路由表、查看网络接口信息、修改网络设置等。

## 3.2 配置静态IP地址
### 3.2.1 查看当前IP地址
命令：ifconfig

输出示例如下：

```
eth0      Link encap:Ethernet  HWaddr a0:b0:c0:d0:e0:f0  
          inet addr:192.168.0.1  Bcast:192.168.0.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:100 errors:0 dropped:0 overruns:0 frame:0
          TX packets:88 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:1305 (1.2 KiB)  TX bytes:1171 (1.1 KiB)

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:0 (0.0 b)  TX bytes:0 (0.0 b)
```

**注意**：如果没有配置静态IP地址，则inet addr字段为空值。

### 3.2.2 设置静态IP地址
命令：`sudo ifconfig eth0 <ip_address> netmask <netmask>`

其中，`<ip_address>` 为静态IP地址；`<netmask>` 为子网掩码。

例子：

```
$ sudo ifconfig eth0 192.168.0.100 netmask 255.255.255.0
```

### 3.2.3 修改静态IP地址后的生效时间
生效时间取决于系统设置。一般情况下，重启之后IP地址就会失效，所以建议立即生效。

## 3.3 动态IP地址管理工具dhclient
动态IP地址管理工具dhclient，可以在不手动指定IP地址的情况下自动获取IP地址，从而实现IP地址自动获取。该工具在启动时默认不会获取IP地址，需要手工执行命令，手动激活获取IP地址的过程。

## 3.4 启用/禁用网卡
### 3.4.1 启用网卡
命令：`sudo ifconfig eth0 up`

### 3.4.2 禁用网卡
命令：`sudo ifconfig eth0 down`

## 3.5 查看网络连接状态
命令：`sudo netstat -antp | grep ESTABLISHED`

输出示例如下：

```
tcp        0      0 192.168.0.100:50110    192.168.0.1:https    ESTABLISHED 1352/chrome --type=zygote 
```

## 3.6 查询路由信息
命令：`route -n` 或 `netstat -rn`

输出示例如下：

```
   Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
0.0.0.0         192.168.0.1     0.0.0.0         UG    600    0        0 wlp3s0
169.254.0.0     0.0.0.0         255.255.0.0     U     1000   0        0 wlp3s0
192.168.0.0     0.0.0.0         255.255.255.0   U     600    0        0 wlp3s0
```

## 3.7 域名服务器配置
### 3.7.1 DNS工具dig
dig命令是一个强大的DNS查询工具，可以用来查询域名对应的IP地址、记录类型、记录值等信息。

例如：

```
$ dig www.google.com

; <<>> DiG 9.11.3-1ubuntu1.11-Ubuntu <<>> www.google.com
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 20631
;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 4096
;; QUESTION SECTION:
;www.google.com.                IN      A

;; ANSWER SECTION:
www.google.com.         1799    IN      CNAME   google.sa.ns.google.com.
google.sa.ns.google.com. 7200    IN      A       192.168.127.12

;; Query time: 7 msec
;; SERVER: 192.168.0.1#53(192.168.0.1)
;; WHEN: Fri Dec 29 22:39:22 CST 2019
;; MSG SIZE  rcvd: 115

```

### 3.7.2 DNS配置文件
通常系统会自带DNS配置文件`/etc/resolv.conf`，这个文件记录了DNS服务器地址。我们可以通过修改这个文件来修改DNS服务器地址。

```
$ cat /etc/resolv.conf
# Generated by NetworkManager
nameserver 192.168.0.1
search localdomain
```

通过修改后面的`192.168.0.1`字段为你的DNS服务器地址即可。

### 3.7.3 查看DNS缓存
DNS缓存是指系统先查询自己本地缓存，如果没有查询到，才向远程DNS服务器请求查询结果并保存到缓存。因此，可以通过检查一下DNS缓存是否存在相应记录来判断当前网络是否正常。

命令：`host www.baidu.com`

输出示例如下：

```
Trying "www.baidu.com"
Using domain server:
Name: localhost
Address: ::1#53
Aliases: 

Address: fe80::a6db:2fb8:ccda:e6c3%wlp3s0

Non-authoritative answer:
www.baidu.com canonical name = www.a.shifen.com.
Name: www.a.shifen.com
Address: 192.168.3.11
```