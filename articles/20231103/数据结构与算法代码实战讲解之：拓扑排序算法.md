
作者：禅与计算机程序设计艺术                    

# 1.背景介绍


## 拓扑排序（Topological Sort）
拓扑排序是一种对有向无环图（DAG, Directed Acyclic Graph）中各顶点的线性序列进行排序的方法。其基本思想是在无环图中，对于每个节点来说，只要所有指向它的边都被处理过了，那么这个节点就可以输出到结果中。因此，一个节点被输出到最终结果之前，必须等到它的所有依赖项都已经输出完毕。输出过程可以用一个队列或栈来实现。
拓扑排序算法通常用于对有序集合中的元素进行排序。由于拓扑排序算法采用先后次序的定义，因而不能保证返回唯一的排列顺序。当输入中存在回路时，拓扑排序算法也无法正常工作。但是，如果输入是一个 DAG，则一定能给出一个线性序列。因此，在很多情况下，拓扑排序算法可以作为一种有效的排序算法使用。例如，在编译器中，通过识别语法关系和依赖关系，然后应用拓扑排序算法将相关任务安排好顺序，从而能够高效地完成编译任务。
## 概念
### 有向无环图（DAG, Directed Acyclic Graph）
在计算机科学中，有向无环图（DAG, Directed Acyclic Graph）是一种无向连通图，其中任意两个顶点之间都有且只有一条路径相互连接。换句话说，该图不存在着回路，即图中不存在着以某个顶点为起始点、以另一些顶点为终止点的环。
### 顶点、边
- **顶点**：表示有向图中每一个不同的点，或者称之为结点或顶点。
- **边**：表示顶点之间的链接。它有两个特点：方向性和无向性。一个边由一个起点顶点和一个终点顶点组成；每个顶点可以有多个入边，但只能有一个出边。
### 强连通分支（Strongly Connected Component，SCC）
在一个有向无环图中，如果两个顶点之间存在一条路径，则这两个顶点就构成了一个强连通分支（SCC）。一个有向无环图的最大的强连通子图就是图中的一个强连通分支。另外，一个图中的最大强连通子图是该图的一个划分。
## 算法
### DFS遍历
DFS遍历就是对有向图进行深度优先搜索（Depth First Search, DFS），是一种用来查找图中所有顶点的拓扑排序的方法。一般情况，它会首先访问图中的某个节点，然后再递归地访问它所有的邻居，直到没有更多的可访问的邻居。这种方式使得算法对某些特殊的图更加有效。
### 拓扑排序的算法
#### Kahn算法
Kahn算法是拓扑排序最简单的一种方法。它的基本思路是，找出所有入度为0的节点并添加到队列中。然后依次弹出队首节点，并删除图中与其相连的边，同时将其余边的入度减1。重复此过程，直到队列为空，或者图中不存在入度非0的节点。
算法的实现比较简单，但是时间复杂度为O(E+V)，其中E表示图中边的数量，V表示图中顶点的数量。
#### Tarjan算法
Tarjan算法与Kahn算法类似，也是基于DFS的算法，不过它比Kahn算法的优越之处在于支持多个入度为0的节点的情形。它通过两个额外的数据结构来记录节点的发现时间和结束时间，以及控制搜索方向。
算法的时间复杂度仍然是O(E+V)，但比Kahn算法的性能更佳，这是因为Tarjan算法避免了频繁地扫描整个图，而只需要在每个节点第一次进入栈时设置时间戳，并且可以直接判断当前节点是否已被完全探索过。