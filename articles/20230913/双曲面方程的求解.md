
作者：禅与计算机程序设计艺术                    

# 1.简介
  

## 一、定义
双曲面（hyperbolic surface）又称为超曲面或虎穴面，是在M空中通过的一条曲线。图示如上所示。
双曲面的一般形式为$z=ax^2+bx+c$，其中$a, b$, 和 $c$ 是双曲面的参数，$z$是双曲面上的点的坐标值。它是一条由双曲线和两个方向分别延伸的直线的集合。这两条曲线分别记作$y=u(x)$ 和 $v(x)=dx^2/dy+k$ ，其参数分别为$\gamma$ 和 $\delta$ 。双曲面由四条曲线组成，有时也可将其看作四条曲线的交集。
## 二、参数方程的计算
### （1）分式法
双曲面的参数方程可用分式法来表示，即$z = \frac{x}{2} +\frac{\sqrt{-(\alpha x+\beta)}}{2}$, 其中$\alpha$ 为实部，$\beta$ 为虚部。
### （2）牛顿法
用牛顿法可以得到双曲面的参数方程，首先将双曲面的表达式进行变换：
$$z = ax^2 + bx + c $$
等价于：
$$a z^2 + byz + cy = (a - d) y^2 + dxz + k $$
其中$d=\sqrt{|a^2 - 4ac|}=\pm \sqrt{|\beta|^2-\alpha^2}$, $e=-2ax+\beta$. 通过应用拉格朗日乘子法，可得方程：
$$az^2+bz+ce=f$$
其中$a=1/\gamma$, $b=-1/\delta$, $c=b^2+2de$, $f=(a+d)(b^2+2de)-ae$$.
在此条件下，方程组得：
$$\begin{cases}(1-\delta^2) a z^2+(1+\delta)\beta z+c &= f \\
-2 e y^2-(2d+\delta)\alpha x+\beta &= g\end{cases}$$
其中$g=1-2de-b^2+ab+\delta^2+ad+bd=\delta^2\left(2+\sqrt{(1+\delta)^2-\delta^2}\right), h=\delta^2\left(2-\sqrt{(1+\delta)^2-\delta^2}\right)$.
解出此方程组，可得到双曲面的参数方程：
$$z = \frac{x}{\gamma}-\frac{b^2}{2d}+\frac{bc+deh}{2dh}+\frac{be-dg}{2(d-b)}$$
### （3）贝塞尔曲线法
贝塞尔曲线法也是求双曲面的参数方程的方法之一。它运用了相似三角形的性质来近似双曲面的形式。将双曲面的表达式改写为：
$$z=ax^2+bx+c=\frac{1}{(ax+b)^2}+\frac{1}{(cx+d)^2}=r+\frac{1}{s}$$
其中$r=\frac{1}{(ax+b)^2}$, $s=\frac{1}{(cx+d)^2}$ 为双曲面的参数。考虑这样一个方程：
$$rs+tr=1,$$
其中$r,\ s$ 是比例系数，$t$ 是位置变量。它给出了一个等距圆锥曲线的切线的方程。对这个方程求积分，并代入$rs$和$ts$的定义，可得：
$$rt+(1-rs)e^{t\cos\theta}=\int_{-1}^1 e^{st\cos\theta}dt=s-er^{-s\sin\theta}, \quad r>s.$$
此积分对应着位于双曲面的某个三角形内部的曲线$C$的倾角$\theta$。为了找到对应圆锥曲线的参数方程，取$E$为$z$轴交点，$F$为双曲面$z=\infty$ 的交点，那么$C$的两个切线的交点$A,B$就可通过已知的曲线倾角和圆锥曲线倾角关系求得。
再考虑另一个方程：
$$rs+tr=1,$$
可得：
$$rs+tr=1 \Rightarrow st-re^{st\cos\theta}=1-te^{st\cos\theta}, \quad t\in [0,1].$$
这个方程是余弦定理的应用。要找到对应圆锥曲线的参数方程，需要把它积分，并再次进行替换$et^{-es\sin\theta}$，此处$e$为$C$的焦距。取$y=te^{-st\cos\theta}$，对它进行积分，得到：
$$\ln te^{-st\cos\theta}=st-e^{-st\cos\theta}(1-t)+const.$$
代入$rs+tr=1$，得到：
$$rs+\ln te^{-st\cos\theta}=(1-t)r+(1-t)e^{-st\cos\theta}.$$
此方程给出了一个椭圆$C'$的参数方程。接下来要把它映射到$z$轴交点$E$和双曲面$z=\infty$ 的交点$F$上。设$A'=(1-t)A, B'=(1-t)B$。于是圆锥曲线的参数方程$Ax^2+Bx+C$, $Ex^2+Fy'+Fz$,$Fx'^2+Gy'+Gz$可以求出。