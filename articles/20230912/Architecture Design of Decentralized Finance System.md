
作者：禅与计算机程序设计艺术                    

# 1.简介
  
：Decentralized Finance (DeFi) 是由加密货币、数字资产、区块链等新兴技术所驱动的一个新的金融体系。其创始者之一——MakerDAO将它称作"去中心化金融"或"去中心化的金融生态系统"。
在本文中，我们将会介绍DeFi系统的架构设计，并从市场角度出发，阐述DeFi的发展趋势与挑战，以及相关的资金流动方向。如有不明白之处，欢迎随时联系我进行提问。
## 1.背景介绍
DeFi是一个相当复杂的系统，涉及众多领域的专业知识、经济学和科技。因此，无论对于任何个人或组织，都难以完整理解和把握其内部工作机制。然而，如果能够从宏观上审视一下DeFi的架构设计，可以帮助我们更好地理解其工作方式。在此，我们将借鉴MakerDao的成功经验，对比分析其架构设计，并试图通过以下几个方面，来对DeFi架构做出更加深入的分析:

1. 架构设计：从源头到终点，对整个系统的架构设计进行一个全面的综述。
2. 发展趋势：展示DeFi目前的发展趋势，以及DeFi的未来发展方向。
3. 挑战：抓住DeFi最大的挑战，探讨其背后的原因。
4. 资金流动方向：梳理DeFi各个子系统之间的资金流动方向，找出其最佳的组合方式。
5. 概念和术语：阐述DeFi系统的一些重要概念和术语，方便读者理解。

## 2.基本概念术语说明
### 2.1 DeFi架构设计概览
DeFi的系统架构一般包括四大模块：
1. User Interface (UI): 用户接口，主要用于用户与DeFi平台的交互。
2. Smart Contracts (SC): 智能合约，存储数据和执行合约逻辑。
3. Liquidity Pools: 交易池，提供各类资金流动的平台。
4. Protocol Management: 协议管理，集成各个子系统的功能和流程。
如下图所示：

### 2.2 DEX (Decentralized EXchange) 去中心化交易所
DeFi中的DEX(Decentralized Exchange)，是指去中心化交易所。它是一个基于数字货币网络的去中心化的交易平台，使得用户可以在不依赖第三方支付机构的情况下，进行数字货币的买卖活动。DEX可以帮助用户完成以下几种交易：
1. 交易撮合: 通过交易所运行的自动化程序，对数字货币的报价信息进行匹配和成交。
2. 提现: 可以将数字货币转移至另一个用户的账户内，实现资产的自由兑换。
3. 交易费用结算: 在交易过程中产生的手续费按比例分摊给交易所方和用户方。

DEX的功能可以简化为三步：
1. 报价: 用户可以通过界面或手机应用程序输入想要交易的数字货币的信息，例如数量、价格、类型等。
2. 确认交易: 交易双方将通过软件验证订单，确认能够实现交易。
3. 执行交易: 订单成交后，数字货币将被锁定或转移至另一个账户。

DEX主要存在的问题在于中心化运营模式带来的隐性风险和效率低下。特别是在DEX的高频交易环境下，可能会导致交易所拥有的资金无法支撑较大的交易额度。此外，DeFi用户也可能陷入高昂的交易费用负担。

### 2.3 MakerDao 模块
MakerDao是DeFi的早期创始者之一，他将其称为“去中心化的金融生态系统”，是第一个支持非标准货币(如DAI)的DeFi项目。MakerDao平台提供了Maker(DAI Stablecoin)和DaiUSD(稳定的USD-Dai代币)两个合约。其中Maker是一种可兑换的稳定币，DaiUSD是一种1:1兑换的资产。MakerDao平台通过智能合约实现代币之间的流通，并根据市场需求来调整代币供应量和流动性。

MakerDao通过发行两种资产，即MAKER（稳定币）和DAI（稳定币），来满足用户对稳定币和资产的需求。与其他的DeFi项目不同的是，MakerDao提供稳定币(Maker)作为可兑换资产，而且是第一批提供稳定币的平台。

#### 2.3.1 稳定币 (Maker)
Maker是一个支持各类数字资产的可兑换货币。它与传统货币不同，它的特性在于其具有每年固定增值比率，并且可以被认为是一种储备货币。持有Maker的人可以暂时免受中心化货币交易所(如Coinbase Pro、Binance)的波动影响，实现对数字资产的控制。

Maker的特点有如下几点：
1. 透明性: Maker的理念着重于保障数字资产的价值安全性。
2. 可替代性: 由于Maker可以代表任意类型的数字资产，所以不需要支付费用即可取款或者存款。
3. 去中心化: Maker没有实体的银行和法人团队，所有权归属于持有者。

#### 2.3.2 DAI
DAI也是一种支持各类数字资产的可兑换货币。它是对Maker进行升值的结果。持有DAI的人可以享受Maker所提供的价格上的优势，同时还可以获得Maker提供的信贷服务。由于DAI并不是1:1兑换的，所以目前仍然存在可能损失的风险。但是DAI的主流媒体都声称DAI比Maker高一点。

#### 2.3.3 USDC 和 USDT
USDC 和 USDT是两种支持美元的稳定币。USDC和USDT的主要区别在于，USDC可以兑换Maker的价值，而USDT不能兑换。他们都是稳定的数字货币，可以通过各种平台进行兑换。USDC可以在Maker上构建借贷，因为可以被视为在Maker市场中的一种储备。USDT则可以直接兑换美元。虽然这两种稳定币有些类似，但它们各自有不同的角色。

### 2.4 Compounding 模块
Compounding模块是MakerDao平台的组成部分。它通过发行CDAI(抵押资产的稳定币)来解决收益的稳定问题。CDAI与Maker具有同样的特点——透明、可替代、去中心化。CDAI的主要作用是在Maker上构建借贷，支持可追溯的借贷服务。持有CDAI的人可以享受Maker所提供的价格上的优势，同时还可以获得Maker提供的信贷服务。

CDAI主要有三个用途：
1. 价值锚定: CDAI可以绑定在比特币、以太坊等加密货币的价值上，使之成为稳定币。这样的话，只要保证比特币的价格稳定，就可以让DAI的价值得以维持。
2. 治理激励: CDAI可以用来增强MakerDao平台的治理能力。举个例子，持有CDAI的人可以用来投票选出重要官员，以影响平台的决策。
3. 投资风险平价: CDAI也可以用来进行投资的风险平价。比如，如果您持有一份CDAI，同时也持有ETH或其他资产，那么你可以开仓期货合约进行交易，来实现资产的套利。

### 2.5 Uniswap 模块
Uniswap是一款协议，它允许用户用DAI购买ERC-20代币。Uniswap的主要作用是将DAI购买的代币流动性与MakerDao平台中的代币流动性进行转换。用户持有某种代币时，可以将其加入到Uniswap池中，从而获取DAI。

Uniswap的特点有：
1. 无限的流动性: Uniswap平台上提供的流动性是无限的，可以支持数十亿用户的日常交易。
2. 择isEquality: Uniswap的使命是打造一个公平的交易平台，不管是买入还是卖出都要遵守各方的交易量平衡原则。
3. 不收取手续费: Uniswap平台本身不收取任何交易费用，这与MakerDao一样。

### 2.6 AAVE 模块
AAVE是另一款协议，它也是DeFi平台的一部分。AAVE通过借贷贷款的方式，提供资金的可靠性。与其他DeFi平台一样，AAVE采用去中心化的方式，不依赖任何的第三方机构。

AAVE的主要作用有：
1. 借贷服务: AAVE的借贷服务非常便宜，它并不收取任何费用，而且在建立贷款人和借款人的关系之后，每一笔借款的利息都归属于借款人。
2. Lending Rate: AAVE的Lending Rate在设定好的范围内，将按照预先设定的利率向用户借款。这就保证了资金的可靠性。
3. 平衡工具: AAVE提供了一些工具，用来帮助用户在其余的DeFi产品之间平衡资金。比如，它提供了一个叫做Aave Tokenize Vaults 的工具，可以把MakerDao中的MAKER与Aave中的AAVE进行借贷。

### 2.7 YieldFarming 模块
YieldFarming是另一个DeFi平台，它也是MakerDao平台的一部分。YieldFarming通过激励持有MakerDao平台的用户来赢得DAI。持有MakerDao平台的用户可以将其代币加入到奖励池中，然后得到分红。该平台采取的方式是通过借贷的形式进行赎回，而不是直接发放到用户的钱包中。

YieldFarming的主要作用有：
1. 质押: 使用抵押品质押的用户可以在平台上得到分红。
2. 年化回报率: 如果在平台上质押的用户不满意，他们可以要求退回抵押品，分红率也会相应降低。
3. 低手续费: YieldFarming平台只收取少量手续费，而MakerDao平台却需要付出巨大的手续费。

### 2.8 Markets 模块
Markets模块包含了一系列的子系统，比如，MStable、Curve和Synthetix。MStable是一款由Maker合作推出的DeFi交易平台，它的目的是建立一个去中心化的套利交易市场。 Curve 和 Synthetix 都是另两款协议，它们旨在解决宏观经济形势带来的通胀风险。MStable的目标是建立一个全球化的套利交易市场，交易者可以直接在交易平台上进行交易。Curve 将稳定币A放在流动性较差的市场上，而Synthetix将稳定币B放在流动性较好的市场上，因此可以获得更大的收益。

最后，我们再总结一下，DeFi系统的架构设计大致可以分为以下几个方面：
1. DeFi中的不同子系统。
2. 不同子系统之间的资金流动方向。
3. DeFi项目的目标和使命。