
作者：禅与计算机程序设计艺术                    

# 1.简介
  
  
组合模式（Composite Pattern）允许客户端透明地处理单个对象和组合对象的层次结构，使得客户端代码可以一致地处理单对象层次和复杂的组合对象层次。组合模式属于结构型设计模式。  

意图：Compose objects into tree structures to represent part-whole hierarchies.   

主要解决：

表示对象的整体-部分层次结构。  

何时使用：

希望构造出一种树形结构的对象，表示“部分-整体”的层次结构。  

如何解决：

树形结构的每个节点是一个简单对象或者一个组合对象。composite对象负责它的子对象管理，这样当客户调用一个composite对象的method时，会递归调用其子对象的method。  

关键代码：

Component：树中节点的基类。
Leaf：叶子节点。
Composite：组合节点。
Client：树的使用者。
应用场景：

1、UI组件的构成。比如按钮组、菜单项、对话框中的控件等都可以看做是树形结构的例子。通过Composite模式，能够轻松地构造出复杂的树形结构。
2、文件系统组织结构。所有的文件都可以看做是一颗文件系统目录树的根节点，通过Composite模式，能够轻松地实现任意层次的文件系统结构。
3、数据库查询结果集。数据库系统返回的多条记录就是一个复杂的树形结构，例如SELECT * FROM table_name，通过Composite模式，能够轻松地遍历、统计或输出该结构的数据。
# 2.基本概念术语说明
## 2.1.Composite模式的角色
**Component:**    是组合模式的角色之一，它是最基本的对象接口，定义了管理成员对象的方法，如add()、remove()和getChild(int index)等。

**Leaf:**     叶子节点是组合对象的最底层节点，没有子节点，也就不再需要管理子节点了。对于那些不含子节点的对象，可以使用Leaf作为其类的父类，而不是Composite。

**Composite:**      组合节点是一种特殊的容器对象，用来存储子部件并在它们之间递归地执行操作。组合节点一般有一个用来存放子部件的集合，客户端可以通过该集合访问其成员对象，也可以在运行时动态地增加或删除成员对象。

**Client:**     使用Component和Leaf/Composite对象的方式通常都是相同的。但是如果需要区分它们，则可以使用以下方法来区分：

1. 如果某个类的所有子类都是Leaf，则直接用Leaf作为父类；
2. 如果某个类的所有子类都是Composite，则直接用Composite作为父类；
3. 如果某个类的子类既包括Composite又包括Leaf，则创建新的抽象类，继承自Component，同时包括相应的接口方法；
4. 在使用上述方式时，除非必要，不要直接使用Component，而应该根据业务需求使用其子类。

# 3.核心算法原理和具体操作步骤以及数学公式讲解
## 3.1.基本结构
### 3.1.1.Composite模式的UML类图
1. Component是树形结构的顶级节点，用来声明管理子节点的方法。    
2. Leaf是树形结构的叶子节点，没有子节点。         
3. Composite是树形结构的中间节点，有子节点，并且提供一个方法用来管理子节点。        
4. Client是使用Component和Leaf/Composite对象的类。             
### 3.1.2.Composite模式的组成结构
组合模式包含如下几个部分：
1. 抽象组件（Component）：它的主要作用是管理子部件，可以添加或者删除子部件，它还可以遍历得到所有的子部件。它是一个接口，里面定义了一系列的方法，比如用于管理子部件的add()和delete()方法。
2. 叶子节点（Leaf）：这个类没有子节点，也就是说它是一个空类，不能再添加子节点。
3. 复合节点（Composite）：它实现了抽象组件接口，所以具有管理子部件的能力。同时它还可以拥有自己的子节点。因此，它可以包含多个子节点。
4. 客户端（Client）：它使用组合模式来构建树形结构。
### 3.1.3.Composite模式的优点
1. 组合模式能够很好地体现面向对象的特性，它将对象组织到树状结构中，可以方便地进行统一管理。
2. 可以形成复杂的树形结构，使得程序的扩展性非常强。
3. 支持动态的组合，适应变化，符合开闭原则。
4. 客户端代码可以一致地处理单对象和组合对象的层次结构，无论采用哪种结构都可以获得同样的结果。