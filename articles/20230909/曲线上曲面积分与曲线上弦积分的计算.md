
作者：禅与计算机程序设计艺术                    

# 1.简介
  

曲线上曲面积分（曲面积分）又称曲面积分或曲线上曲面积分，是指在曲线 $y=f(x)$ 上某点 $P$ 和曲面 $Z=z(x,y)$ 之间，通过曲线 $y = f(x)$ 的一个曲率不为零的部分，进行曲线积分计算的一种方法。与曲面积分不同，曲面积分可以直接在参数空间中积分，而不需要求解该曲面的法向量。曲面积分又分为曲面曲线积分、曲面区域积分和曲面弯矩积分等。曲面弯矩积分可用来研究曲面倾角变动对物体表面形状的影响，是物理学、工程学及医学等领域中重要的数值计算工具。

曲线上曲面积分的计算通常包括两种类型：曲线积分和曲面弧度积分。曲线积分指的是曲线上的曲线积分，即计算 $\int_{C}f\sqrt{dx dy}$ ，其中 $C$ 是曲线 $y=f(x)$ 在某个区间上的曲率闭合集；曲面弧度积分指的是曲面 $Z=z(x,y)$ 在一条曲线 $y=f(x)$ 上弦长 $s$ （弧长可由半径 $r=\frac{\text {arccos } \left[ z_{o} \tan \theta \right]}{\sin \theta}$ 及角度 $\theta$ 确定）上的曲面积分，即计算 $\int_{\rho}(r^2ds+\frac{dz}{dr})$ 。

曲面积分是近代数学的一个分支，它的主要研究对象是曲面，从 1789 年亚当·斯密（Adi Sigma）的著作“存在与函数”里开始，到 1905 年莱布尼兹（Leibniz）的“曲面和曲线”里演变而成。在历史上，曲面积分曾经是一个极其重要的工具，用于描述空间中的曲面形状，计算物理学中的流体力学、电磁学等运动现象等。但随着工程技术的飞速发展，计算机的出现和计算能力的提升，曲面积分也逐渐被越来越少的人们所关注。近年来，由于高性能计算器的普及，曲面积分的应用也越来越广泛。

曲面积分通常是基于微分几何的观念来研究的，微分几何的基本概念有导数、曲线、曲面、曲率等，并假设曲面可微。由于曲面积分依赖微分几何的观念，因此它受限于微分几�曲面的一些特性，比如没有一致曲率。另外，由于曲面积分涉及曲面的解析表示形式，因此只能对平面曲面或者参数方程形式的曲面计算。因此，目前应用最为广泛的还是利用代数方法来计算曲面积分，如 Singular 模块、FEniCS、Paraview Catalyst、CloudVolume、GeoJson 数据格式等。

2.基本概念术语说明

曲面 $Z=z(x,y)$ 或 $Z=z(\mathbf{x},t)$ ，$\mathbf{x}$ 为曲面坐标，$t$ 表示时间，$z$ 是函数，$z=z(x,y)=-x^2+y^2+xy$ 是最简单的曲面函数。

曲线 $y=f(x)$ ，$x_0<x<x_1$ ，且满足 $\Delta y = f(x+\Delta x)-f(x)=df/dx\Delta x+\frac{d^2f}{dx^2}\frac{\Delta x^2}{2}$, 其中 $\Delta x$ 为 $\Delta x=h-\delta x$ ，$\delta x>0$ 为给定的精确度。

曲面 $Z=z(x,y)$ 或 $Z=z(\mathbf{x},t)$ 在 $(a,b)\times (c,d)$ 范围内，$(a,b)$ 是第一坐标轴，$(c,d)$ 是第二坐标轴，坐标系的单位长度为 $1$。

$Z$ 的轮廓线记作 $\partial Z$ ，有界闭曲面 $\Omega$ 是由曲面 $Z$ 的边界曲线构成的封闭区域。

曲线 $y=f(x)$ 在区间 $I=[a,b]$ 上定义的弦（弧长为 $\rho$ ）称为 $\mathrm{Arc}_f(I)$ 。

曲线 $y=f(x)$ 在区间 $I=[a,b]$ 上定义的弦的弧度是 $\frac{T}{\rho}$ ，其中 $T$ 是曲线在 $I$ 上的转过角度。

曲面 $Z=z(x,y)$ 在 $p=(a,b)$ 处的切平面叫做 $Z$ 在点 $p$ 的切平面或切线面。

曲面 $Z=z(x,y)$ 的等价椭圆中心及焦点为 $\gamma$ 。

曲面 $Z=z(x,y)$ 的一级曲率，由级数 $\sum_{k=1}^n |M^{(k)}|^{p}$ 递推式得到，其中 $p$ 为参数，$M^{(k)}$ 是 $Z$ 在 $k-1$ 阶偏导数基 $\mathcal{B}^{(k-1)}$ 中的一组法矢，由式 $\nabla z=M^{(k)}\mathcal{B}^{(k-1)}$ 得出。

曲面 $Z=z(x,y)$ 的二级曲率矩阵 $K(\lambda)$ ，对任意 $\lambda,\mu,\nu$ 满足 $\partial_\lambda \partial_\mu K - \partial_\lambda \partial_\nu K + \partial_\mu \partial_\nu K = 0$ 。

曲面 $Z=z(x,y)$ 的曲面等嵌入，定义域为 $[-R, R]\times [-R, R]$ ，则任取 $z$ 在 $R$-球内的一点 $q$ ，曲面 $Z$ 可将 $q$ 映射到另一个球面 $Q$ 上，且 $dq^2 = |\det DZ/dq^2|$ ，其中 $D$ 是曲面导数矩阵，$Z$ 的二阶曲率可由 $K$ 矩阵得到。

# 3.核心算法原理和具体操作步骤以及数学公式讲解

## 3.1 曲线上曲面积分

### 3.1.1 曲线积分

对于曲线 $y=f(x)$ 在区域 $R$ 上的曲面积分，记 $S=\int_R dz=\int_a^b f(x)dx$ ，也就是曲线 $y=f(x)$ 从 $x=a$ 到 $x=b$ 上面积的意义。

曲线积分的基本公式如下：
$$
\begin{equation*}
    \int_R f(x) dx=\lim _{\Delta x \to 0} \left.\frac{1}{\Delta x}\int_{x-y}^{x+\Delta x} f(u) du\right|_{\substack{(a,b) \\ a=x-y}}+\cdots+\int_{x+\Delta x}^{b} f(u) du
\end{equation*}
$$
直观上，曲线积分是将曲线 $y=f(x)$ 以 $y=0$ 作为参考原点对称，分别对两端截去相邻的若干个垂直距离 $L$ 的小矩形区域进行积分，从而得出该区域的曲线积分。

下一步，我们引入曲面积分的概念，对曲线 $y=f(x)$ 在区域 $R$ 上的曲面积分称为曲面积分。

曲面积分是指在曲面 $Z=z(x,y)$ 中某一点 $P$ 和曲线 $y=f(x)$ 之间，通过曲线 $y = f(x)$ 的一个曲率不为零的部分，进行曲线积分计算的一种方法。与曲线积分不同，曲面积分可以直接在参数空间中积分，而不需要求解该曲面的法向量。

具体计算过程如下：

1. 确定 $f(x)$ 在 $R$ 中的表达式，并求得相应的曲率场。

   $$
   \begin{equation*}
       S=\int_R f(x) dx=F(-\infty)^{\infty}=F(x_0,y_0), F(x',y')=f(x'),-\infty<x'<\infty, \quad y'=\text{const}, \forall x'
   \end{equation*}
   $$

   这里，$F(x,y)$ 是曲面 $Z=z(x,y)$ 在点 $(x_0,y_0)$ 处的值。

2. 求解曲面积分表达式。

   为了方便起见，我们可以先把积分区域用方框 $R$ 来表示。

   $$
   \begin{equation*}
        I_{ab}(x,y):=\left\{U: U=\{(x,y): a<x<b, c<y<d, z(x,y)<0\}\right\}
   \end{equation*}
   $$

   将曲线 $y=f(x)$ 对参数变量 $y$ 积分，得

   $$
   \begin{equation*}
       \int_{y_0}^y f'(x) dx=F(x_0,y_0)+\int_{-\infty}^x [f(t)-f(x_0)]dt
   \end{equation*}
   $$

   带入第一步的结果，再结合曲线积分的公式，就有

   $$
   \begin{equation*}
       \int_R f(x) dx=F(x_0,y_0)+\int_{-\infty}^x [\int_{U}(z(t)-z(x_0))dt-\int_{U'}(z(t)-z(x'))dt]dx
   \end{equation*}
   $$

   分别记 $X_{\pm}=[x_{\mp},x_{\mp}+\Delta x]$ 和 $Y_{\pm}=[y_{\mp},y_{\mp}+\Delta y]$ 是 $(x,y)$ 的两个邻域，即 $Y_{\pm}>c$, $Y_{\mp}>c$, $X_{\pm}>a$, $X_{\mp}>a$ 。

   考虑第一项 $[\int_{U}(z(t)-z(x_0))dt-\int_{U'}(z(t)-z(x'))dt]dx$ ，将 $\Delta x$ 带入有

   $$
   \begin{align*}
       &\int_{Y_{\pm}}(z(t)-z(x_0))dt\\
       &=\int_{[c-y_{\mp}+\Delta y,c]}(zt-(zc+xc)/y_{\mp}-xc)|_{x_0-x_{\mp}+\Delta x}\cdot y_{\mp}\\
       &=\int_{Y_{\pm}}\left[(yt-yc)\int_{x_{\mp}}^{\min(x_{\mp}+\Delta x,b)} [z(t)-(zc+tc)/(yt-yc)-tc] dt+(yt'-yc'\int_{x_{\mp}}^{\min(x_{\mp}+\Delta x,b)} [z(t)-(zc'+tc')/(yt'-yc')-tc'] dt\right]dy_{\mp}\\
       &=\int_{Y_{\pm}}\left[(yt-yc)f_t(x_{\mp},y_{\mp})\Delta t+(yt'-yc')f'_t(x_{\mp},y_{\mp}')\Delta t\right]dy_{\mp}\\
       &=\left.\int_{x_{\mp}}^{\min(x_{\mp}+\Delta x,b)} [z(t)-(zc+tc)/(yt-yc)-tc]dt\right|_{y_{\mp}}^{\min(y_{\mp}+\Delta y,d)}\cdot\int_{Y_{\pm}[c,c+\Delta y]}dy_{\mp}+\left.\int_{x_{\mp}}^{\min(x_{\mp}+\Delta x,b)} [z(t)-(zc'+tc')/(yt'-yc')-tc']dt\right|_{y_{\mp'}}^{\min(y_{\mp}'+\Delta y',d)}\cdot\int_{Y_{\mp'}[c',c'+\Delta y']}dy_{\mp'}, \quad X_{\mp}<x_{\mp}', Y_{\mp}\cap Y_{\mp'}=0
   \end{align*}
   $$

   根据曲面积分的基本性质，第一项第一部分和第二部分对称，第一项第二部分对 $t$ 求导，可消除 $t$ 。

   所以，曲面积分为 $\int_{R} f(x) dx=\int_{I_a b}(y_0-y)(\partial/\partial x)f(x)+(x_0-x)[\partial/\partial y]f(x)$ ，其中 $I_a b$ 是曲面 $Z=z(x,y)$ 在 $a,b$ 轴上被截出的曲线，$x_0$,$y_0$ 是 $a$ 轴和 $b$ 轴上的截断位置。

   当 $f(x)$ 是关于 $y$ 的连续函数时，曲面积分可以直接积分出结果，不需要求解曲率场。

### 3.1.2 曲面弧度积分

曲面弧度积分是指在曲面 $Z=z(x,y)$ 中一条曲线 $y=f(x)$ 上弦长 $s$ （弧长可由半径 $r=\frac{\text {arccos } \left[ z_{o} \tan \theta \right]}{\sin \theta}$ 及角度 $\theta$ 确定）上的曲面积分，即计算 $\int_{\rho}(r^2ds+\frac{dz}{dr})$ 。

设曲面 $Z=z(x,y)$ 在 $p=(a,b)$ 处的切平面为 $Z_{\ell}(t)$ ，切线方向为 $(m,n)$ ， $\rho$ 是曲面弦的半径。则曲面弦为 $\mathscr{C}_{p}(r)$ ，其截距为 $z_p$ 。

对于曲面 $Z$ ，根据微分几何的知识可知，曲面弦积分等价于曲面积分 $|\frac{\mathrm d}{\mathrm dr}|Z_{\ell}(t) m n \cdot r^2\sigma_p(t)$ ，其中 $\sigma_p(t)=\lim_{\epsilon\to 0}|\cos \left(\theta-\epsilon\right)|=\frac{1}{\sqrt{1+\cos^2\theta}}$ 是弦的径向弯曲度，且满足 $\sigma_p'(t)>0$ 。

特别地，设 $\rho=r=\frac{\text {arccos } \left[ z_{o} \tan \theta \right]}{\sin \theta}$ 为曲面弦的半径，令 $s$ 为弦长，那么上述曲面积分可以重写为 $\int_{\rho}(r^2ds+\frac{dz}{dr})$ ，即在曲线 $y=f(x)$ 上弦 $s$ 处的曲面积分。

## 3.2 解析曲面积分

对于仅含有连续函数的曲面，可以使用解析表达式来求解曲面积分。具体步骤如下：

1. 提取参数方程

   $$
   \begin{equation*}
       z=\varphi(x,y), x\in [a,b], y\in [c,d].
   \end{equation*}
   $$

   例如，若曲面 $z=\varphi(x,y)$ 符合正交条件，则可用拉普拉斯算子 $\Delta=\nabla\cdot\nabla+\nabla\cdot\nabla^{-1}$ 求得参数方程 $\varphi(x,y)=z$ 。

2. 构造等价椭圆

   记椭圆的参数方程为 $E:\left\{x\in\mathbb{R}: E(t)=\frac{zt}{r}\right\}\times\left\{y\in\mathbb{R}: E(t)=\frac{-xt}{r}\right\}$ ，其中 $t$ 是椭圆参数，$z$ 是椭圆圆心的纵坐标，$r$ 是椭圆半径。则椭圆与曲面相交于点 $\bar{p}=(x_0,y_0)$ ，对应的椭圆曲线为 $\Gamma$ 。

   椭圆方程为 $E:\left\{t\in\mathbb{R}: \frac{zt}{r}-y_0-\frac{xt}{r}\right\}=0$ 。

3. 积分 $\varphi$

   在点 $\bar{p}$ 处的切平面上积分

   $$
   \begin{equation*}
       \int_{\Gamma}(tz+tx)dt=\frac{2}{r}\int_{-\pi}^{\pi}\frac{\sqrt{zt^2+rx^2}}{rx}\left(\tan\left(\frac{z}{\sqrt{z^2+r^2}}\right)-\tan\left(\frac{-z}{\sqrt{z^2+r^2}}\right)\right)r^2\sin\theta\cos\theta\epsilon^2d\theta
   \end{equation*}
   $$

   因为椭圆边界上取点的数量为 $N=4\pi r^2$ ，故可对每个 $x$ 值积一次，最后再乘上 $\Delta y$ 。

4. 特殊情况

   * 球面

      对于球面，在 $(x,y,z)$ 坐标系中积分可以化为在以 $z_0$ 点为圆心、$r$ 为半径的球体上积分。

   * 正六面体

      对于正六面体，在 $(x,y,z)$ 坐标系中积分可以化为在以 $z_0$ 点为圆心、$r$ 为半径的正六面体上积分。

   * 抛物面

      对于抛物面，在 $(x,y,z)$ 坐标系中积分可以化为在抛物面外侧积分。