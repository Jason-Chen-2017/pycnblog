
作者：禅与计算机程序设计艺术                    

# 1.简介
  

曲面积分（Surface Integral）是对曲面的一个区域从某一点出发绕过其他曲线到达另一点时，曲线在曲面上的弯曲程度或切线弧长的累计值的测度。它用于求解微观结构中的热传导、声波传播、粘性力学等现象，研究固体、液体、气体等物质在空间分布形式下的物理行为。
基于曲面积分的计算方法共分为几种：

Ⅰ.解析法（Analytical Method）：将曲面积分表示成二重积分；
Ⅱ.欧拉公式（Euler Formula）：应用欧拉方程将曲面积分转换为三维空间的向量积分，计算起来更方便；
Ⅲ.梁朗默法（Lambert W Function）：在法向曲率$K(u,v)$为已知的情况下求曲面积分。
Ⅳ.Gauss–Bonnet formula：借助泰勒展开的方法进行曲面积分。
本文主要阐述第三种曲面积分法——梁朗默法（Lambert W function）。
# 2.基本概念术语说明
## 2.1 概念及符号定义
首先，我们需要理解曲面积分的概念，它可以用来描述曲面上某一点处的曲线在该点处与其他曲线之间的相互作用产生的能量，因此曲面积分的定义如下：

曲面积分是在三维空间中从某一点出发绕过其他曲线，经过某个曲面的过渡形成的曲线段弦长之积的测度，即：

$$\iint_{\Sigma} \sqrt{\left(\frac{\partial x}{\partial u}(s,t) - \frac{\partial y}{\partial v}(s,t)\right)^2 + (\frac{\partial z}{\partial u}(s,t)-\frac{\partial w}{\partial v}(s,t))^2}\mathrm{d}s\mathrm{d}t$$

其中，$\Sigma$ 为所积区域，$x,y,z$为空间坐标轴，$u,v$为参数化曲面坐标系。$\frac{\partial x}{\partial u}$, $\frac{\partial y}{\partial v}$ 和 $\frac{\partial z}{\partial u}-\frac{\partial w}{\partial v}$ 分别代表了 $x,y,z$ 在参数化曲面坐标系下的偏导数。

## 2.2 公式与推论
### 2.2.1 正弦曲面积分
设曲面$Z=f(x,y)$的曲率方程为：

$$R=\frac{\partial^2 Z}{\partial x^2}+\frac{\partial^2 Z}{\partial y^2}$$

则曲面积分公式为：

$$\iint_S f\sqrt{(n_xx'+n_yy')+k^2}=F_1-F_2+\sum_{j=1}^N \int_{I_j} k^2|J'(s)|\mathrm{ds}$$

其中，$k^2=n_xx'+n_yy'$ 是曲率半径，$n_xx'$, $n_yy'$ 分别是单位法向矢量$e_x'$ 和$e_y'$在曲面$Z$的切空间中关于$X$和$Y$坐标的雅可比矩阵的主对角线元素。

在此基础上，可以推广到高维空间的曲面积分问题：

$$\iiint_V f\sqrt{(n_xx'+n_yy'+n_zz'+...)+k^2}=F_1-F_2+\sum_{j=1}^N \int_{I_j} k^2|\vec r'(s)|\mathrm{d}A(s)$$

其中，$f$ 为待积函数，$k^2=(n_xx'+n_yy'+...)$ 是曲率半径。$n_xx', n_yy',...,n_zz'$ 是单位法向矢量$\vec e'_1,\vec e'_2,...$在曲面$Z$的切空间中关于$X_1, X_2,..., X_n$坐标的雅可比矩阵的主对角线元素。$\vec r'(s)$是曲面积分下$f$在曲面$Z$上$P(s)$处的一个切向量，它对应于$\vec e'_1,\vec e'_2,...$在曲面$Z$上$P(s)$处的一组基矢。

### 2.2.2 函数积分
设函数$f:\Omega \rightarrow R$在闭域$D$内可微分，则函数$g(x,y)=\sqrt{\left(\frac{\partial x}{\partial u}-\frac{\partial y}{\partial v}\right)^2+(w(x,y)-z)^2}$称为积分函数，并满足：

$$\forall p \in D: g(p) = \int_{\Gamma(p)} (r_1\cos\theta_1+r_2\cos\theta_2)(u\sin\theta_1+v\sin\theta_2)\mathrm{d}\lambda-\oint_\gamma\sqrt{(u-h_1)^2+(\nu-h_2)^2}\cdot\mathrm{d}s$$

其中，$\Gamma(p)$ 是参数曲线$\gamma$在点$p$处的切线；$(r_1\cos\theta_1+r_2\cos\theta_2)(u\sin\theta_1+v\sin\theta_2)$ 表示曲线$\gamma$在点$p$处的一阶曲率；$\gamma$ 的曲率半径为$k$；$\nu$为曲线$\gamma$上的任一点。

因此，曲面积分可用以下方法求解：

$$\iint_S g\mathrm{d}s=\frac{1}{2}\iiint_V |\vec r'(s)|^2\mathrm{d}V$$

其中，$\vec r'(s)$ 是曲面积分下$f$在曲面$Z$上$P(s)$处的一个切向量，它的长度等于函数$f$的值。

### 2.2.3 Lambert W 函数
Lambert W 函数也被称为拉普拉斯 W 积分。对于任何连续函数$f(x)$，其拉普拉斯 W 积分为：

$$W_f(z)=\int_0^\infty f(t)e^{-zt}\mathrm{d}t$$

Lambert W 函数具有极限：

$$\lim_{z\to\infty}W_f(z)=\log\left[\int_0^\infty f(t)e^{-(z-a)t}\mathrm{d}t\right]$$

## 2.3 离散曲面积分方法
一般来说，曲面积分常用的方法有两种：直接法（Direct Method）和梁氏准则（Legendre Polynomial Approach）。

### 2.3.1 直接法
直接法利用曲线积分的公式，先将曲面$Z=f(x,y)$的平面近似为等价的曲线：

$$Z=f(x,y)\approx \sum_{i=0}^{m-1}\sum_{j=0}^{n-1}c_{ij}M_{ij}(x,y), M_{ij}(\cdot,\cdot): I\times I\mapsto R$$

其中，$m,n$分别为网格的行列数，$c_{ij}$ 是系数，而 $M_{ij}(\cdot,\cdot)$ 是一个二次多项式：

$$M_{ij}(x,y)=\begin{cases}1,& i=j=0\\((2x-1)M_{i-1,j}(x,y)-(2y-1)M_{i-1,j-1}(x,y))/(i(i-1)),&\ i,j>0\\0,& otherwise.\end{cases}$$

这样，曲面积分便可以表示为：

$$\iint_S c_{ij}\sqrt{1+\left(\frac{\partial M_{i+1,j}}{\partial x}-\frac{\partial M_{i,j}}{\partial y}\right)^2+\left(\frac{\partial M_{i,j+1}}{\partial x}-\frac{\partial M_{i,j}}{\partial y}\right)^2}dx dy=\sum_{i=0}^{m-1}\sum_{j=0}^{n-1}c_{ij}\int_{A_i} \left\{C(l)+D(l)+E(l)\right\}dx dldy$$

其中，$A_i$ 是第 $i$ 个单元面积；$C(l)$、$D(l)$ 和 $E(l)$ 分别是对应单元的两个边界的两端向量叉乘积。

### 2.3.2 梁氏准则法
梁氏准则法是指用 Legendre 多项式拟合曲面，然后用拟合出的 Legendre 多项式对原始曲面进行积分。根据 Legendre 多项式，原曲面上的一点 $P$ 的坐标 $(u,v)$ 可由以下方式求得：

$$\begin{bmatrix}1&u&u^2/2\\\vdots&\ddots&\ddots\\\vdots&\ddots&\ddots\\1&v&v^2/2\end{bmatrix}\begin{bmatrix}C_{u}\\C_{v}\\C_{uv}/2\end{bmatrix}=1$$

因此，原始曲面积分公式可转化为：

$$\iint_S \sqrt{1+\left(\frac{\partial C_{u}}{\partial x}-\frac{\partial C_{v}}{\partial y}\right)^2+\left(\frac{\partial C_{uv}}{\partial x}-\frac{\partial C_{vu}}{\partial y}\right)^2}dx dy$$

## 3. 求解示例
为了直观地感受曲面积分的魅力，我们来看一个实际例子。假设有一个圆环$Z(x,y)=R(1-x^2-y^2)$，其中$R$为任意实数，下面证明这个曲面积分为$-1/2\pi R^2$。

首先，由于$Z$是抛物线型的，故存在一切曲线$C$满足：

$$Z-f(x,y)=0$$

这里的$f(x,y)$就是圆环：

$$f(x,y)=R(1-x^2-y^2)=-R(1+2x+2xy+2yx+2y^2)\\=-R\left[1-x^2-2xy-2yx+y^2\right]\\=-Rx\left[(1-y)^2-x^2\right]-Ry\left[(1-x)^2-y^2\right]$$

则：

$$\begin{bmatrix}x^2-y^2&-2xy&-2yx\\-2xy&x^2-y^2&-2yy\\-2yx&-2yy&y^2-x^2\end{bmatrix}\begin{bmatrix}C_{x}\\C_{y}\\C_{xy}\end{bmatrix}=-Rx\begin{bmatrix}(1-y)^2-x^2\\0\\(-2x(1-y))+x^2\end{bmatrix}-Ry\begin{bmatrix}(1-x)^2-y^2\\(-2y(1-x))+y^2\\0\end{bmatrix}$$

因为 $R$ 为任意实数，故 $\det A=0$，因此无解。所以，曲面积分不能直接解出。

但是，我们可以使用梁氏准则法或者 Gauss-Bonnet 方法求解这个曲面积分。

### 3.1 梁氏准则法
设圆环的半径为$R$，那么，其参数方程为：

$$Z=R(1-x^2-y^2)$$

令：

$$\varphi(s)=\begin{cases}x+\sqrt{R^2-y^2},& s\geqslant 0\\y-\sqrt{R^2-x^2},& s<0\end{cases},~~ t=R\tan s$$

则 $Z(u,v)$ 可以通过以下逆变换得到：

$$Z(u,v)=R(1-u^2-v^2)$$

再对二元变量$(u,v)$进行积分：

$$\begin{pmatrix}u^2+v^2 & -(u^2+v^2) \\ -(u^2+v^2) & u^2+v^2\end{pmatrix}\begin{pmatrix}C_{uu}&C_{uv}\\C_{vu}&C_{vv}\end{pmatrix}=\begin{pmatrix}1&0\\0&1\end{pmatrix}$$

再代入$C_{uu}=-R\cot(\arcsin\frac{v}{R}),~C_{uv}=R\frac{u}{R},~C_{vv}=-R\cot(\arcsin\frac{-u}{R})$得到：

$$\begin{pmatrix}u^2+v^2 & R\frac{u}{R} \\ R\frac{u}{R} & u^2+v^2\end{pmatrix}\begin{pmatrix}u^2+v^2-R\cot(\arcsin\frac{v}{R}) \\ R\frac{u}{R} & u^2+v^2\end{pmatrix}=\begin{pmatrix}u^2+v^2&R\frac{u}{R}\\R\frac{u}{R}&u^2+v^2\end{pmatrix}$$

其特征值为：

$$\lambda_1=\frac{1}{\sqrt{R^2+1}},\quad \lambda_2=-\frac{1}{\sqrt{R^2+1}}$$

前者对应的特征向量为：

$$\begin{pmatrix}\frac{1}{\sqrt{R^2+1}} \\ \frac{u}{\sqrt{R^2+1}}\end{pmatrix}$$

后者对应的特征向量为：

$$\begin{pmatrix}\frac{-1}{\sqrt{R^2+1}} \\ \frac{-v}{\sqrt{R^2+1}}\end{pmatrix}$$

所以，曲面积分的形式为：

$$\iint_S \sqrt{1+\left(\frac{\partial C_{u}}{\partial x}-\frac{\partial C_{v}}{\partial y}\right)^2+\left(\frac{\partial C_{uv}}{\partial x}-\frac{\partial C_{vu}}{\partial y}\right)^2}dx dy=\frac{1}{2}\int_{\lambda_1}^{\lambda_2}\left(|\begin{pmatrix}\frac{1}{\sqrt{R^2+1}} \\ \frac{u}{\sqrt{R^2+1}}\end{pmatrix}|^2+|\begin{pmatrix}\frac{-1}{\sqrt{R^2+1}} \\ \frac{-v}{\sqrt{R^2+1}}\end{pmatrix}|^2\right)\lambda^{-1}_1\lambda^{-1}_2dx=\frac{1}{2}\frac{\sqrt{R^2+1}}{\sqrt{R^2+1}}+\frac{u}{\sqrt{R^2+1}}\frac{-u}{\sqrt{R^2+1}}$$

由于对称性，此积分不再计算，只需考虑上下两个特征值即可。我们取：

$$\int_{\lambda_1}^{\lambda_2}\left(|\begin{pmatrix}\frac{1}{\sqrt{R^2+1}} \\ \frac{u}{\sqrt{R^2+1}}\end{pmatrix}|^2+|\begin{pmatrix}\frac{-1}{\sqrt{R^2+1}} \\ \frac{-v}{\sqrt{R^2+1}}\end{pmatrix}|^2\right)\lambda^{-1}_1\lambda^{-1}_2dx=\frac{1}{2}\frac{R^2+1}{R^2+1}=\frac{1}{2}=\iint_S \sqrt{1+\left(\frac{\partial C_{u}}{\partial x}-\frac{\partial C_{v}}{\partial y}\right)^2+\left(\frac{\partial C_{uv}}{\partial x}-\frac{\partial C_{vu}}{\partial y}\right)^2}dx dy$$