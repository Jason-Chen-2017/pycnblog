
作者：禅与计算机程序设计艺术                    

# 1.简介
  

Decentralized Finance (DeFi)，中文译作分散化金融，是一种去中心化的数字货币和加密货币钱包应用平台。其目标是在没有中央银行的情况下，让用户能够在任意时间点通过互联网进行个人投资。目前市面上有多种典型的DeFi项目，如MakerDAO、Compound、Aave等。本文将以MakerDAO为代表，对DeFi及其底层技术进行深入浅出地探讨。

2021年7月1日，美国证券交易委员会(SEC)宣布，英伟达公司（NVIDIA）、亚马逊网络服务（AWS）、微软（Microsoft）、谷歌（Google）、Facebook、Coinbase等公司已经或即将推出相关产品。据报道，这5家公司将推出基于区块链技术的去中心化金融平台，包括Balancer、Synthetix、Sushiswap、UMA、Convex等，均通过联合创始人的控制，将代币化债权投资(CBDC)以及去中心化交易所所需的相关基础设施、工具软件、加密货币池等打造成统一的生态系统。这些去中心化金融平台将允许用户利用自己的加密货币进行高级交易，实现对传统金融机构的颠覆性变革。

3.介绍
分散化金融(Decentralized Financial, DeFi)是一种基于区块链技术的去中心化金融服务平台，旨在让用户可以通过无需许可即可进行各种金融活动，并能够自主选择金融工具。DeFi可以在不依赖于任何中间人或中央调度机构的情况下，提供由用户建立的分布式账本进行价值存储、转移和流通。随着越来越多的金融应用被DeFi所取代，它正在重新定义金融世界的格局。比如，之前的去中心化借贷平台需要借款方提交申请才能获得贷款；而在DeFi平台下，用户可以直接在去中心化的环境下进行借贷，并只需要支付相应的费用即可，且不需要征信或者担心隐私泄露。另一个例子是支付宝，近几年来一直受到美元短缺影响，为了解决这一问题，支付宝启动了数字货币支付功能，但由于中央银行的限制，无法普及应用。DeFi的出现正好填补了这一空白。DeFi的底层技术本质上是基于区块链的分布式账本，通过构建不同角色的节点，将各个参与者的身份分离开来。分布式账本本身就具有去中心化的特点，所以节点之间的交流需要通过加密协议完成，节点之间的数据安全也要得到保证。同时，DeFi还通过去中心化的治理机制来确保平台长期稳定运行。

4.DeFi应用场景
DeFi的主要应用场景可以归纳为以下五类：
- Lending：借贷平台。DeFi的Lending产品，使得用户可以将其加密货币用于抵押贷款，而不是支付利息。此外，用户也可以赎回加密货币，转换为法币。Lending已经成为DeFi社区中的热门话题。虽然借贷平台一直存在着严重的利率问题，但如果能从另一个角度看待DeFi的Lending服务，那将是一个全新的视角。
- Yield Farming：借贷期货。借助DeFi的Yield Farming产品，用户可以从平台获得去中心化的期货资产。然后，用户可以将这些资产作为抵押物，放入借贷平台借贷。这种模式类似于传统的黄金合约，但更加灵活。DeFi Yield Farming也同样引起了社区的广泛关注。
- Staking：去中心化治理。DeFi的Staking功能，可以让用户按照一定规则质押自己持有的加密货币，从而参与到去中心化的治理进程当中。例如，用户可以使用这些加密货币来参与区块生产，获得网络上的奖励，也可通过质押获得分红。Staking也帮助用户能够更有效地管理他们的加密资产。
- Token Pools：代币交易池。DeFi的Token Pools产品，为用户提供了一种简单的交易工具。用户可以自由组合多个代币，并将它们放在平台上进行兑换，也可以通过其他用户的交易成果获利。Token Pools的特性让它在众多DeFi平台中处于领先地位。
- Governance：去中心化自治组织。DeFi的Governance机制，使得用户可以以民主的方式对平台进行治理。用户可以通过投票决定平台的发展方向、管理制度和激励措施。每个用户都可以根据自己的需求进行设置，因此DeFi的Governance机制可以给予每个用户更多的权力和自主权。

5.DeFi架构
DeFi平台通常由四个部分组成：前端界面、智能合约、运行时环境和数据存储。前端界面负责呈现给用户的交互页面，包括信息的展示、交易操作的实施。智能合约是DeFi平台的核心模块，它定义了各种合约模板，包括协议的执行逻辑、储存数据的格式、接口规范等。运行时环境则是整个平台的运行容器，负责管理各种底层组件的工作流程。数据存储则负责维护平台所需的数据，例如用户的账户信息、交易记录、财务信息等。DeFi的架构设计需要考虑很多因素，包括如何方便用户进行资产的托管、交易的效率、数据存储的安全性等。


图1  DeFi架构示意图

DeFi架构总体由三层结构组成，包括底层的智能合约、上层的前端界面和运行时环境。智能合约位于最底层，运行时环境和数据存储则位于两端，中间由一个或多个中介机构进行协调。在这里，我们着重介绍一下运行时环境和智能合约。

## 智能合约

智能合约是DeFi平台的核心模块，它定义了各种合约模板，包括协议的执行逻辑、储存数据的格式、接口规范等。智能合约实际上就是去中心化应用程序的编程代码，它由一系列的计算机指令组成。它能实现自动化的商业决策过程，并能够处理复杂的业务逻辑。DeFi的智能合约由多种类型组成，包括代币交换、借贷系统、期权交易、流动性挖矿等。

### DEX

DeFi的DEX，也就是去中心化交易所，是用户进行交易的主要途径之一。DEX通过去中心化的规则来执行交易，不受任何第三方的干涉。用户可以使用平台内置的交易算法来执行交易，并无需担心各种费用和手续费的缴纳。同时，DEX还可以防止交易的操纵，因为它具备良好的风控系统。DEX的流动性来源主要包括两个方面，即交易对的资金量以及用户的持仓量。

### 杠杆交易

杠杆交易是DeFi的一种应用方式。它可以让用户在平台间无缝切换，并获益于平台的资金成本优势。用户可以在不同的平台之间做空或者做多，并按照自己的喜好投资。杠杆交易的价值在于它能最大限度地降低交易所的交易成本，并且提供超额收益。

### 流动性挖矿

流动性挖矿是DeFi平台的一个重要特点。它为用户提供了一个全新的支付方式，即用户可以向智能合约发送加密货币，并按合约的规则来获取对应的奖励。流动性挖矿的关键在于其价值增加的效应。例如，用户可以用获得的奖励购买其它加密资产，也可以通过向平台提交质押请求来获取奖励。

### 激励

激励是DeFi平台的一个重要机制。它通过吸引用户参与平台的各种活动，促进用户产生经济激励的效应。激励机制既包括平台的奖励机制，也包括项目方的获利激励。例如，项目方可以获得平台的收益，也有可能为平台的推广和运营提供资源支持。

## 运行时环境

运行时环境是DeFi平台的另一重要组成部分，它负责管理整个平台的底层组件的工作流程。它包括各种节点、存储、计算、网络等模块，其中数据存储模块属于核心组成部分。运行时环境的作用包括数据存储、节点管理、计算能力、网络通信等。

### 数据存储

数据存储是DeFi平台的核心组成部分。它用来保存所有平台用户的账户信息、交易记录、财务信息、社交关系等。数据存储的另一个重要功能是为用户提供访问自身账户信息的便利。通过平台的账户信息，用户可以查看自己的交易历史、余额、邀请好友记录、质押信息等。数据存储的安全性非常重要，平台需要提供多种安全措施来保障用户的账户信息的安全。

### 节点管理

节点管理是DeFi平台的一个重要功能。它负责维护整个平台的网络拓扑结构和网络容量。节点管理的任务包括识别和跟踪节点故障、发现新节点、更新路由表、分配任务等。节点管理的目标是确保平台的网络保持正常运行，避免服务中断。

### 计算能力

计算能力是DeFi平台的一项重要特征。它可以让用户获得高效的交易体验。用户可以像在现有支付平台一样，通过智能合约来进行交易。计算能力的另一个作用是进行高速的密钥生成、签名运算、加密解密等运算，从而减少平台的响应延迟。

### 网络通信

网络通信是DeFi平台的另一个重要组成部分。它通过连接网络节点来传输数据。网络通信的作用包括传输交易信息、存储数据、验证数据、通知节点状态变化等。网络通信的重要性体现在平台的可靠性、快速响应速度和交易数据可追溯性等方面。

# 2.基本概念术语说明

## 区块链

区块链，又称分布式数据库，是一种将交易数据记录在共享账簿上的链状数据库系统。它的特点是由一群节点组成，每个节点都存储了一份完整的链条，并且共同维持了账簿的真实性。区块链中的每笔交易都是公开透明的，任何人都可以检查和认证。区块链技术可以有效地防止欺诈、抢注、骗局等一系列风险。


## 以太坊

以太坊，是一套开源的智能合约编程语言，基于区块链技术。它提供了一个去中心化的区块链环境，让开发者能够在该平台上进行智能合约的开发、部署、调用。以太坊的主要特点是能够实现自动化的商业决策过程，并能够处理复杂的业务逻辑。


## dapp

dapp，即分布式应用程序，是指基于以太坊区块链技术的应用，其主要特点是去中心化、自动化，安全可靠。用户无需下载安装，浏览器即可访问。dapp的用户体验十分流畅，可以提供丰富的应用功能，提升用户的接受度和使用频率。


## ITO

ITO，即 Initial Token Offering ，即首次代币发行，是由平台向用户提供代币的一种方式。一般情况下，平台都会向用户提供一定的代币数量，然后用户就可以根据平台的价格来购买这些代币。然而，首次代币发行往往会带来新的盈利模式，例如，平台可以向用户提供一定的折扣，或者用户可以直接参与到平台的运营中。


## AMM

AMM，即 Automated Market Maker，即自动化做市商，是指平台能够根据用户的交易行为，自动生成交易买卖订单。AMM的主要目的是实现市场需求与供应之间的平衡，提高用户的收益。目前，流动性挖矿、AMM、Lending与Borrowing等DeFi应用正在蓬勃发展。


## DAO

DAO，即去中心化自治组织，是指由一群志同道合的普通用户组成的自治组织。该组织由智能合约来管理，可以做出决策并产生可公开验证的结果。DAO的特点是去中心化、民主化，由智能合约来驱动，也需要加密货币作为激励。DAO的典型案例包括MakerDao、Uniswap等。