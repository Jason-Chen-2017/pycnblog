
作者：禅与计算机程序设计艺术                    

# 1.简介
  
  
　　随着互联网的发展，路由器数量越来越多，路由表也日渐庞大，而网络的边缘路由器（border router）又处于物理上最靠近核心交换机的位置，承担着复杂的网络流量处理任务，因此边界路由就成了网络路由控制中重要的一环。

　　2017年9月，RFC 8277(dynamic BGP)正式发布，这一文档主要定义了一种新型动态BGP路径选择协议，通过对边界路由路径选择进行有效性验证，并将其带来的改进设计给出了一些建议。本文将会通过对此协议的介绍、相关背景知识的阐述以及基于该协议的边界路由优化方法的设计实践，详细分析该协议对边界路由的影响及其优化策略。
## 2.相关背景知识  
### BGP概述  
　　BGP (Border Gateway Protocol) 是由Internet Engineering Task Force (IETF)提出的一种路由选择协议，用于在Internet上可靠地传播到达路由器的数据包。在BGP系统中，每个自治域（AS）都有一个或者多个路由器，并且每个路由器都和其他的路由器建立连接，相互交换信息。BGP基于距离向量算法，根据路由记录的权值，计算到不同目的网络的“距离”，选取到达最短距离的路由。因此，BGP可以有效地避免路由环路，并避免路由不充分利用网络资源的问题。

　　目前BGP共有两种工作模式，分别为：

　　1.主动模式：当某个BGP路由器收到了一条目的地址为自身的路由信息时，它会向其它BGP路由器发送一条新的路由更新消息，向这些路由器宣告自己可达该目的地址；

　　2.被动模式：当某个BGP路由器接收到一个从某条路由记录到达的一个外部网络的数据包时，它会生成一个路由通知消息，把这个数据包传送给其它BGP路由器，让它们知道有一条到达它的路由记录。

　　虽然BGP已经很久没有过时，但由于其简单易用、易理解、容易实现、功能强大等优点，仍然有很多研究者认为它在Internet上扮演着至关重要的角色。例如，在世界各地，许多组织和公司为了更好地控制和优化Internet路由，就使用了BGP作为其核心服务。另外，一些政府部门也借助BGP来进行网络间通信和监控，比如国家安全局就是借助BGP实施全球网络犯罪追踪。  
  
  
### RIB（Routing Information Base）  
RIB (Routing Information Base) 是BGP中的重要数据结构之一，存储了BGP路由器收到的所有路由信息。RIB中的每一条路由记录都包括了路由目的网络，下一跳路由器IP地址、下一跳接口、路由权重等属性。

每一条路由记录都按照以下规则在RIB中排队：

1.路由源：每个路由记录都会显示出它所从哪个路由器收到的，这样就可以知道这个记录是否真的是它自己的。

2.路由掩码：如果两个路由目的网络拥有相同的前缀，那么掩码小的路由记录优先级高。也就是说，掩码越长的路由记录，它可以覆盖的范围就越大。

3.路由生命周期：当一条路由记录的到期时间到了，它就会被丢弃。这是为了避免出现路由记录的陈旧、循环路由或无效路由等问题。

4.路由方向：当一条路由记录的next hop指向自己的地址时，它被称为内部路由记录，否则则被称为外部路由记录。

BGP通过这种方式维护RIB，使得路由器能够快速准确地找到一条最佳路由路径。

### Dijkstra算法  
　　Dijkstra算法（英语：Dutch National Flag Algorithm，中文：狄克斯特拉算法）是一个用于计算图中最小权值的单源最短路径算法。它由Edsger Dijkstra在1959年提出，是解决单源最短路径问题的经典算法之一。

Dijkstra算法依赖于贪心策略。它首先确定起始顶点到其余各顶点之间的最短路径。然后，它按照贪心策略在剩下的顶点之间进行松弛。具体来说，它每次确定当前到达其余顶点最短的路径，并更新到达这些顶点的路径。直到所有的顶点都被访问完毕。Dijkstra算法适合计算有向图中顶点的最短路径。

由于Dijkstra算法是贪心算法，所以可能存在以下问题：
- 在有负权值的图中，算法可能会陷入回路，导致无法求解。
- 如果输入图中含有负权回路，则算法也不能正常运行。