
作者：禅与计算机程序设计艺术                    

# 1.简介
  

携程电子商务前端系统分为PC端、移动端两大平台，分别独立运营维护；同时搭载全新的前端框架“飞猪”作为基建支撑。
根据携程在2020年Q2发布的研究报告显示，在线支付金额占总交易金额的比例从2019年第四季度的71%提升至2020年第一季度的88%，为移动支付市场提供了巨大的增长空间。因此，我们要立足于这一数据，通过携程自主研发的智慧支付系统，为用户提供安全可靠的购物体验，形成高品质的服务体验。
该系统的主要功能包括：
- 用户中心：实现登录注册、个人信息管理等模块；
- 在线支付：提供多种支付方式（微信支付、支付宝支付）；
- 积分商城：支持兑换奖励商品或抵扣现金；
- 会员权益：提供会员权益和促销活动功能；
- 团购秒杀：满足用户购买或消费需求；
- 物流配送：支持用户查询订单状态和实时跟踪物流情况；
- 店铺推荐：提供精准的店铺推荐功能；
- 服务监控：实时统计各项业务指标，帮助企业进行管理和决策。
# 2.基本概念术语说明
## 2.1 概念术语

### 2.1.1 Cookie与Session
Cookie（Cookies）和 Session 的作用都是用来实现 Web 站点中用户状态信息的跟踪。但两者之间也存在着一些区别：

1. 生命周期不同:
- Cookie 在浏览器关闭后自动失效。
- Session 可设置超时时间，如设置为半小时则视为会话结束，需要重新登录。

2. 存储位置不同:
- Cookie 默认保存在客户端上，容易被偷窥或篡改。
- Session 默认保存在服务器上，不容易被攻击。

3. 使用场景不同:
- Cookie 适合保存动态页面参数，比如用户名、密码等。
- Session 适合保存非敏感信息，比如购物车中的商品ID和数量等。

4. 加密机制不同:
- Cookie 可以被加密，使得 cookie 中的内容无法被轻易读取。
- Session 不加密，可被反推或窜改。

所以，一般情况下，我们应该尽量避免将机密信息存放到 Cookie 中，而只把非敏感信息保存到 Session 中。

### 2.1.2 JWT（JSON Web Tokens）
JWT 是一种基于 JSON 并且使用了签名加密的方式用于认证、鉴权的一类令牌。它可以在不同应用间传递信息，且信息能够被加密，防止数据泄露。

例如，在电子商务网站登陆后生成的 JWT 包含了用户的身份信息，可以保存在浏览器的 localStorage 或 sessionStorage 中，供下次访问时验证使用。

其特点有：
- 无状态，可跨域使用
- 支持多种语言的库可用
- 自包含，即 JWT 里面已经包含了用户的所有相关信息
- 安全性好，可以通过签名加密算法确保数据完整性
- 时效性短，只适合单次有效，最长有效期是2个小时

### 2.1.3 CSRF(Cross-Site Request Forgery)
CSRF（跨站请求伪造）是一种计算机安全漏洞，指黑客利用用户的登录态发送恶意请求。CSRF attacks occur when a user’s browser sends unauthorized requests to a website, and the website is vulnerable to attack because it trusts that user’s web browser to make valid requests on its behalf. A common scenario is when a user clicks a link or submits a form without being aware of the fact that their current authentication context is being used to execute the request. This means they are trusting third party sites to perform actions on their behalf with the user’s permission. By exploiting this vulnerability, an attacker can carry out fraudulent activities such as transfer funds, change email addresses, and even hijack sessions for other accounts. 

解决 CSRF 的方法有以下几种：
- 验证 HTTP Referer
- 检查 Content-Type 和 X-Requested-With 请求头
- 在请求地址中添加验证码
- 添加自定义请求头 X-XSRF-TOKEN 来发送身份验证信息