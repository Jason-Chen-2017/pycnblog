
作者：禅与计算机程序设计艺术                    

# 1.简介
  

OpenStack项目是一个开源的云计算平台，提供了一系列的服务组件，包括计算、网络、存储等，这些组件可以提供基础的云计算服务功能，并通过组合的方式实现不同的业务场景需求。其中负载均衡器（LB）是构建高可用性云服务的关键组成部分。本文主要介绍OpenStack中的负载均衡器（LB）相关知识，以及它们在OpenStack环境中工作的机制及其作用。
负载均衡器（Load Balancer，简称LB）是用来分担应用流量的一种服务器设备或软件程序。它是用来减少应用服务器的平均负载，提升网站性能，增加可靠性和可用性的一种服务器设备或软件。常用的负载均衡器产品有硬件负载均衡器、软件负载均衡器、云负载均衡器等。本文将主要介绍OpenStack中实现LB的两种方式：第一种是基于物理机或者虚拟机（VM）的负载均衡器，第二种是基于容器的负载均衡器。两种类型的LB的具体功能特性、工作模式、使用限制及适用场景将会进行详细阐述。另外，本文还会介绍OpenStack LB相关组件和配置参数的使用，以及支持的协议、七层负载均衡器和四层负载均arily的区别。

2.概览
OpenStack的负载均衡器由多个服务组件组合而成，包括调度（Scheduling）、认证授权（Authentication and Authorization，简称AA）、消息队列（Messaging Queueing）、数据库（Database）以及其他模块组件等。以下图所示的架构来描述负载均衡器的功能和流程。
图1 Openstack负载均衡器架构

OpenStack的负载均衡器按照功能可以分为两类，一类是基于物理机或者虚拟机的负载均衡器（a.k.a LBaas），另一类则是基于容器的负载均衡器（a.k.a Octavia）。

LbaaS (L-BaaS: Load Balance as a Service)是在OpenStack中实现的一种高级负载均衡解决方案，它支持多种类型的负载均衡，如：公网负载均衡、内网负载均衡、反向代理（Reverse Proxy）负载均衡等。它支持对多租户网络、子网、VPC网络及共享带宽等资源进行管理，并具有弹性伸缩、高可用性和安全防护能力。

Octavia(O-C-T-A-V-I-A:)是OpenStack项目下的一个子项目，专门用于实现基于容器的负载均衡。它是一个纯粹的LBaaS实现，不需要考虑云平台的其它功能，只负责提供负载均衡功能。Octavia利用OpenStack原有的组件如Nova、Neutron、Glance、Keystone、Horizon等，实现了基于容器的负载均衡功能。该项目的目标是通过高度抽象化的API和服务端组件，达到较高的性能和可扩展性。

本文将首先介绍OpenStack LbaaS的整体架构和原理，然后重点阐述LbaaS的功能特性、工作模式、使用限制及适用场景；然后介绍基于容器的Octavia LBaaS的原理、架构、功能特性、工作模式、使用限制及适用场景；最后，结合实际案例，讨论如何选择使用哪种类型的负载均衡器，以及它们之间的比较和优缺点。