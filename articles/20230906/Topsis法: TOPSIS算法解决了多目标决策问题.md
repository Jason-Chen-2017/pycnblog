
作者：禅与计算机程序设计艺术                    

# 1.简介
  

## 概念及其定义
## TOPSIST理论模型
TOPSIS法基于以下假设：
- 每个目标都是相互独立且可加权的。
- 目标函数的期望值与其之间的差距最大化。
- 不存在不平衡现象。
TOPSIS法提供了三种指标计算方式：
1. Euclidean Distance
2. Profitability Index （PI）
3. Purity Measure （PM）
# 2.实验环境
python版本：3.7.9  
库：numpy==1.19.2    scipy==1.5.2   scikit-learn==0.23.2  

# 3.主要概念
## 模型的输入参数
* Criterion Matrix (CM): 评价矩阵，是一个二维矩阵，行表示每个项目或者是个体，列表示每个目标，元素(i,j)表示个体i对于目标j的评价分值。
* Sensitivity Attribute (SA): 表示敏感属性，也被称为优化属性，是一个列表，列表中每一个元素代表着衡量每个个体重要性的属性或特征。
* Impact Criteria (IC): 表示效用函数，也被称为目标权重，是一个列表，列表中的每一个元素对应着每个目标的影响大小。
## 输出结果
* Performance Score (PS): PS是一个列表，其中每一个元素对应着每一个个体的得分，得分的计算可以根据不同的评估指标进行调整。
## 性能评估指标
### 相似性指标
1. 绝对差值距离： $d_{ij} = |a_{ij} - b_{ij}|$ 
2. 曼哈顿距离：$d_{ij}=\sum_{k=1}^n|a_{ik}-b_{jk}|$ 
3. 欧氏距离：$d_{ij}= \sqrt{\sum_{k=1}^{n}(a_{ik}-b_{jk})^2}$ 
4. 切比雪夫距离：$d_{ij}=max(|a_{ij}-b_{ij}|,\frac{a_{ij}}{b_{ij}})$ 
5. 马氏距离：$d_{ij}=|\log(\frac{a_{ij}}{b_{ij}})|$ 
### 综合评估指标
#### TOPSIS
1. Vice Versa Distance (VBD): $VBD=\frac{(w_1d_{ij}_1+w_2d_{ij}_2+\cdots+w_id_{ij}_i)^2}{\sum_{k=1}^nw_kd_{ij}_k^2}$  
2. Inverse of Distance (ID): $ID=(\frac{1}{d_{ij}})^\beta$ 
3. Tournament Weighted Sum (TWSS): $\overline{X}_i=\frac{\sum_{j=1}^M (f_{ij}-c_{ij})}{\sum_{j=1}^N w_{ij}}$ where $f_{ij}$ is the f-score and $c_{ij}$ is the c-score.  
4. Ranking Accuracy (RA): $\text{RA}=1-\frac{\sum_{i=1}^{N}\left|\sigma_i-\bar{\sigma}_{TOPSIS}\right|}{\sum_{i=1}^{N}\sigma_i}$ where $\sigma_i$ represents the difference between actual score and ideal best score and $\bar{\sigma}_{TOPSIS}$ represents the average difference between all pairs of scores in the rankings generated by using the selected method.
#### WASPAS
1. Winning Attention Score (WAS): $WAS=\frac{w_{best}}{\sum_{k=1}^M w_{ik}}$ 
2. Average Product Score (APS): APS表示的是每个对象(个体)对所有目标的评分，按照各个目标对对象的影响大小加权平均后得到的最终得分。APS的计算公式为：$\begin{align*} APS &=\frac{||C_p^{-1}x_p||_F}{||x_p||_F}\\ &=\frac{||C_px_p||_2}{||x_p||_2}, \quad x_p=[x_{best};x_{rest}]\\ C_p^{-1}=[\frac{s_1}{\sum_{m=1}^K s_m},\frac{s_2}{\sum_{m=1}^K s_m},\ldots,\frac{s_K}{\sum_{m=1}^K s_m}],\quad s_k=\sum_{l=1}^L x_{kl}, L=I+R-1 \\ ||A||_F=\sqrt{\sum_{i=1}^m |a_{i}|^2}. \end{align*}$