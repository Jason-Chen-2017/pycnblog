
作者：禅与计算机程序设计艺术                    

# 1.背景介绍


## 概述
最大流问题（maximum flow problem）是运筹学、控制论、计算复杂性等领域里的一个经典问题。它给定一个有向图G=(V,E)和两个顶点s和t，其中每条边(u,v)∈E都有一个容量c(u,v)。最大流问题就是在这样的一个网络中，找出一条从源点s到汇点t的路径，使得路径上所有的流量不超过它的容量。流网络中的每条边可以充分传输其容量值，即c(u,v)，但不能超出容量值。通过求解最大流问题，可以对网络流量进行建模、分析和优化，取得网络的最佳性能。
## 最大流算法
最大流问题通常可以分成两个阶段：预流和推流阶段。在预流阶段，算法找到一条从源点s到汇点t的残余网络（residual network）。残余网络由两部分组成：残余容量（residual capacity）与边权重（flow on edge）。对于任意一条边e=(u,v),如果存在一个流f(u,v)>0，则称其是一个有效流。由于容量限制，可能存在有效流比残余容量更小。而有效流越多，残余容量也就越小。预流结束后，网络中所有流均已达最大流。接下来的推流阶段，算法利用残余网络来确定网络中的每条边的流量。推流阶段最大化流的值，从而使得网络流的值最大。
### Ford-Fulkerson方法
Ford-Fulkerson方法是最常用的最大流算法，它的运行时间复杂度为$O(\delta(G)^2)$,其中$\delta(G)$表示网络的最大割。Ford-Fulkerson方法解决了多项图的最大流问题，并且具有高效率。它的基本思路是，以增广路径的形式寻找最大流。增广路径指的是连接源点s和汇点t的路径，且路径上的每个边都没有被用满。算法的每次迭代要么找到一条增广路径，要么结束。具体地说，首先从源点s出发，寻找一条可行的增广路径。如果找到了这样的路径，则计算这一路径上所有边的最小残余容量。然后将这些边的最小残余容量添加到原网络中，直至没有更多的可行的增广路径为止。
### Edmond-Karp算法
Edmond-Karp算法是Ford-Fulkardo算法的扩展。它可以在$O(VE^2\log n)$的时间内解决最大流问题。Edmond-Karp算法的基本思想是在Ford-Fulkerson算法的基础上，加上启发式的方法来更快地找到可行路径。它维护一个二维表格F[i][j]，其中i表示源点s能达到的最远距离，j表示汇点t能达到的最远距离。F[i][j]表示从源点到汇点的一条路径上最多能传输多少的流量。初始时令F[i][i]=0,i=1,...,n。然后对每一对值i,j=1,...,n，从源点s到汇点t的最大流就是F[i][j]的值。具体地说，Edmond-Karp算法的每次迭代如下：
1. 初始化图G和参数n。
2. 对每一对值i,j=1,...,n，初始化F[i][j]=0。
3. 如果流量网络中的任何一条边(u,v)的容量为0，或者该边已经分配了一个流，则跳过此次迭代。
4. 对每一对值k=i,i+1,...,min(n,j)执行以下步骤：
   a. 对每一对值x=i,i+1,...,min(n,j)执行以下步骤：
      i. 如果F[x][y]+c(x,y)-F[k][y]>0,并且第k条边到第y条边的残余容量>0,则更新F[x][j]的值：
         F[x][j]=max(F[x][j],F[x][y]+c(x,y)-F[k][y])
   b. 更新F[i][j]的值：
      F[i][j]-=d(i,j)*F[i][j]
      F[j][i]+=d(i,j)*F[i][j]
   c. 对每个有效流f(u,v)=F[u][v]-F[v][u]中的每条边e=(u,v)：
      如果流值f(u,v)>0，则认为该边是一个有效流，并将其标记为已经分配。否则，取消该边的标记。
   d. 检查是否存在未分配的有效流。如果存在，返回到第3步继续迭代。否则，停止迭代。
5. 返回F[i][j]作为最大流。
### Dinic算法
Dinic算法是Edmond-Karp算法的一种改进版本。它与Edmond-Karp算法的主要区别是，Dinic算法不会产生所有可行路径，而只是生成残留网络的一部分。这样做可以减少生成可行路径的开销，因此可以获得更快的收敛速度。它的运行时间复杂度是$O(EV^2)$。
# 2.核心概念与联系
## 最大流网络
### 有向图G=(V,E)
- 每个顶点对应于网络中的一处点。
- 每条边对应于网络中的一条线段，其带有非负的容量。
- 容量为零的边则对应于网络中不存在的路段。
### 源点S和汇点T
- 源点S代表着网络的输入。
- 汇点T代表着网络的输出。
- 从源点S到汇点T的流网络称为一个最大流网络。
### 流
- 流是单位元，表示能够从源点S向汇点T传输的“能量”。
- 在一条有向边e=(u,v)上，若有一非负实数f，则称f为e的流。当且仅当f≤c(u,v)，才称e是一个有效流。
- 在最大流网络中，一条边只有当有流存在时，才可进入。
### 最小割
- 最小割(minimum cut)是指把网络划分成两部分，其中一部分边的容量之和是另一部分边的容量之和的极大值。最小割是流问题的关键。
- 最大流问题是在网络上找一条从源点s到汇点t的路径，使得路径上的所有流量不超过它的容量。
- 一般来说，最大流等于最小割中的割的容量。最大流等于最小割中的割的容量。
- 在最大流问题中，我们需要找出一条从源点s到汇点t的路径，该路径上的每条边都有足够大的容量，而且在路径上的每条边都是有效流。
## 费用流网络
- 费用流网络是最大流网络的变体，它引入了“费用”的概念。
- “费用”是单位流量传输的代价。
- 当单位流量超过某条边的容量时，边就发生阻塞，无法实现平衡，也就无法完成该条流。
- 为防止阻塞，单位流量的传输需要付出一定代价。这个代价就是费用。
- 对于费用流网络，我们希望通过最小割的方式找出一条从源点s到汇点t的路径，其中每条边都有足够大的容量，并且在路径上的每条边都是有效流，同时满足代价限制。
## 割
- 一条割是网络中的一个划分，其中每条边恰好属于其一方。
- 将最大流网络中所有边切分成两部分，一部分属于支配集，另一部分属于被支配集，则剩下的那部分属于另一部分。
- 把最大流网络中所有边切分成两部分，一部分属于支配集，另一部分属 of the remaining part belongs to the other set. If we split all edges in the maximum flow network into two parts: one belonging to the dominant set and another belonging to the nondominant set, then the other part is assigned to either set.