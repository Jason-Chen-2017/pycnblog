
作者：禅与计算机程序设计艺术                    

# 1.简介
  

## 概要
随着互联网金融的发展，各类支付方式变得越来越多、功能越来越复杂。其中移动支付应用支付宝、微信支付成为越来越受欢迎的选择。支付宝和微信支付的主要功能是为用户提供方便快捷的在线支付服务。本文将阐述其中的支付流程及相关参数设置，为初次接触支付宝支付或微信支付的开发人员提供参考。
## 介绍
支付宝和微信支付均属于在线支付方式，两者都是属于第三方平台，是指将银行卡号等敏感信息加密上传至第三方，由第三方支付机构处理，并向用户收取费用。相对于传统的银行转账，支付宝和微信支付更加安全可靠，能够保障消费者个人信息的安全。
## 功能概览
### 微信支付
- 提供多种支付场景，包括消费、理财、购物、收款、游戏、公众号等。
- 支持移动端APP支付。
- 可实现企业对个人账户充值、企业转账。
- 支持灵活的代付模式，如分期付款、一次性付款等。
- 可支持商户自助开通银行卡绑定功能。
### 支付宝
- 为个人和企业提供了丰富的交易支付模式，包括扫码支付、条码支付、电话支付、APP支付、网页支付、手机网站支付等。
- 用户无需下载安装即可进行支付，同时可以自定义支付界面。
- 提供多种支付场景，包括支付宝好友间付款、电脑网站支付、APP支付等。
- 支持多种支付方式，包括余额、银行卡、信用卡等。
- 支持国际站和国内站。
- 支持电子合同。
## 支付流程
首先需要登录支付宝或者微信支付官方网站，然后进入到支付宝或者微信支付的页面，选择相应的业务场景，点击相应的支付方式按钮，如图1所示。
图1 微信支付商城首页

若选择了“扫码支付”，则会跳转至扫码页面，扫码后即可进行支付，完成之后即会跳转回商城首页，显示支付成功状态，如图2所示。
图2 微信扫码支付

若选择了“电脑网站支付”，则会跳转至支付宝登录页面，输入账号密码等信息后即可支付，完成之后也会跳转回商城首页，显示支付成功状态，如图3所示。
图3 支付宝电脑网站支付

一般情况下，支付成功后会弹出支付成功提示框，如图4所示。
图4 支付成功提示框

## 参数设置
### APP支付设置
支付宝和微信支付都可通过客户端下载对应的App进行支付。这里只描述APP支付的一些基本配置，详细的设置请查阅App的帮助文档。
#### 设置支付宝 App ID 和支付回调地址
如果需要使用 APP 支付，则需要在支付宝商户后台配置 APP ID 和支付回调地址。
1. 在支付宝商户后台打开【APP 支付】-【设置】-【新版接口】，填写配置项如下：

支付宝 App ID（应用 ID）：填写自己的 Alipay SDK 采集到的 AppID，每个开发者对应一个唯一的 AppID；


支付回调地址（returnUrl）：支付成功后的回调地址，务必保证该地址可以被支付宝安全验证通过。通常来说，商户服务器上的请求处理路径就是支付成功后的回调地址。


其他支付参数（可选）：根据实际需求设置其他支付参数，比如订单有效期等。

2. 如果需要修改已有的配置，则直接在支付宝商户后台打开【APP 支付】-【设置】-【新版接口】，点击“编辑”进行修改。

注：支付宝 App ID 是重要的信息，请妥善保存！另外，请注意不要泄露支付宝 App ID。
#### 配置证书签名
使用 APP 支付时，还需要配置证书签名，否则会导致支付失败。
1. 在钥匙串中找到“我的私钥”，导出私钥文件。

图5 通过钥匙串搜索“我的私钥”

2. 用记事本打开“my_private_key.pem”文件，复制里面的内容，到支付宝商户后台【应用公钥】-【查看公钥】-【添加】，如图6所示：

图6 添加支付宝公钥
3. 从支付宝商户后台【应用公钥】-【查看公钥】中查看您的支付宝公钥是否已经添加成功。
#### 测试支付
测试支付是为了确保支付配置无误，如图7所示：

图7 支付宝手机网站支付

在测试支付之前，需要先支付宝内置的测试用例，以确保所有配置项正确。如上图，选择“手机网站支付”后，填入收款方的手机号、金额和备注信息，点击提交。