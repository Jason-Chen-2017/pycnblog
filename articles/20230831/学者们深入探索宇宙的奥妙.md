
作者：禅与计算机程序设计艺术                    

# 1.简介
  

宇宙是一个奇妙而神秘的存在。虽然物质、能量等基本属性可以清晰地理解、感知和认识，但从观测上看却无可替代——宇宙中的一切都在微小尺度上相互作用、变化、联系着。就像人们看见的现实一样。随着科技的进步和人类对宇宙的理解加深，越来越多的研究人员逐渐意识到宇宙本质上蕴藏着数学和天文学之类的美妙学科，更发现了宇宙中所蕴含的不可思议的力量。他们将探索宇宙背后的奥妙，用计算机科学、高性能计算、天文学、物理学等相关学科的知识解决现实中的真正难题，让这个奇妙而神秘的世界变得触手可及、易于访问和建模，并开辟出新方向。
为了帮助更多的人了解和掌握宇宙奥妙，同时也期待与您一起加入这个神秘的领域，搭建一个值得探索的宇宙社区。
欢迎投稿、推荐想法、交流心得体会，分享你的智慧与感悟。与我们一起，推动宇宙的前行！
# 2.基本概念术语说明
## 2.1 梅森-冯氏模型（Milne-Eddington Model）
梅森-冯氏模型是一种三维坐标系，用于描述宇宙空间中两星系间的运动。它由两个固定星球质心（中心）、一组曲线性位移的星云以及相互作用系统构成。其基本假设是有限重力和对称性，不考虑粒子加速的影响。
## 2.2 万有引力定律
万有引力定律（Newton's Law of Gravitation）是描述宇宙中物体之间的相互吸引力关系的一条著名公式。是物理学中最著名的力学 law。它描述的是物体受到其他所有物体质心的总引力。
## 2.3 大爆炸理论
大爆炸理论认为，当物体的质量增加时，其速度、大小和密度都显著提升，并释放出巨大的能量。爆炸中心以外的物体受到的损害较小，爆炸中心内的物体则损失较多。此理论还认为，不同种类的物质具有不同的热容，爆炸物的热量分布符合热力学定律，爆炸后呈现出爆炸波。由于这种特性，大爆炸理论广泛应用于各种科学领域，包括天文学、物理学、工程学、生态学等。
# 3.核心算法原理和具体操作步骤以及数学公式讲解
## 3.1 Milne-Eddington Model
### （1）基本假设
* 有限重力和对称性；
* 不考虑粒子加速的影响；
* 光速c=3×10^8 km/s。
### （2）两个固定星球质心
分别位于两个星团的质心处，不受外力的影响。称为中心星球A和中心星球B。
### （3）星云
星云是宇宙中大范围颗粒状结构，具有无限的密度。大小不一，形状各异，一般为椭圆、双曲线或随机排列等复杂的几何图形。星云内部流淌的物质具有不同质量，形状和温度，它们按照恒星表面面的分布而运行。
星云具有以下特点：
* 流动方向由自然选择给定，但不随时间改变；
* 在运动过程中，能够把离自身最近的某些离子散射出来；
* 在有限的空间内拥有无穷多粒子；
* 每个星团可能有多个星云。
### （4）相互作用系统
相互作用系统是宇宙中物体之间相互作用所形成的有机体，是宇宙中的重要组成部分。它可以分为两大类：星团间相互作用和星云间相互作用。
#### a) 星团间相互作用
当距离较近的星团因彼此相斥而无法保持一定质量时，它们就会产生星团间相互作用。星团间相互作用有两种方式，一是直接碰撞（direct collision），二是近似相互作用（approximate interaction）。
##### i) 直接碰撞
直接碰撞发生在距离较短的星团之间，相互作用可以利用重力、万有引力和核力完成。采用经典的牛顿三体问题进行说明：三个人在相同的轨道上，他俩下落到距地面高度为h的位置，然后第三个人跳到距第二个人一倍高度的位置，如此继续下去。牛顿第三定律告诉我们，如果第一个人的速度是v1，第二个人的速度是v2，第三个人的速度应该等于两人的平均速度：
v3=(v1+v2)/2
若第一、二、三人的质量分别是m1、m2、m3，则他们之间的牛顿三体距离d约为：
d=(2H)^(1/3)*[(2Mm1)/(2m2+m3)]^(1/2)
其中H为人类的普遍跳跃高度，也等于半径。因此，若质量为m的星团需要保持相对静止状态，则距离为R，那么其质量（密度）在相互作用中将降低为：
M'=M-(Md/Rp)
##### ii) 近似相互作用
近似相互作用发生在距离较远的星团之间，研究表明，在不满足牛顿第二定律的情况下，万有引力的结果会出现不连续性。而且，万有引力定律无法准确描述宇宙间的物质相互作用的情况，原因有两个：一是宇宙的空间极大，对于太远的距离，质量的变化无法完全由单一物体产生；二是太阳系内的演化使得质量分布发生巨大的变化，使得万有引力理论难以扩展到整个宇宙。因此，近年来，人们使用核力模型来描述宇宙间的万有引力行为，这是一种近似的相互作用方法。
#### b) 星云间相互作用
星云间相互作用是指宇宙中有限的星云受到单个星团的影响。这种影响主要是由星团的性质决定的。星团内的物质由气体和液体组成，通过内在的相互作用能够形成各种的聚合物，如星团壳。这些聚合物在外界形成固定点，导致星团内的运动。例如，在太阳系内，随着恒星的变老，其质量与周围的星团发生变化，形成凹陷效应，导致某些星团的行星向外侧移动。宇宙中的很多星团都有这种凹陷效应。星团内的某些物质根据形状和成分可分为不同的类型，不同类型的物质之间存在相互作用。如亚原子群和原子云之间存在相互作用，分子间的相互作用也非常重要。目前，确定宇宙物理中各种不同相互作用的方法仍然是比较活跃的研究方向。
### （5）动力学方程
根据上面所述，得到星团A和星团B之间不断变化的运动关系，建立如下的动力学方程：
$F=-\frac{Gm_AM_Bm_B}{r^3}$，
其中，$G$是常数，$m_A$, $m_B$ 分别为星团A、B的质量，$r$ 为两个质心的距离。
### （6）轨道方程
对任一一点x和y，有一个曲率$\kappa (x,y)$和角速度$\omega_{xy} (t)$，其中，$(x,y)$ 为某个点，$t$ 为时间。根据观察，宇宙中的大多数物体都有这样的曲率和角速度。由牛顿第三定律，可以得到：
$\frac{\partial \rho}{\partial t}+\nabla (\rho u)=-\nabla p+\rho \cdot f + \text{Coriolis}\times u - \nabla^{2} \psi$

其中，$\rho$ 表示密度，$u$ 表示速度，$p$ 表示压强，$f$ 是外力，$\text{Coriolis}\times u$ 表示Coriolis加速度。Coriolis加速度表明物体沿着特定方向的角速度。$\psi$ 表示压强梯度，表示发生了压力的区域。在宇宙中，我们无法直接观察到$\psi$，只能分析它如何与$\nabla^2 \psi$相乘。对于压缩性的情况，可以写作：
$\nabla^2 \psi = \frac{1}{\rho c_p T} d \psi / dt$

此时，可以解出：
$\psi(\vec x,t) = \psi_0 e^{-z/\sqrt{(GM_{\odot}/R_e)}}$

其中，$z$ 为距离地心的高度，$R_e$ 为日心距离。
### （7）动量守恒方程
动量守恒方程是描述宇宙中粒子的动量不变的条件。根据动量守恒方程，可以找到该粒子在真空中的运动轨迹：
$\frac{p_{\text{particle}}}{a}=0$，
其中，$p_{\text{particle}}$ 是该粒子的动量，$a$ 是该粒子的传播速度。
## 3.2 MCMC方法
马尔可夫链蒙特卡洛（MCMC）方法是一种模拟方法，用于生成随机样本。它利用马尔可夫链采样的方法，随机地按照状态转移的方式生成样本，有效避免了全空间搜索的方法，可以更好地描述实际情况。
### （1）定义
MCMC 方法是一种统计方法，用来生成服从特定分布的样本。简单来说，就是用迭代的方法从一个初始值开始，随机漫步，直至达到预先定义的停止条件。这个过程称为 Markov Chain 。通过模拟 Markov Chain 的历史路径，可以估计出样本的期望值及方差，从而掌握随机变量的概率分布。
### （2）算法步骤
#### a) 初始化：从指定的概率分布中，均匀或非均匀地选择 n 个初始值作为样本。
#### b) 链长设置：定义一个较大的整数 L 来控制链的长度。L通常取较大的值，比如十万、百万，以便保证较好的收敛性和稳定性。
#### c) 采样：在第 i 轮迭代中，按顺序遍历当前链上的所有样本，按照相应概率进行转移，生成新样本。每一步转移的概率取决于链上样本的状态及转移概率函数，即转移矩阵 P 。P是一个n x n的矩阵，每一项表示从当前样本状态 i 转移到样本状态 j 的概率。
#### d) 抽样：每隔一段时间，接受当前样本，即将该样本移到当前链末尾。通过抽样，可以消除链的不必要段。由于抽样频率较低，因此不会造成很大的影响。
#### e) 收敛检测：当某个样本的概率分布逐渐趋于平稳时，停止迭代。检测的方法可以是：
    1. 观察链上的样本的均值收敛情况，即样本的期望值的均方误差是否逐渐减少或收敛于某一个常数。
    2. 通过对比当前样本的杂乱程度和周期性，来判断链的收敛情况。周期性越小，则越接近平稳分布。
    3. 当某个样本在过去 L 轮迭代中，收敛的概率小于某个阈值时，认为链已经收敛，停止迭代。

### （3）示例
设想一个抛硬币的场景，要求在抛出正面或反面之后，停止抛硬币，并记录所有的结果。若硬币始终保持硬币的方形分布，且正面和反面都是等可能的，则只要抛硬币足够多次，就可以准确地模拟一次抛硬币过程。抛硬币过程可以用 MCMC 模型来模拟。
首先，初始化：假设硬币的正面朝上，选择均匀分布，选取 N 个初始样本（这里假设 N 个样本代表硬币朝上或朝下的概率，再除以 2 即为 N 种硬币的权重）。
第二步，链长设置：设 L = 10000 ，即每 10000 次迭代，计算一次样本的均值，并做一次均值收敛判断。
第三步，采样：
    i. 如果当前样本 i 是一个硬币朝上的样本，则按照转移概率 P[j->i]，生成新的样本 j，并赋予同样的概率值 P[j<-i]。这里假设硬币抛完之后不会一直保持同样的朝向。
    ii. 如果当前样本 i 是一个硬币朝下的样本，则按照转移概率 P[j<-i]，生成新的样本 j，并赋予同样的概率值 P[j->i]。这里假设硬币抛完之后不会一直保持同样的朝向。
第四步，抽样：每隔 1000 次迭代，接受当前样本。
第五步，收敛检测：当某个样本的概率分布逐渐趋于平稳时，停止迭代。这里可以设定一个阈值，比如 1% 。

最终，模拟出来的样本有几个特点：
    1. 样本的数量 N 可能随着模拟次数的增多而增多，但是不会超过硬币面向上的最大数量。
    2. 对硬币朝上的样本，其均值是一个较大的正数，对硬币朝下的样本，其均值是一个较小的负数。
    3. 对某个样本，其概率可能始终为正或负（这取决于初始化时哪个硬币朝上），但是绝不会混合在一起。
    4. 链越长，对其均值估计越准确。
    5. 模拟出来的样本中，只有最后的样本才表示硬币结束的位置。