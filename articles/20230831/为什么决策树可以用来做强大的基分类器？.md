
作者：禅与计算机程序设计艺术                    

# 1.简介
  

决策树（decision tree）是一种基本的、基本的、传统的机器学习分类方法。决策树是基于特征进行分类的一种算法，它可以认为是一个“树”结构，每一个节点表示一个特征，每个分支代表某个特征值，而叶子结点则对应于目标类别。这种方法的特点是模型简单，容易理解，同时也避免了高维空间中的“维度灾难”，因此在处理多变量问题时非常有效。下面就结合数据来介绍一下决策树。
# 2.数据准备
假设我们要训练一个算法对肿瘤的诊断，并希望通过某些特征（如身长、体重、头发颜色等）来预测肿瘤的存活率或死亡率。我们首先需要准备一些数据集，其中包括了肿瘤患者的信息以及其是否存活。例如，如下表所示的数据集。
|     | 身长  | 体重   | 头发颜色 | 是否存活 |
| --- | ----- | ------ | -------- | -------- |
| A   | 175cm | 70kg   | 洗发水   | 存活     |
| B   | 165cm | 55kg   | 棕色头发 | 存活     |
| C   | 180cm | 80kg   | 黑头发   | 存活     |
| D   | 160cm | 60kg   | 无头发   | 死亡     |

# 3.算法描述
## （1）决策树构建流程
首先，我们需要定义我们的目标，即什么样的特征最有可能能够帮助我们区分出肿瘤患者中存活和死亡两类。一般来说，我们可以从几个方面入手：

1. 选择特征。从上述数据集中，身长、体重、头发颜色等都是影响肿瘤生死的一因素，而身高与体重通常可作为两个特征值得考虑。因此，我们可以先从这两个特征入手，尝试构建一个决策树。
2. 选择切分点。在身高与体重之间，如果存在明显的不同，比如说男性身高较女性更高或者男性身高占比更低等，我们就可以将两类数据分别对待。因此，我们可以在这个特征的每个划分点处将数据集划分成两个子集，再继续选择下一个最优的特征和切分点，直到所有特征都被充分利用。
3. 停止条件。当数据集中某类数据占据的比例已经很小或者某些特征已经不具有区分能力的时候，就可以认为该特征已经无法划分数据集，停止划分。

经过以上三个步骤，我们最终得到了一个如下图所示的决策树：


左边的箭头指向“否”，表示患者没有存活；右边的箭头指向“是”，表示患者存活。根据这个决策树，我们可以用以下的规则来预测某个新的肿瘤患者的存活率：

1. 如果身长在170~180之间并且体重在60~80之间，那么他应该没有存活。
2. 如果身长在160~170之间并且体重在50~60之间，那么他应该没有存活。
3. 如果身长在170~180之间并且体重在70~80之间，那么他应该没有存活。
4. 如果身长在165~175之间并且体重在55~65之间，那么他应该存活。
5. 如果身长在175~185之间并且体重在70~80之间，那么他应该存活。

## （2）如何选择划分属性的顺序
在决策树构建过程中，我们需要选择哪个特征作为第一个特征来构建决策树呢？对于分类任务，通常会考虑选择信息增益最大的特征作为根节点。也就是说，通过计算每个特征的信息熵（information entropy）和期望信息（expected information），然后选取信息增益最大的特征作为根节点。由于信息熵衡量的是特征给数据集的纯度，所以在选择划分属性时，我们尽量使得数据集越纯越好。这里所谓的“纯度”就是指特征给数据集赋予的确定性，信息增益表示的是特征使得数据集纯度变差的程度。在一个节点上信息增益最大的属性往往是最好的属性，因此可以自底向上的方式递归地构建决策树。 

举个例子，假设现在有四组数据：

| 动物    | 年龄   | 花色 | 是否看见光亮 |
| ------- | ------ | ---- | ------------ |
| 猫      | 小猫   | 白色 | 有           |
| 狗      | 中等   | 黑色 | 有           |
| 老鼠    | 大型   | 深色 | 无           |
| 鸟      | 巨型   | 海绵 | 无           |

按照信息增益的方法，我们依次选择“动物”、“年龄”、“花色”、“是否看见光亮”作为第一组特征，得到以下决策树：


注意到，经过“动物”这一层划分之后，数据集被分为三类：小猫和老鼠，其他数据都属于“其他”。但是，如果我们按照“花色”作为第二层划分的话，则会得到以下决策树：


这样得到的决策树，在“动物”这一层已经将数据集分的比较清楚了，而在“花色”这一层却分的更加混乱，这说明在“花色”这一层划分并不具有很好的信息量。所以，我们应该尽量让数据集在各层上“纯”，而不是单单在最后一层上。