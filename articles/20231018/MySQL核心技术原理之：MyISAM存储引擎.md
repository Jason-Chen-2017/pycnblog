
作者：禅与计算机程序设计艺术                    

# 1.背景介绍


MyISAM是一个开源、免费并且快速的列存储数据库，主要用于一些对事务完整性要求不高的应用环境。其特点是表级锁定，因此并发访问时只能通过读写复制提升性能。MyISAM支持动态列添加和删除，并且提供压缩功能。但是由于采用表级锁定，所以在执行DML操作时，其他进程不能对该表进行更新操作，从而保证数据的一致性。同时，MyISAM数据文件本身是分离的，也就是说索引和数据是存放在不同的文件中，通过文件名可以确定具体的数据文件，这种结构带来的好处就是如果某个表很大的话，可以将索引文件单独放到磁盘上，而数据文件可以放在内存中，这样可以更好的利用内存资源。
# 2.核心概念与联系
## 2.1 MyISAM数据文件
MyISAM数据文件包括三个文件：frm（表单）文件，MYD（数据）文件和MYI（索引）文件。
- frm文件：保存表的定义信息，包含表结构、字段结构等信息。
- MYD文件：保存实际数据。
- MYI文件：保存索引。

这些文件的作用如下：
- frm文件：当打开一个MyISAM表的时候，MySQL首先会读取该文件中的表结构信息，然后再根据这个表结构去对应的MYD文件中读取数据。
- MYD文件：该文件保存了表的真实数据。每一条记录都占用固定长度的区域，每个文件可以保存多个表的记录。对于插入的数据，MySQL首先会分配一个空闲位置，把数据插入到这个位置上，并更新指针。
- MYI文件：该文件保存了索引。对于MyISAM表，MySQL会自动维护一个索引，用户也可以手动建立索引。索引文件一般会保存在同一目录下的ibdata文件中。

## 2.2 数据存储方式
MyISAM的内部结构与InnoDB的相似，都是为了处理大容量数据而开发出来的高性能数据库引擎。两者之间最大的不同在于：
- InnoDB是基于聚集索引实现的，并且提供了完整的事务隔离级别，支持事物的ACID特性，支持外键，支持行级锁。
- MyISAM则是基于堆表实现的，也支持行级锁，但不支持事务的ACID特性。
其中，InnoDB支持表级锁定机制，使得在高并发的场景下有着比MyISAM更好的性能。此外，InnoDB还支持外键，并且有更高的并发性能。

MyISAM的数据存储形式类似于关系型数据库中的表格模式，即按照行主导的方式存储数据。每张表对应一个独立的MYD数据文件，文件中按顺序存放表中各行记录。每条记录的长度相同，如果某些字段的值过长，超过了列宽限制，MySQL会将该字段视为一个溢出数据。每张表还有一个MYI索引文件，用于存放相应的索引。

## 2.3 MyISAM的查询效率
MyISAM的查询速度比较快，因为它的数据文件是按索引检索的，而且索引缓存命中率也比较高。由于数据文件和索引文件分开存放，因此，打开表的时候不会加载整个表到内存，仅仅只是将索引结构加载到内存，所以查询速度快。

## 2.4 MyISAM的适用场景
由于MyISAM的特点，在一些场合可以替代InnoDB，比如只需要插入少量数据，或者经常进行 selects 操作的临时表，或者一些第三方工具生成的临时表等。但是，MyISAM缺乏事务支持和崩溃恢复能力，对于某些对事务完整性要求较高的业务场景，比如银行交易系统，不能使用MyISAM，否则将导致数据丢失或数据不正确的问题。