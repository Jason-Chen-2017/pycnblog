
作者：禅与计算机程序设计艺术                    

# 1.简介
  

MyISAM是一个高效、低占用的网络数据库管理系统（DBMS），它被设计用于嵌入到各种应用当中，尤其适合于磁盘空间要求较大的Web和基于磁盘的应用环境。虽然它的名字是MyISAM，但其实不仅仅局限于只读方式打开文件的方式，它的索引结构也类似于InnoDB的聚集索引结构。

MyISAM存储引擎是一种支持事务的表类型，并且提供了对外键约束、行级锁定等多种功能。MyISAM存储引擎的数据和索引都存放在一个文件中，因此数据量越大，文件大小就越大，性能就会受到影响。不过，对于大多数应用来说，这个影响不会特别严重。相比于InnoDB存储引擎的索引，MyISAM的索引大小一般要小很多。如果需要频繁地访问数据库，则推荐使用InnoDB，因为它的索引查找速度更快。

# 2.基本概念及术语
## 2.1 数据库
数据库（Database）是按照数据结构组织、存放、处理和管理数据的仓库。在MySQL中，数据库就是指存放数据的整体。数据库分为两个主要的类型——关系型数据库和非关系型数据库。

关系型数据库（RDBMS）由关系模型组成，这种模型把数据表中的记录用二维表结构组织起来，每条记录都有唯一标识符，通过主键和外键可以建立联系。关系型数据库的优点是强一致性、完整性、安全性、并发控制和事务机制，缺点是硬件资源消耗大、查询效率低。目前最流行的关系型数据库包括MySQL、Oracle、PostgreSQL等。

非关系型数据库（NoSQL）除了数据结构上的区别外，另一个重要区别是从逻辑角度看待数据。非关系型数据库中，数据的逻辑意义上无关紧要，不仅没有主键、外键等设施限制，反而具备更高的灵活性和扩展性。目前最流行的非关系型数据库包括Redis、MongoDB、Couchbase等。

## 2.2 数据库引擎
数据库引擎（Engine）是用来管理和维护关系数据库的核心服务。不同的数据库产品通常提供不同的数据库引擎，如MySQL中的默认数据库引擎就是MyISAM，Oracle中的数据库引擎可能是Oracle自身的数据库引擎，而PostgreSQL中的数据库引擎是一些开源的模块化组件。

数据库引擎有两种主要的分类：联机事务处理/OLTP和联机分析处理/OLAP。OLTP是Online Transaction Processing的缩写，表示在线事务处理；OLAP是Online Analytical Processing的缩写，表示在线分析处理。

## 2.3 事务
事务（Transaction）是作为单个逻辑工作单元执行的一系列数据库操作，其特征为原子性、一致性、隔离性、持久性和时序性。事务是数据库管理系统进行数据库维护的一个不可或缺的环节。

## 2.4 ACID特性
ACID（Atomicity、Consistency、Isolation、Durability）特性是事务的四个属性。

① Atomicity（原子性）
事务是一个不可分割的工作单位，事务中包括的诸操作要么都做，要么都不做。事务开始后一直运行到提交完成。

② Consistency（一致性）
事务必须是使数据库从一个正确状态变到另一个正确状态。一致性确保了数据库数据有效且符合预期。

③ Isolation（隔离性）
多个事务并发执行时，一个事务的执行不能被其他事务干扰。即一个事务内部的操作及使用的数据对并发的其他事务是隔离的，并发执行的各个事务之间不能互相干扰。

④ Durability（持久性）
一旦事务提交，则其所作的改变将会永久保存到数据库中。即使数据库发生故障也不会丢失该事务的操作结果。

# 3.MyISAM存储引擎
## 3.1 数据文件
MyISAM存储引擎的数据文件本质上就是一个大的随机映射文件（Random Access File，也称为内存映射文件）。数据文件的结构是索引、数据文件头部信息、数据指针、记录等构成的。索引、数据文件头部信息、数据指针都是按照固定大小分配。实际的数据存放在数据指针指向的文件中。


如上图所示，MyISAM数据文件主要有以下几个部分组成：
- 文件头：文件头包含文件格式信息、指针信息以及最新插入记录的标识符等。
- 插入缓冲（Insert Buffer）：为了提升性能，MyISAM存储引擎使用了一个插入缓存，它保存着等待写入磁盘的数据。当数据更新时，首先进入插入缓存，然后再批量写入磁盘。
- 双重链表（List of Free Blocks and Records）：MyISAM使用了一个双向链表来管理空闲的块和记录。
- 数据区域：数据区域就是真正存储数据的文件。MyISAM可以对数据文件进行压缩，但不是所有的版本都支持压缩。

## 3.2 索引文件
MyISAM存储引擎使用B+树索引作为其索引结构。MyISAM的索引文件本质上也是B+树，但是由于每个页节点只存放索引记录的地址，而不是数据记录，因此索引文件占用的空间比较少。


如上图所示，MyISAM索引文件主要有以下几个部分组成：
- 文件头：文件头包含文件格式信息、指针信息以及最新插入记录的标识符等。
- B+树层次结构：MyISAM的索引文件以B+树的形式存在，而非B-树或者B树。
- 数据区域：数据区域就是真正存储索引记录的文件。