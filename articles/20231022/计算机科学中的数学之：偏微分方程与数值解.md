
作者：禅与计算机程序设计艺术                    

# 1.背景介绍


在计算机科学中，广义的数学被分成微积分、线性代数、概率论、数值分析等多个领域，数学是计算机科学的一把利器，因此理解并掌握数学对于学习、研究、开发计算机程序至关重要。正如本文所讨论的内容，偏微分方程（PDE）也同样重要。PDE即 Partial Differential Equations 的缩写，它是指由两个以上变量（一般用x和y表示）间相互作用而产生的微分方程。比如流体力学、电磁场、多元非线性动力学等都是 PDE 的应用。 

偏微分方程的通用形式通常如下所示：

∂^2f/∂x^2 + ∂^2f/∂y^2 + a(x, y)f = g(x, y)，其中a(x, y)为系数矩阵、f(x, y)为函数或分布、g(x, y)为右端项，称为边界条件或者边值问题。

根据不同的 PDE 情况，方程的对偶形式可以分成一维、二维或三维。一维情况很简单，对偶形式就是常规的微分方程；二维情况下，对偶形式如下：

∆u = b - A(x, y)u，其中u(x, y)为未知函数或分布、b(x, y)为边界条件、A(x, y)为系数矩阵，称为 Helmholtz 方程。

二维 PDE 的对偶形式比较复杂，有时可以分解成三个一维 PDE 的组合，通过求解三个一维对偶方程实现求解二维对偶方程的目的。

三维 PDE 的对偶形式依然较为复杂，但是可以通过分解的方法求解。比如 Navier-Stokes 方程可以分解成三类一维对偶方程，分别为momentum equation（位移方程），continuity equation（流体守恒方程），advection-diffusion equation（扩散方程）。通过求解这三个方程的对偶方程，就可以求得 PDE 的全部解。当然，还有一些其他类型的三维 PDE 可以利用类似的方法求解。

2.核心概念与联系
## 2.1 基本概念及性质
### （1）场（Field）
$$f: \Omega \to R^{n}$$
设 $n$ 为任意整数，$R^{n}$ 是 $n$ 维实数空间。如果存在一个函数 $g:\Omega\times \mathbb{R}^{n}\to \mathbb{R}^n$, 使得：

$$\forall (x,t)\in \Omega\times \mathbb{R}, f(x)=g(x,t),$$

则称 $f$ 为函数 $g$ 在 $\Omega$ 上关于时间的场（Field of Tangent Vectors）。

当 $\Omega=\mathbb{R}^d$ 时，上述定义直接给出了定义。当 $\Omega=[a_1,b_1]\times[a_2,b_2] \times...\times [a_{d-1},b_{d-1}]$ 时，有：

$$f: ([a_1,b_1]\times[a_2,b_2] \times...\times [a_{d-1},b_{d-1}])\times [t_0,t_1] \to \mathbb{R}^{\otimes d}$$

## 2.2 一阶线性微分方程
$$\begin{cases}
	\frac{du}{dt}(x, t) &= Lu(x, t)+F(x, u(x, t)) \\
	u(x, t=0) &= u_0(x).
\end{cases}$$

上面这个方程叫做一阶线性微分方程，其中 $L$ 是可逆的对称矩阵，表示微分算子，$F$ 是关于 $u$ 的未知函数。将其变形，可得到对偶形式：

$$Lu = F.$$

### （1）偏微分方程
$$\frac{\partial}{\partial x_i} u(\mathbf{x}, t)-\frac{\partial}{\partial x_j} u(\mathbf{x}, t)=-\frac{\delta}{\delta x_i} p_{\nabla}(\mathbf{x}, t),\quad i \neq j,$$

$$\frac{\partial}{\partial t} u(\mathbf{x}, t)=-\Delta u(\mathbf{x}),\quad x\in \Omega,\quad t>0.$$

此处的 $\delta/\delta x_i$ 表示偏导数符号，$p_{\nabla}(\cdot)$ 表示二阶范数。

### （2）流动方程
$$-\nabla\cdot u+\nu\Delta u=f(x),\quad x\in\Omega,\quad t>0,$$

其中 $u(x, 0)=\vec{v}_0(x)$ 是初始条件。

### （3）压力传输方程
$$-\nabla \cdot (\mu u+\lambda v)+\kappa\nabla \cdot H=0,\quad x\in\Omega,\quad t>0,$$

其中 $\mu$ 和 $\lambda$ 分别是粘度系数，$\kappa$ 是布林克比系数。

### （4）热传导方程
$$-\nabla\cdot (k(T-T_r)u)=-\rho c_p\nabla T+\rho \beta\nabla S,\quad x\in\Omega,\quad t>0,$$

其中 $k$ 是 conductivity，$c_p$ 是体积平均的空气温度，$\rho$ 是密度，$\beta$ 是热传导系数。

## 2.3 偏微分方程的几何意义
偏微分方程是描述物理系统变化的方程，其形式十分丰富，而且还有着实际应用广泛的特性。实际上，每个偏微分方程都可以等价于一维的对偶方程，通过求解这些方程，就能得到整个偏微分方程的解。由于对偶方程的数量远少于偏微分方程的数量，所以许多偏微分方程都可以在对偶方程的帮助下进行快速求解。如下图所示为流动方程的几何意义。
