
作者：禅与计算机程序设计艺术                    

# 1.背景介绍


## 什么是回文串
在中国，回文串就是从左往右读和从右往左读都是一样的字符序列，比如："level"、"civic"、"kayak"等等。反过来，如果字符串中只有一个字符，或者中间有一个空格或其他不相干的字符，那么它就不是回文串了。所以，回文串具有一种特殊的特征：它的两端对称。
## 如何判断是否是回文串？
一般情况下，我们需要通过比较两个指针（通常是两个变量）来判断一个字符串是否是回文串。一个指针指向开头，另一个指向结尾；然后依次比较这两个指针所指的字符，如果相同则继续移动指针，直到两个指针相遇（此时仍然可以认为该字符串是一个回文串）。注意，这种比较方法的时间复杂度为O(n)，其中n是字符串的长度。但当字符串非常长时，这种比较的方法会很耗费时间，尤其是在字符串中存在大量重复的字符时。因此，为了提高效率，人们提出了多种有效的算法来解决这一问题。
## 如何快速判断一个字符串是否是回文串？
当两个指针指向同一位置时，该位置上的字符就是回文中心。因此，如果将整个字符串分割成奇数个子字符串，且每个子字符串都是一个回文串，那么整个字符串也是一个回文串。另外，只需比较两端的两个字符，就可以判断一个字符串是否是回文串。因此，如果第一个字符等于最后一个字符，而第二个字符等于倒数第二个字符，那么这个字符串就是回文串。这是一种简单直接有效的方法，比起分割字符串的方式要更快一些。但是，这种方法对于一些特殊情况不能够处理好。例如："abccba"是一个回文串，但是"abcdeca"却不是回文串。
# 2.核心概念与联系
## 不回文子串
设$T[0..n-1]$表示字符串$s[0..n-1]$，定义$LCS_i$为以$i$为中心的最长不回文子串的长度，那么$LCS_i$就可以定义为：
$$
\begin{aligned}
& LCS_i = \max\{LCS_{j+1},LCS_{i-1}\}\\
&\text{ if } s_i!= s_{n-i+1} \\
&\text{ return max\{LCS_{j+1},LCS_{i-1}\}}\\
&\text{ else }\quad i=j=n/2,\cdots,1
\end{aligned}
$$
那么，根据定义，不回文子串的长度是多少呢？显然，如果$s[i]=s[n-i+1]$，也就是第$i$个字符等于第$(n-i+1)$个字符，那么第$i$个字符就处于中心位置，而且一定构成回文中心。因此，有如下定理：
$$
\forall 1\leq i< n, (LCS_i>i) \leftrightarrow (s[i]!=s[n-i])
$$
## Manacher’s Algorithm
Manacher’s algorithm 是一种计算任意一个字符串的最长回文子串的有效算法。它的基本思想是利用动态规划，先求出每个位置是否是回文中心，再找出回文串的各个子串。其基本过程如下：

1. 用$P[i]$表示字符串$s[0...i]$的最长回文半径，初始化$P[i]$为0，$R$表示以当前字符$s[i]$为中心的回文串的最右边界。

2. 对每一位$i$，设$j$表示$i$向右移动一位后的最右端点。如果$i$能延伸至$j$成为回文中心，那么令$p_l$=$min(R-i+1, P[j]+1)$；否则，令$p_l$=$max(R-i+1, P[j]+1)$。同时，更新$P[i]$=$p_l$。

3. 将所有满足$P[i]$=length($s$)的$i$作为回文中心，这些中心按照字母顺序排列得到所有的回文子串。

Manacher’s algorithm 的运行时间为$O(|s|)$，空间复杂度为$O(|s|)$。
# 3.核心算法原理和具体操作步骤以及数学模型公式详细讲解
## 方法一——暴力法
暴力法遍历字符串的所有可能的回文子串，然后检查每个子串是否是回文串。这样的方法时间复杂度为$O(\frac{n^3}{m})$，其中$n$表示字符串的长度，$m$表示所有可能的回文子串的个数。
## 方法二——Manacher's Algorithm
### 步骤1 初始化
首先，用$P[i]$表示字符串$s[0...i]$的最长回文半径，初始化$P[i]$为0，$R$表示以当前字符$s[i]$为中心的回文串的最右边界。

### 步骤2 求$P[i]$
对于$i$位字符串，设$j$表示$i$向右移动一位后的最右端点。如果$i$能延伸至$j$成为回文中心，那么令$p_l$=$min(R-i+1, P[j]+1)$；否则，令$p_l$=$max(R-i+1, P[j]+1)$。同时，更新$P[i]$=$p_l$。

### 步骤3 枚举回文中心
根据$P[i]$的值，选取所有满足$P[i]$=length($s$)的$i$作为回文中心，这些中心按照字母顺序排列得到所有的回文子串。

### 步骤4 返回结果
返回所有的回文子串。

### 模型方程
设$T[0...n-1]$表示输入的字符串，$n$为字符串长度，$len(T)$表示字符串的长度。

## 时间复杂度分析
假设最坏情况下，每个字符串都没有回文子串，那么最坏情况下的时间复杂度为$O(n^3)$。

当字符串不含特殊字符时，Manacher's algorithm 能比暴力法更快地识别回文串，因此Manacher's algorithm 更加高效。当字符串中存在特殊字符时，Manacher's algorithm 会出现问题。例如，字符串中包含“aba”，Manacher's algorithm 无法正确识别。 

# 4.具体代码实例和详细解释说明