
作者：禅与计算机程序设计艺术                    

# 1.简介
         
 在统计学和概率论中，卡方分布（Chi-squared distribution）又称卡方分布，是一种连续型随机变量的分布。一般来说，如果X是一个随机变量，其概率密度函数（probability density function）F(x)满足如下特性：
            F(x)>0 ∀x,且积分(∞->0)[f(t)^2] = 1,则称X服从卡方分布。 
          其中，f(t)是t的任意正负函数，且积分(0->∞)[f(t)] = 1,t=ln(x).显然，当f(t)=t^k时，f(t)^2<=k个连续的负整数，积分值为k^2/2,此时X就服从负二项分布（Negative Binomial Distribution）。
          如果X服从卡方分布，则由中心极限定理可知：
           (1) E[X]=df,   df:参数个数（自由度），X服从的最大似然估计的自然参数；
           (2) Var[X]=2*df/(x*(x+df)),    x>0,   当x趋于无穷大时,Var[X]>E[X].         
         本文将介绍卡方分布的定义及其与负二项分布的关系。
         # 2.卡方分布的定义及特点
         ## 2.1卡方分布的定义
         设随机变量 X 的概率密度函数为 F(x), 则 X 满足卡方分布的充分必要条件是：

           P(X>=k) = P(exp(-(y/2)) <= exp(-(z/2))) * Z((2k)/(1-p)),    k>0, p>0

          其中，Z(x) 是标准正态分布（Normal distribution）的累积分布函数。

         当样本容量很大的时候，样本空间S中的概率质量函数可以用概率密度函数表示。因此，从观测到某个实际值x之后，可以通过查表法或直接计算累积分布函数的方法求出P(X>=k)，从而确定事件发生的可能性。

         从定义中可以看出，卡方分布是指随机变量 X 在第 i 个取值的个数在 n 次独立实验中平均数大于等于 k 的概率，其中 i 是非负整数，n > 0 为常数， p 表示失败概率。定义中的 “独立” 可以使得每一次试验之间没有联系，即样本空间 S 中每个元素都要被选中且只选中一次，不能有重复选中。

         卡方分布的特点：
         1、卡方分布是一个连续型分布，具有很好的数学性质。
         2、卡方分布对所研究的事件发生频率分布进行了描述。
         3、卡方分布可用来解决两个或多个互斥的随机变量之间的两两独立检验问题。
         4、卡方分布还可以用来检测和评价数据，因为它具有显著性检验的能力。
         5、卡方分布常用于大样本统计分析中，当样本数量非常大的时候。

        ## 2.2卡方分布的应用
        ### 2.2.1检验总体均值是否等于指定值
        假设检验对象为随机变量 X，检验目标为判断 X 的总体均值是否等于某给定的值 $\mu_0$ 。

        对于检验目的，我们需要决定采用什么检验统计量。

        以连续型随机变量为例，通常采用 z 分数或者 t 分数作为检验统计量。

        对于 z 分数，当样本数量较小时，z 分数的分布形式较为简单，易于处理；

        而当样本数量较大时，通常采用正态近似法来估计 z 分数的分布，进一步减少误差。

        采用正态近似法计算得到的 z 分数对应的分布函数 f(z)，可以用来计算 P(Z >= z_d|H0)，其中 Z 是检验统计量，z_d 是临界值，H0 为假设的零假设，即 X 的总体均值等于 $\mu_0$ ，当 Z 大于等于 z_d 时，拒绝 H0 。

        当样本数量较小时，也可以根据公式 P(Z >= z_d|H0) 直接计算出检验结果，但当样本数量较大时，需要利用拟合优度检验的方法来选择最合适的临界值 z_d。

        另外，为了检验假设 H0 是否正确，也可以计算出临界值 z_a 和 Pr(|Z|>z_a) 来给出显著性水平。

        ### 2.2.2检验各组间的均值是否相等
        假设检验对象为一组或多组随机变量 X_i，检验目标为判断这些随机变量 X_i 的均值是否相等。

        以单尾卡方检验为例，假设检验双侧检验边际为两侧不等分布，即检验区间为 (-\inf, a]U[b,\inf)，其中 a, b 为某一给定的边际值。

        单尾卡方检验的基本思路就是利用中心极限定理来估计检验统计量 Z 的概率分布，并据此计算出检验统计量 Z 在该区间上的概率值。

        当样本容量很大时，样本空间 S 中的概率质量函数可以用概率密度函数表示。因此，我们可以直接利用概率密度函数 f(z) 计算 P(Z >= z_d|H0)，其中 Z 是检验统计量，z_d 是临界值，H0 为假设的零假设，即 X_i 的均值相等，当 Z 大于等于 z_d 时，拒绝 H0 。

        此外，我们还可以利用检验统计量 Z 对比其他统计量（如 z 分数、t 分数等）来判断在检验区间内，均值相等的假设是否成立。

      ### 2.2.3检验各组间的方差是否相等
      假设检验对象为一组或多组随机变量 X_i，检验目标为判断这些随机变量 X_i 的方差是否相等。

      以 Welch’s t 检验为例，Welch's t 检验是单尾皮尔逊校正的单样本 T 检验。

      在单尾卡方检验中，检验统计量 Z 是取自正态分布，而若方差存在差异，则无法通过正态近似计算 z 分数，因而也就不能直接利用中心极限定理来求出 P(Z >= z_d|H0)。

      但是，Welch's t 检验同样也是利用中心极限定理来估计检验统计量 Z 的概率分布，并据此计算出检验统计量 Z 在该区间上的概率值。

      通过拟合优度检验方法，可以选出最佳的 t 分数，然后利用 Wald 置信度公式计算出检验统计量 Z 在该区间上的置信度。

      此外，若方差不存在差异，则检验结果为 X_i 的方差相等。