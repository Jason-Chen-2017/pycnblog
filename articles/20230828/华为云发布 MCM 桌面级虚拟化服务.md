
作者：禅与计算机程序设计艺术                    

# 1.简介
  


目前云计算领域中虚拟化技术占据着很重要的地位，云平台作为虚拟化基础设施的提供者，用户可以在其中部署各种类型的应用虚拟化资源，包括物理机、虚拟机、容器等。随着云服务的日益壮大，越来越多的公司、组织都选择了云平台作为自己的IT基础设施，以更加低廉的价格购买计算资源。企业通过云平台部署应用，可以获得极高的灵活性和弹性伸缩能力，并降低运营成本。

目前，华为云提供了基于OpenStack、CloudStack、VMware vSphere、Docker等主流虚拟化技术的云桌面虚拟化服务。本文将介绍华为云最新发布的MCM（Managed Cloud Management）桌面级虚拟化服务，并阐述其功能特性，进而展示如何使用该服务。

## 2.什么是MCM？

MCM（Managed Cloud Management）全称“托管型云管理”，是华为云提供的一种托管桌面级虚拟化服务，提供租户可见性、管理功能完整且功能齐全的完整解决方案，帮助客户快速在公有云上构建和运行应用程序，实现业务增长和提升效率。MCM 连接到华为云的物理机和虚拟机，提供统一的管理界面，支持多种终端类型、操作系统和工作负载，包括Windows、Linux、Unix等桌面环境。MCM 的主要功能包括：

- **租户可见性** - MCM 将所有云平台上的虚拟机、云硬盘、网络和安全组等资源聚合在一起，可视化呈现给租户，让租户能够清晰看到自己的资源情况。同时，还集成华为云监控组件，实时监测资源使用情况，及时发现异常，并自动触发相应事件，避免因资源不足导致的故障；

- **资源池划分** - 可以将云硬盘按照磁盘大小、用途和访问频率进行分类，从而提供不同级别的资源池；

- **定制管理** - 通过自定义模板创建桌面虚拟机，可以方便地对需要安装软件的桌面配置进行定制；

- **租户隔离** - 可根据租户信息划分资源池，确保租户之间资源的安全隔离；

- **支持Windows、Linux、Unix等桌面环境** - 提供多种桌面环境，包括Windows Server、Windows、Linux和Unix等桌面系统，支持在公有云上运行各种企业级应用；

- **自动化管理** - 支持自动预配、部署和生命周期管理，简化了虚拟化和云平台管理复杂度；

- **云硬盘加密** - 提供了对云硬盘加密的支持，确保用户数据的安全；

- **GPU/RDMA支持** - 提供了GPU/RDMA技术资源的分配，为用户提供更高性能和价值驱动的桌面环境。


## 3.MCM架构




MCM服务由三个部分组成：

1. MCM Agent - 在各个云平台上安装，用于跟踪云平台上的虚拟机、云硬盘、网络等资源状态，并实时向MCM Manager发送数据，接收指令执行相关操作。
2. MCM Manager - 安装在华为云的管理服务器上，作为云平台资源的入口，处理所有用户请求，并与各个Agent通信，协调调度资源使用，保证整个MCM服务的正常运行。
3. Web控制台 - 用户通过Web页面或API接口访问MCM服务，使用户能够轻松查看和管理自己的云资源。

## 4.MCM的优势

MCM服务具有以下优势：

1. 无需关心底层虚拟化技术 - 用户只需关注应用的部署，不需要关心底层基础设施的配置；
2. 支持多种桌面系统 - MCM 服务支持 Windows、Linux 和 Unix 等桌面系统，并提供完整的软件栈，满足各行各业的需求；
3. 灵活可控 - MCM 服务的资源划分、定制管理、租户隔离等功能，使得用户能够充分利用云资源；
4. 安全可靠 - MCM 服务的资源池划分、租户隔离、云硬盘加密等功能，为用户的数据安全提供了保障；
5. GPU/RDMA支持 - MCM 服务提供了基于GPU和RDMA技术的可选规格，满足用户对计算密集型应用的需求。

## 5.如何使用MCM服务

1. 注册MCM服务


2. 配置云平台

    在申请成功后，登录华为云的管理控制台，选择“MCM（托管云管理）”服务，进入服务详情页。在“配置管理”标签页下，选择所需云平台，例如OpenStack、CloudStack或VMware vSphere，然后点击“下一步”。
    
3. 创建资源池

    在“资源池管理”标签页下，可以创建多个资源池，用于存储不同类型和级别的云硬盘，并将这些资源池划分给不同的租户。创建资源池时，需指定名称、描述、云平台类型、可用区和共享权重等属性。
    
    > 注意：每个租户只能属于一个资源池，资源池下的云硬盘只能被该租户使用。
    
4. 创建桌面虚拟机

    在“桌面虚拟机管理”标签页下，可以创建不同配置的桌面虚拟机。创建桌面虚拟机时，需指定名称、描述、镜像、vCPU数量、内存容量、系统盘大小、本地数据盘大小、资源池、SSH密钥、安全组等属性。创建成功后，虚拟机会加入到资源池中，等待租户启动。
    
    > 注意：MCM 服务不限制租户的可用资源数量，因此用户可根据自身业务需要，创建任意数量的桌面虚拟机。
    
5. 查看资源使用情况

    用户可以通过“资源池管理”标签页查看自己已创建的资源池，以及各资源池的云硬盘使用情况。在“云硬盘管理”标签页下，用户可以查看自己已创建的所有云硬盘的详细信息，包括云硬盘ID、类型、大小、状态、租户、备份策略、挂载机器信息等。
    
    > 注意：用户只能看到自己的资源，不能查看其他租户的资源。
    
6. 使用桌面虚拟机

    用户可以使用远程桌面或者VNC工具，登录自己的桌面虚拟机，并进行必要的操作。在“我的云主机”标签页下，用户可以查看和管理自己创建的虚拟机。

## 6.MCM的未来展望

MCM 服务仍处于测试阶段，更多的功能正在陆续添加中，包括：

1. 批量导入/导出虚拟机 - 借助批量导入/导出功能，用户可以批量上传或下载虚拟机的配置文件，便于快速部署和迁移；
2. 高级设置 - 为云主机配置更复杂的环境，如设置内网IP地址、自定义元数据、添加标签、绑定安全组等；
3. 密钥管理 - 提供对云平台秘钥的统一管理，并集成华为云密钥管理服务；
4. 多区域部署 - 让用户可以在不同区域部署资源，以提升整体可用性；
5. 滚动升级 - 允许云主机按需进行滚动升级，缓解不稳定的网络环境影响。