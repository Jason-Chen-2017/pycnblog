                 

# 1.背景介绍


## 概述
随着人工智能、自然语言处理（NLP）、以及人工流程自动化（RPA）技术的蓬勃发展，越来越多的企业对RPA流程进行了改造，引入人工智能模型、文本生成技术来提升工作效率。但是，由于业务需求的不断迭代升级、数据环境的快速变化、以及复杂的业务规则、多语种的日益增加等诸多因素的影响，使得RPA在运行过程中不可避免地会面临各种不确定的因素——包括数据缺失、业务规则改变、多模态信息输入、多方参与人机交互、多层级反馈环节等。因此，如何在不断变化的业务环境下有效应对这种不确定性是RPA在企业中落地的一项重要课题。

本文试图通过对历史项目的分析、总结经验教训及反思，结合我们所拥有的相关技术以及项目的实际情况，给出一套完整的方法论及方案，助力企业将RPA部署到生产环境中解决实际问题。文章的主要读者群体为具有一定编程基础的技术专家、产品经理、架构师等。

本文基于一个真实场景下的实践案例，采用基于开源GPT-2框架的Agent模型，通过一个带有不确定的项目实践。其中包括业务规则改变、数据缺失、多模态输入、多方参与人机交互、多层级反馈等多个方面的不确定性。本文希望借鉴这一场景，向读者展示如何构建能够应对多种不确定性的RPA Agent模型。通过本文，希望读者可以更好地理解RPA模型的原理、优势、局限，并能借此提高业务工作效率、减少人工成本。


## 方案概览
### 1.项目背景介绍
该项目是一个市场营销软件企业，负责对每天用户数据进行统计分析，从而为企业提供决策支持。目前，该软件由业务部经理亲自编写自动化脚本，每天根据不同的运营策略发送邮件、短信或推送通知。由于业务需求的不断迭代升级、数据环境的快速变化、以及复杂的业务规则、多语种的日益增加等诸多因素的影响，导致自动化脚本的维护困难、稳定性差等问题。公司希望在不断变化的业务环境下，有效应对RPA在项目中的不确定性，因此需要寻找一种合适的RPA解决方案来加强公司现有脚本的功能，提高工作效率。

### 2.目标客户
- RPA工程师：负责完成自动化脚本开发、调试等工作
- 数据分析师/科学家：负责数据统计分析、可视化展现
- 业务人员：负责了解项目业务规则、需求等

### 3.项目实施周期
项目分为两个阶段：设计和编码阶段。分别对应于实施计划和执行阶段。

#### （1）设计阶段
- 概要设计：对项目的整体规划和管理结构进行明确
- 细化设计：定义工作流模板、关键节点以及各节点之间的关系等
- 测试设计：考虑待测功能的有效性、准确性、可用性、性能、可移植性等测试要求
- 集成设计：考虑各模块之间的接口协议、数据存储方式、以及第三方依赖等约束条件

#### （2）编码阶段
- 编码环境准备：安装相关工具、软件库、环境配置等
- 业务规则编码：用Python或其他编程语言编写业务规则
- 界面元素识别：根据业务需要，提取界面关键元素，如按钮、文本框、表格、弹窗等
- 模块化封装：封装整个业务流程，实现模块间的调用关系
- 自动化脚本生成：根据业务规则模板，通过自动生成脚本实现业务需求的自动化
- 数据驱动算法：通过机器学习、深度学习等方法，训练算法模型，对数据进行预测、分类、聚类等处理
- 调试与单元测试：检查脚本是否正确执行、算法模型效果是否符合预期
- 发布部署：发布脚本至服务器上，并在预置条件下验证脚本的稳定性

## 不确定性和RPA模型
### 1.不确定性简介
“不确定性”（uncertainty）是指事物的表现存在某种程度上的不确定性或者变动性。不确定性可能来自于内在随机性、外生影响、自身能力、社会共识以及信息误差等多种因素，它直接影响着模型的结果。它常常出现在诸如房价、股票价格等可观察到的经济变量中，也有可能出现在生物、化学和天文等非经济变量中。本文的项目中存在以下几种不确定性：

- 业务规则：由于业务的需求不断变化、部门之间的协调不够及时等原因，可能会导致脚本无法按时有效地执行业务流程。例如，在员工培训、薪酬福利调整、奖金发放等环节，业务人员经常希望脚本能够及时的触发，而这些脚本只能依赖于业务人员手动操作的结果。因此，可能导致自动化脚本无法正常运行。
- 数据缺失：当数据采集工作不够及时、采集设备故障等原因导致原始数据缺失时，自动化脚本可能无法正常执行。例如，如果业务人员经常因突发事件耽搁招聘活动，导致招聘渠道中的人力资源系统数据未及时更新。这种情况下，脚本依据的数据缺失，就会出现脚本无法正常执行的问题。
- 多模态输入：业务流程涉及到的信息往往具有多元特征，比如文字、图片、视频等。自动化脚本应该具备处理多模态数据的能力。例如，一些工作流需要文本图像视频混合处理，其中文本信息可以用来提取关键词，图片信息可以用来判断风险级别等。
- 多方参与人机交互：自动化脚本要有良好的人机交互能力，可以与业务人员协同、监督、指导。例如，客户咨询、投诉、售后等环节，都可以借助人机交互的方式帮助企业更好地服务客户。但是，目前很多RPA产品只针对业务人员的单一角色设计，无法满足多方参与人的需求。
- 多层级反馈环节：自动化脚本在执行过程中，还可能存在多层次的反馈环节。例如，脚本一旦执行成功，会返回一条消息；如果脚本发生错误，则会返回报错信息；还有可能出现系统转义字符、回显异常信息等问题。这些不确定性都会影响自动化脚本的运行结果。

### 2.RPA模型简介
一般来说，RPA模型分为基于UI自动化的RPA和基于关键字的RPA。基于UI自动化的RPA模型利用计算机视觉技术，通过解析屏幕上的用户界面（UI），能够实现一定程度上的自动化。而基于关键字的RPA模型则根据一系列的动作关键字，来实现特定功能的自动化。本文采用的是基于UI自动化的RPA模型，其主要特点如下：

- 速度快：采用了基于图像识别的方法，通过对页面截图进行分析，进行快速定位，实现快速响应。同时，还可以结合学习算法，对指令进行优化。
- 覆盖范围广：RPA模型覆盖了各种类型的UI界面，如浏览器、应用程序、手机APP等，可用于多个领域，并有跨平台兼容性。
- 可扩展性强：可以轻松扩展，增加新功能，而无需重新编制脚本。同时，可以支持多种编程语言，使用户可以灵活选择自己的编程水平。
- 容易被学习：RPA模型简单易懂，学习成本低。同时，也可以和人类一样，自由操控，适应各种场景。

因此，RPA模型在本文项目中也扮演了重要作用。

## 项目的实践过程
### 1.业务规则改变
由于业务需求的不断迭代升级、部门之间协调不够及时等原因，业务部门经常希望脚本能够及时的触发，而这些脚本只能依赖于业务人员手动操作的结果。因此，脚本可能不能及时准确地执行业务流程。

在项目初期，由于业务部门的技术能力较弱，因此没有足够的能力去实施全量的自动化测试，而是依赖于业务人员手工操作测试。由于业务人员的技术能力有限，在自动化脚本的开发、维护等方面存在很大的挑战。并且由于脚本的复杂性和脚本语言的限制，在测试过程中会遇到较多的困难和阻碍。

由于业务部门缺乏自动化脚本的知识，所以对自动化脚本的执行效率也缺乏重视。业务部门认为，脚本的编写时间太长，不利于业务提速，因此在项目早期，没有给予足够的重视。因此，在项目早期，脚本运行缓慢、不稳定、易出错等问题常常出现。

尽管业务部门缺乏自动化脚本的知识，但在项目早期，由于业务人员对自动化脚本有了一定的培训，因此项目团队可以进行脚本编写。但由于业务规则频繁变化，且脚本开发工作量比较大，因此项目团队往往对自动化脚本的开发难度较大。

项目团队在项目开发过程中，发现脚本的运行效率较低，而且容易出错。并且由于脚本运行在独立的PC机器上，很难模拟完整的用户操作行为，所以往往难以探索业务规则的变化，进而不得不修改脚本。最后，项目团队决定在项目之后，进行脚本重构，以便解决以上痛点。

### 2.数据缺失
由于招聘系统中存在众多数据的缺失，因此在项目中，我方人员经常发现脚本执行出错、漏报招聘信息等问题。业务人员经常希望脚本能够及时触发，而这些脚本只能依赖于业务人员手动操作的结果。因此，在项目中，除了业务规则不定时修改之外，项目组为了保证脚本的正常运行，还需要重视数据收集的质量。

由于项目组的技术能力不足，导致项目组难以有效地进行数据收集。他们在项目中一直在研究各种数据的采集方法，但由于时间紧张，也没能做到完美的工作。另外，由于各个模块之间的接口协议、数据存储方式、以及第三方依赖等约束条件不统一，导致项目组在开发过程中的耦合性大。这就导致项目组在数据的采集和处理上存在很大的不便。

在项目中，为了解决数据采集问题，项目团队尝试了一些方法。首先，项目团队借助于各个领域的专业数据采集工具，如智联招聘网站的API接口，以及HR信息系统等，采集到数据。其次，项目团队还邀请了有经验的业务人员，帮助业务人员进行数据采集，并汇总数据。但是，由于项目中存在众多数据缺失的问题，项目团队只能靠自己解决问题。最后，项目团队决定招聘新的技术人员，以提高数据的采集效率。

### 3.多模态输入
在项目中，脚本经常需要处理多模态数据，包括文字、图像、视频、音频等。因此，在项目中，脚本需要具备处理多模态数据的能力。

虽然当前的RPA产品可以处理文字信息，但由于文字信息属于主流的信息输入形式，RPA模型还有很大的发展空间。为了解决这个问题，项目团队尝试了几种处理文字输入的方法。

首先，项目团队利用技术方法，提取关键词，从而进行判断。例如，对于招聘流程的文字输入，项目团队可以提取出关键词，如职位名称、城市名称、学历、技能等。然后，项目团队利用机器学习模型，对提取出的关键词进行分类，判断出该岗位的级别。

其次，项目团队利用AI模型，进行文本摘要，从而缩小文字输入信息的规模。例如，对于招聘描述的文字输入，项目团队可以借助AI模型，对描述进行自动摘要，缩小其大小，提高数据的准确度。

再次，项目团队利用OCR技术，将文字输入转换为图像输入。例如，对于招聘岗位名称的文字输入，项目团队可以借助OCR技术，将文字输入转换为图片输入，提升识别精度。

最后，项目团队尝试了两种多模态混合输入的方法。第一种是采用图像识别技术，即同时接收文本图像、视频等多种数据。第二种是通过同时采集文本和图像、视频等多种数据，提升识别的精度。

总的来说，为了处理多模态输入的问题，项目团队在技术上有很大的进步，但仍然存在很大的问题。

### 4.多方参与人机交互
在项目中，脚本需要具有良好的人机交互能力，可以与业务人员协同、监督、指导。例如，客户咨询、投诉、售后等环节，都可以借助人机交互的方式帮助企业更好地服务客户。

当前的RPA产品虽然可以进行人机交互，但仍存在很多限制。例如，产品只能针对业务人员的单一角色设计，无法满足多方参与人的需求；产品的表达能力有限，只能表达单一的指令，不能表达多种复杂的情景；产品的运维成本高，无法适应大型项目；产品对不同的平台和技术依赖性不够强，难以与不同类型的业务系统连接等。

为了解决多方参与人机交互的问题，项目团队在技术上、组织上、方法论上进行了深入研究，试图寻找一种解决方案。

首先，项目团队试图探索多方参与人机交互的技术方案。项目团队先后研发了文字识别、语音识别、手势识别、姿态识别等技术，并集成到RPA模型中。

其次，项目团队在产品的运维方面进行优化，让RPA模型具备较高的可靠性和可维护性。例如，项目团队提出了三套流程自动化的标准，其中包括产品可用性、操作逻辑、脚本编写规范。项目团队在实施流程自动化的过程中，就着手解决问题，确保自动化脚本的健壮性、可靠性和可维护性。

第三，项目团队在设计之初就把多方参与人机交互纳入了产品的考虑，通过引入多方参与人机交互模式，使RPA模型更具备智能化和适应性。例如，项目团队设计了多层次的反馈机制，允许脚本不仅仅返回简单的消息，还可以返回图文混合的信息，以增强自动化脚本的智能化、高效性和鲁棒性。

最后，项目团队在实施过程中，通过持续的反馈和沟通，不断修正不合理的设计和实现方式，来优化产品的功能。

综上所述，项目中存在着多种不确定性，项目团队在处理不确定性时，有自己的独特的思路和方法。最终，项目团队将自动化脚本部署到了服务器上，并运行正常，为企业提供了优秀的解决方案。