
作者：禅与计算机程序设计艺术                    

# 1.背景介绍


企业架构评审是一个复杂的过程，它涉及到多个相关职能部门、人员、角色和责任边界，需要综合考虑各方利益需求、意愿、能力以及对架构价值的判断。根据国际标准，国际上主要有五种架构评审方法:SEI (Software Engineering Institute) 的SABSA (Software Architecture Board of Architects) 方法、ISO/IEC 42010:2011 (Information technology -- Systems and software engineering -- Software architecture evaluation)的方法、CAx (Computer Aided Architecture)的方法、TOGAF 方法和NTIA卫星网络安全(NSTAR)方法等。

这些方法通常分为以下三个阶段：

1. 检查阶段:企业架构设计者和评审人会使用工具进行初始检查，收集整理相关信息，包括组织结构、功能需求、业务目标、质量属性、约束条件、外部接口、技术选型、内部系统依赖、合作伙伴关系、用户群体等。

2. 技术分析阶段:该阶段主要从功能需求、约束条件、内部系统依赖、外部接口以及基础设施等方面进行详细技术分析和规划。

3. 意义验证阶段:在这一阶段中，将对评审者提供的信息进行确认、比较、分析和理解，并检验是否满足企业架构的要求。

但随着时间的推移，这些方法已成为评估企业架构成熟度、强化其正确性和有效性的有效工具。由于企业架构评审往往具有严格的时间要求、高门槛和严重的隐形成本，因此，很多企业都选择采用四种简单而实用的评审方法：增量式评审、优化式评审、改进式评审和阶段式评审。

增量式评审：增量式评审适用于快速构建和评估早期产品。该方法的特点是在较短的时间内，多次对架构进行修改，通过一系列的评审来逐步完善架构。

优化式评审：优化式评审适用于构建新的或改进现有产品的架构。该方法基于长远的目标，即通过引入最佳的技术方案，提升产品的性能、效率、可用性和可靠性。优化式评审的方法通常具有反馈机制，使得架构评审团队能够随时调整评审方向以达到最佳效果。

改进式评审：改进式评审适用于现有产品的重构和更新。该方法侧重于识别并解决当前架构中的缺陷和瓶颈。

阶段式评审：阶段式评审类似于增量式评审，但采用不同的方式进行评审。阶段式评审首先按照功能特性、服务组件、系统部署的位置等不同层级进行评审。评审者根据每一阶段的结果，制定下一阶段的重点关注领域，并将后续工作集中到相应的层级上进行。阶段式评审可以帮助企业实现产品迭代，缩短开发周期，降低风险。

然而，增量式评审、优化式评审、改进式评审和阶段式评审只是基本的架构评审方法。在实际应用中，还要结合项目管理、流程和工具，进行更全面的架构评审，包括：

1.架构演变图:在架构演变图中，企业可以直观地看到架构的演变历史，并掌握产品生命周期中架构变化的规律。

2.需求文档模板:需求文档模板是指供应商、客户或者内部团队编写的需求文档的一种模版，里面包含了对系统功能、性能、稳定性、可用性、用户满意度等方面的需求描述。

3.架构评审问卷:架构评审问卷也是一种常用的架构评审工具，它由一系列的问题组成，用于衡量对企业架构所做出的评估。这些问题涵盖了企业架构的范围、目标、结构、决策、监控、治理、运维、控制、合规、法规等方面。

这些方法或工具是建立在一定的准则之上的，但当企业的架构复杂度过高或规模过大时，它们可能无法奏效。因此，“小而精”的企业架构评审方法应运而生。
# 2.核心概念与联系
## 2.1 企业架构评审方法简介
企业架构评审是一个复杂的过程，它涉及到多个相关职能部门、人员、角色和责任边界，需要综合考虑各方利益需求、意愿、能力以及对架构价值的判断。根据国际标准，国际上主要有五种架构评审方法:SEI (Software Engineering Institute) 的SABSA (Software Architecture Board of Architects) 方法、ISO/IEC 42010:2011 (Information technology -- Systems and software engineering -- Software architecture evaluation)的方法、CAx (Computer Aided Architecture)的方法、TOGAF 方法和NTIA卫星网络安全(NSTAR)方法等。 

但是随着时间的推移，这些方法已成为评估企业架构成熟度、强化其正确性和有效性的有效工具。由于企业架构评审往往具有严格的时间要求、高门槛和严重的隐形成本，因此，很多企业都选择采用四种简单而实用的评审方法：增量式评审、优化式评审、改进式评审和阶段式评审。

增量式评审：增量式评审适用于快速构建和评估早期产品。该方法的特点是在较短的时间内，多次对架构进行修改，通过一系列的评审来逐步完善架构。

优化式评审：优化式评审适用于构建新的或改进现有产品的架构。该方法基于长远的目标，即通过引入最佳的技术方案，提升产品的性能、效率、可用性和可靠性。优化式评审的方法通常具有反馈机制，使得架构评审团队能够随时调整评审方向以达到最佳效果。

改进式评审：改进式评审适用于现有产品的重构和更新。该方法侧重于识别并解决当前架构中的缺陷和瓶颈。

阶段式评审：阶段式评审类似于增量式评审，但采用不同的方式进行评审。阶段式评审首先按照功能特性、服务组件、系统部署的位置等不同层级进行评审。评审者根据每一阶段的结果，制定下一阶段的重点关注领域，并将后续工作集中到相应的层级上进行。阶段式评审可以帮助企业实现产品迭代，缩短开发周期，降低风险。

## 2.2 小而精的企业架构评审方法
《4.企业架构评审方法：“小而精”的企业架构评审》主要基于“SEI SABSA方法”。为了能够更好地满足企业的需求，我们在此基础上进行了一些改进。

### 2.2.1 “小而精”的企业架构评审方法概述
目前，很多企业架构评审方法都采用了系统性的架构评审模型，但有些企业很难按照此框架进行架构评审。因此，我们提出了“小而精”的企业架构评审方法，其特点如下：

- 架构设计者：根据业务的发展和技术的变化，对架构设计进行阶段化拆分，拆分成几个阶段，每个阶段分配一定数量的重要功能模块。
- 架构评审人：对于每个阶段的架构设计，只评审其中少数几个重要的功能模块，其他功能模块暂时不评审，通过一轮评审评估阶段是否达到了预期的效果。
- 架构评审团队：由架构设计者和评审人组成的评审团队，评审人员按照步骤完成架构评审，在评审过程中生成架构评审报告，让整个评审流程可持续地演进。
- 架构评审结果：在每个阶段的结束，评审人员将阶段评审结果反馈给架构设计者。若阶段评审结果符合预期，架构评审继续进行下一个阶段的评审；若阶段评审结果存在偏差，则需要回滚或重新设计该阶段的架构。

这样的评审方法可以让架构评审变得更加精细化，同时也可以消除掉传统的“全盘”架构评审方式带来的弊端。

### 2.2.2 “小而精”的企业架构评审方法评审步骤
1. 架构设计阶段：将企业架构划分成多个阶段，每个阶段都有一定的重要功能模块，架构设计者负责将阶段划分得更细致，分配到架构设计者手里。
2. 每个阶段的架构评审阶段：架构评审人只评审少数几个重要的功能模块，其他模块暂时不评审。架构评审人员按照步骤完成架构评审，在评审过程中生成架构评审报告。
3. 结果反馈与调整：架构评审人员根据阶段评审结果，反馈给架构设计者，并进行调整，若阶段评审结果符合预期，架构评审继续进行下一个阶段的评审；若阶段评审结果存在偏差，则需要回滚或重新设计该阶段的架构。
4. 最后的总体评估：架构评审人员将所有阶段的评审结果汇总，并与架构设计者一起制定架构评审结论。

### 2.2.3 “小而精”的企业架构评审方法优势
1. 可行性：“小而精”的企业架构评审方法的实践意义是使架构评审更加精细化，并减轻传统的全盘评审方式带来的不必要的复杂性，从而提升评审效率和可行性。
2. 周期性：“小而精”的企业架构评审方法的周期性高，对于企业来说，架构评审的频率也比较高。每两个月一次的评审周期就可以覆盖多个版本的架构，确保架构的最新状态和最佳实践。
3. 成本：“小而精”的企业架构评审方法的成本相比传统的评审方法要低很多，因为评审人员只评审少数几个重要的功能模块，其他功能模块暂时不评审。而且，评审过程无需支付太多的人力资源费用。
4. 流程化：“小而精”的企业架构评审方法将评审过程经历了一轮轮的改进，并且使评审的效率得到了保证，可以在架构评审中增加更多的价值。

# 3.核心算法原理和具体操作步骤以及数学模型公式详细讲解
我们对“小而精”的企业架构评审方法进行具体讲解。首先，介绍一下“SEI SABSA”架构评审方法的基本原理。

## 3.1 SEI SABSA方法基本原理
### 3.1.1 什么是SABSA方法？
SABSA(Software Architecture Board of Architects)方法，即软件架构委员会的软件架构评审方法。是由美国软件工程师协会（SEI）制定的一个软件架构评审方法。该方法使用“角色”的概念，把软件架构评审分为4个步骤：收集阶段、分析阶段、决定阶段和执行阶段。SABSA方法由4个主要角色：项目管理官（Project Manager）、软件架构设计者（Software Architecture Designer）、架构评审专家（Architecture Evaluator）、软件质量保证专家（Software Quality Assurance Expert）。

### 3.1.2 为什么要使用SABSA方法？
SABSA方法有如下好处：
1. 有明确的评审过程。SABSA方法强调“收集”、“分析”、“决定”、“执行”，而且是严格按照评审步骤进行评审的。这种评审过程非常规范和细致。
2. 评审结果客观。SABSA方法把软件架构的质量作为第一要素进行评判，既包括静态的结构质量，也包括动态的功能质量、性能质量和可用性质量。SABSA方法的评审结果是可信的、客观的、可重复的。
3. 评审过程透明可追溯。SABSA方法记录了所有的评审过程，包括每个评审人的参与情况、评审结果、反馈等，整个评审过程都被完全记录下来。因此，任何人都可以通过评审记录，跟踪整个软件架构评审的过程。
4. 评审成果可复用。SABSA方法的评审结果一旦产生，就作为参考依据，可以用于不同类型的软件系统的架构评审。

### 3.1.3 SABSA方法的评审步骤
SABSA方法的评审步骤有：
1. 收集阶段：收集阶段主要是指软件架构设计者收集软件架构的所有相关信息，包括目标、范围、系统需求、系统结构、交互、数据流、性能、安全、可靠性、鲁棒性、界面、非功能性需求、外部接口、内部组件、系统部署、内部通信、授权和兼容性等。
2. 分析阶段：分析阶段主要是指软件架构设计者分析收集到的所有信息，并将其转换为有效的架构蓝图。蓝图必须包含架构的功能模块、子系统、组件之间的连接、分布、接口、数据等。
3. 决定阶段：决定阶段主要是指架构评审专家对蓝图进行评审，并做出架构的决定。决定阶段必须进行架构设计的可行性分析、合理性分析、有效性分析和性能分析。
4. 执行阶段：执行阶段主要是指架构评审专家根据决定进行架构设计的实施。执行阶段必须定义架构开发工具、流程、标准和流程，并让评审专家在评审过程中了解每个决定的具体含义。

### 3.1.4 软件架构设计的关键步骤有哪些？
在进行软件架构设计的时候，需要经过以下几个关键步骤：
1. 目标设置：确定架构的目标，即要解决什么问题，为什么要设计这个架构。
2. 功能规划：定义出系统的所有功能模块和功能，功能模块之间如何连接。
3. 数据流建模：描述系统的数据流、控制流和事件流。
4. 分布式计算处理：把任务分成单一的小任务，并根据容错、高可用、扩展性、并发性等因素将其分布式处理。
5. 系统部署：定义系统的部署方式和部署平台。
6. 系统测试：测试软件系统的性能、容错、可用性、可靠性、鲁棒性、安全性、可靠性、易用性等。
7. 系统维护：定义架构的维护方式、保障措施、升级计划和策略。
8. 用户研究：研究用户需求、痛点、期望，并根据用户需求确定架构的界面设计、性能测试、可用性测试等。
9. 系统兼容性：研究与其他软件系统的兼容性问题，并设计出架构的兼容性方案。

### 3.1.5 使用SABSA方法进行企业架构评审有什么优势？
使用SABSA方法进行企业架构评审的优势有：
1. 清晰的评审过程：SABSA方法清楚地定义了评审过程，评审人员知道自己应该做什么，避免了误解。
2. 一致的评审结果：SABSA方法的评审结果是可重复的，相同的评审过程不会导致不同的评审结果。
3. 标准化的评审过程：SABSA方法的评审标准与国际标准保持一致，可确保评审结果的一致性和可移植性。
4. 对标国际标准：SABSA方法可以对标国际标准，验证自己的评审方法是否正确。
5. 灵活的评审内容：SABSA方法允许在评审过程中增加或删除评审内容。

## 3.2 “小而精”的企业架构评审方法：具体操作步骤以及数学模型公式详细讲解
### 3.2.1 创建阶段
创建阶段的目标是创建一个阶段的列表，其中包含项目管理官、软件架构设计者、架构评审专家、软件质量保证专家，以及每项工作所占的比例。将其分配到不同人手上。

| 项目管理官     |  3   |
| ------------ | ---- |
| 软件架构设计者 |   1  |
| 架构评审专家   |  20  |
| 软件质量保证专家 | 30%  |

### 3.2.2 阶段评审
阶段评审的目的是评估每个阶段的架构是否达到预期的效果。评审步骤如下：
1. 阶段开始前的准备：收集阶段设计时的所有材料，讨论评审目的、评审范围、评审对象、评审评审人员的角色和分工、选择评审工具等。
2. 提供阶段蓝图：每个阶段的架构设计都要有一个蓝图，用来阐述阶段的目标、范围、设计目标、模块间的连接、组件的输入输出等。
3. 模块级别评审：每个模块的架构评审都包含需求、功能、实现、部署、测试、文档、配置等方面的评审，评审时主要考察模块的目标、范围、功能、实现、配置等方面。
4. 回顾阶段的评审结果：所有阶段的评审结果都要汇总到一起，评审人员将阶段的结果和意见汇总成建议，并对建议进行梳理、归纳、提炼和审核。
5. 将建议反馈给阶段的架构设计者：架构设计者接收到阶段的评审意见后，根据意见进行调整，然后再次提交阶段的蓝图。
6. 阶段的最终评审结果：每一个阶段的评审结果都会反馈给阶段的架构设计者，最后再将所有阶段的结果汇总到一起，确定阶段的评审结论。

### 3.2.3 阶段计划表
阶段计划表是一种用于管理阶段评审活动的工具，包括以下几种部分：
1. 阶段编号：每个阶段的编号都需要唯一标识。
2. 阶段主题：每个阶段都有一定的主题，比如模块设计、服务设计、第三方库设计等。
3. 阶段日期：每个阶段的结束日期都需要填写。
4. 评审任务：每个阶段的评审任务都会列出，评审人员需要遵循的步骤和规则。
5. 评审人员：每个阶段都要指定评审人员，评审人员需要具备相应的知识、技能、态度才能真正参与到评审中。
6. 评审材料：每个阶段的评审材料都需要准备齐全，材料包括需求文档、功能文档、设计文档、接口文档、测试文档等。

# 4.具体代码实例和详细解释说明
## 4.1 Python程序示例——“小而精”的企业架构评审方法
```python
import random

class ProjectManager:
    def __init__(self):
        self.project = "xxxx" #项目名称

    def create_phase_list(self):
        phases = []

        for i in range(3):
            phase = Phase()
            phase.set_id("P"+str(i+1))
            if i == 0:
                phase.set_theme("初始设计")
            elif i==1:
                phase.set_theme("高级功能设计")
            else:
                phase.set_theme("完善和测试")
            phase.set_start_date("2021年3月第"+str((i+1)*3)+"周")
            tasks=[]
            
            task=Task()
            task.set_content("需求收集：包括项目背景、业务需求、技术需求、架构风格等，收集周边环境信息、领导需求等")
            tasks.append(task)

            task=Task()
            task.set_content("功能设计：划分模块、子系统、核心功能、外部接口、内部组件、性能、稳定性、可靠性等功能模块")
            tasks.append(task)

            task=Task()
            task.set_content("架构蓝图设计：设计出阶段的架构蓝图，蓝图包括模块之间的连接、接口、数据等，并进行模块的可行性、合理性、有效性、性能等分析")
            tasks.append(task)

            task=Task()
            task.set_content("模块接口分析：检查每一个模块的接口是否满足设计要求，如参数类型、参数顺序、返回值等")
            tasks.append(task)

            task=Task()
            task.set_content("模块实现：实现模块的功能，包括核心功能模块、外部接口模块、内部组件模块")
            tasks.append(task)

            task=Task()
            task.set_content("模块部署：将模块部署到生产环境中，包括选择硬件、操作系统、部署方式等")
            tasks.append(task)

            task=Task()
            task.set_content("模块测试：对模块进行测试，包括单元测试、集成测试、系统测试、性能测试、压力测试、兼容性测试等")
            tasks.append(task)

            task=Task()
            task.set_content("文档编写：编写模块的文档，包括需求文档、功能文档、设计文档、接口文档、部署文档、测试文档等")
            tasks.append(task)

            task=Task()
            task.set_content("制定阶段性计划：制订阶段性计划，主要包括内容安排、工作计划、沟通管理等")
            tasks.append(task)

            task=Task()
            task.set_content("阶段总结：对阶段的评审结论进行总结，并将其反馈给阶段的架构设计者")
            tasks.append(task)

            phase.set_tasks(tasks)

            phases.append(phase)
        
        return phases
    
    def review_phases(self, phases):
        result={}
        total_score=0
        
        for p in phases:
            score=random.randint(1,10)
            print("\n----------------------------------------")
            print("【阶段】",p.get_id(),"【阶段主题】",p.get_theme())
            for t in p.get_tasks():
                print("- ",t.get_content(),"得分:",score,"分")
            result[p.get_id()]=score
            total_score+=score
            
        avg_score=total_score/len(phases)
        print("\n----------------------------------------\n","平均分:",avg_score,"分")
        
        final_result="通过" if avg_score>=60 else "不通过"
        print("最终结果：",final_result,"\n----------------------------------------")
        
    
class Phase:
    def __init__(self):
        self.id=""        #阶段编号
        self.theme=""      #阶段主题
        self.start_date="" #阶段日期
        self.tasks=[]      #评审任务

    def set_id(self, id):
        self.id = id
        
    def get_id(self):
        return self.id

    def set_theme(self, theme):
        self.theme = theme
        
    def get_theme(self):
        return self.theme

    def set_start_date(self, start_date):
        self.start_date = start_date
        
    def get_start_date(self):
        return self.start_date

    def add_task(self, content):
        task=Task()
        task.set_content(content)
        self.tasks.append(task)

    def set_tasks(self, tasks):
        self.tasks = tasks
        
    def get_tasks(self):
        return self.tasks


class Task:
    def __init__(self):
        self.content="" #任务内容

    def set_content(self, content):
        self.content = content
        
    def get_content(self):
        return self.content

if __name__=="__main__":
    project_manager = ProjectManager()
    phases = project_manager.create_phase_list()
    project_manager.review_phases(phases)
```