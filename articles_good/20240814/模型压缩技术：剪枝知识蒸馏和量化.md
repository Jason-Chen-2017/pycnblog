                 

# 模型压缩技术：剪枝、知识蒸馏和量化

> 关键词：模型压缩, 剪枝, 知识蒸馏, 量化, 模型优化, 深度学习, 加速训练, 移动设备, 嵌入式系统

## 1. 背景介绍

### 1.1 问题由来

近年来，深度学习模型在多个领域取得了显著进展，从图像识别到自然语言处理，再到游戏AI，深度学习已经成为了人工智能的基石。然而，深度学习模型的训练和部署都伴随着高昂的计算成本，这对硬件资源提出了巨大挑战。因此，如何在保证模型性能的同时，大幅降低其计算需求，成为了学术界和工业界共同关注的问题。

### 1.2 问题核心关键点

深度学习模型通常包含数亿个参数，其计算需求巨大，对内存、CPU、GPU等硬件资源消耗严重，这也限制了深度学习模型的应用范围。为了解决这个问题，研究者们提出了多种模型压缩技术，如剪枝、知识蒸馏、量化等。这些方法通过移除冗余参数、减少计算量，不仅降低了模型大小，还显著提升了计算效率，从而使得深度学习模型能够在大规模部署上实现规模化应用。

### 1.3 问题研究意义

模型压缩技术的提出，对深度学习的应用场景拓展，计算效率提升，以及硬件资源的优化都有着重要意义：

1. **拓展应用场景**：模型压缩技术使得深度学习模型能够部署在计算资源有限的设备上，如移动手机、嵌入式系统等，从而拓展了深度学习的应用范围。
2. **提升计算效率**：模型压缩技术显著减少了计算量，使得深度学习模型能够更快地进行推理，加速了模型的实际应用。
3. **优化硬件资源**：模型压缩技术通过减少参数和计算量，优化了深度学习模型对硬件资源的需求，降低了硬件成本。

## 2. 核心概念与联系

### 2.1 核心概念概述

模型压缩技术主要分为三类：剪枝(Pruning)、知识蒸馏(Knowledge Distillation)和量化(Quantization)。这些技术通过不同的方式压缩模型，降低其计算和存储需求，提高计算效率。

- **剪枝(Pruning)**：通过移除模型中冗余的参数，减少模型的计算量，从而降低模型大小。剪枝可以按照权重的绝对值或相对重要性进行。
- **知识蒸馏(Knowledge Distillation)**：通过将大型模型的知识传递给小型模型，使得小型模型能够学习到大型模型的决策能力，从而提升模型性能。
- **量化(Quantization)**：通过减少模型参数的精度，降低模型的存储需求和计算成本。量化可以分为离散化(Discretization)和稀疏化(Sparsification)两种方式。

这些核心概念之间的逻辑关系可以通过以下Mermaid流程图来展示：

```mermaid
graph TB
    A[剪枝(Pruning)] --> B[知识蒸馏(Knowledge Distillation)]
    B --> C[量化(Quantization)]
    A --> D[参数优化]
    D --> E[模型压缩]
    A --> F[内存优化]
    F --> G[内存友好的压缩算法]
    A --> H[模型加速]
    H --> I[硬件优化]
    A --> J[深度学习框架集成]
    J --> K[高效压缩]
```

这个流程图展示了模型压缩技术的核心概念及其之间的关系：

1. 剪枝、知识蒸馏和量化可以视为模型压缩的主要手段。
2. 参数优化、内存优化、模型加速等技术可以帮助进一步提升模型性能。
3. 深度学习框架集成和硬件优化是模型压缩技术实现的基础。

这些核心概念共同构成了模型压缩技术的理论和实践框架，使得深度学习模型能够在不同的硬件平台上高效运行。

## 3. 核心算法原理 & 具体操作步骤
### 3.1 算法原理概述

模型压缩技术的目标是在保持模型性能的前提下，尽可能减小模型大小，降低计算需求。其核心思想是通过移除冗余参数、减少计算量，使得模型在硬件资源受限的条件下仍能高效运行。

以下是三种核心模型压缩技术的概述：

- **剪枝(Pruning)**：通过移除不重要或冗余的参数，减少模型的计算量，从而降低模型大小。
- **知识蒸馏(Knowledge Distillation)**：通过将大型模型的知识传递给小型模型，使得小型模型能够学习到大型模型的决策能力，从而提升模型性能。
- **量化(Quantization)**：通过减少模型参数的精度，降低模型的存储需求和计算成本。

### 3.2 算法步骤详解

以下是模型压缩技术的详细步骤：

**剪枝(Pruning)**
1. **模型初始化**：对目标模型进行初始化，通常使用随机权重进行初始化。
2. **选择策略**：选择剪枝策略，如基于权重绝对值、相对重要性等。
3. **剪枝执行**：根据所选策略，移除模型中冗余的参数。
4. **后续优化**：对剪枝后的模型进行后续优化，如重新训练或微调，以恢复部分性能损失。

**知识蒸馏(Knowledge Distillation)**
1. **定义教师和学生**：选择大型模型作为“教师”，小型模型作为“学生”。
2. **知识传递**：将教师模型的知识（如特征提取能力、决策能力）传递给学生模型。
3. **优化学生模型**：通过反向传播和优化算法，优化学生模型，使其尽可能学习教师模型的知识。
4. **评估和调整**：评估学生模型的性能，必要时对知识传递过程进行调整。

**量化(Quantization)**
1. **模型选择**：选择目标模型进行量化。
2. **量化策略**：选择量化策略，如离散化或稀疏化。
3. **参数量化**：将模型参数量化为更小的精度，如从32位浮点数量化到8位整数。
4. **优化调整**：对量化后的模型进行优化，如重新训练或微调，以恢复部分性能损失。

### 3.3 算法优缺点

模型压缩技术具有以下优点：

1. **降低计算需求**：通过剪枝、量化等方法，大幅减少了模型参数和计算量，使得深度学习模型能够在计算资源受限的设备上高效运行。
2. **提升计算效率**：模型压缩技术显著降低了计算需求，从而提升了模型的计算效率，加速了推理过程。
3. **优化硬件资源**：模型压缩技术通过减少参数和计算量，优化了深度学习模型对硬件资源的需求，降低了硬件成本。

同时，模型压缩技术也存在一定的局限性：

1. **性能损失**：模型压缩技术不可避免地会带来一定的性能损失，尤其是在剪枝和量化过程中。
2. **复杂度高**：模型压缩技术的实现需要考虑多种因素，如剪枝策略、量化精度等，增加了模型压缩的复杂度。
3. **应用场景有限**：某些模型压缩技术可能只适用于特定的模型或任务，应用场景存在一定的局限性。

尽管存在这些局限性，但就目前而言，模型压缩技术仍是深度学习模型应用的重要手段。未来相关研究的重点在于如何进一步降低模型压缩对性能的影响，提高模型压缩的普适性，同时兼顾计算效率和硬件资源优化。

### 3.4 算法应用领域

模型压缩技术在多个领域得到了广泛应用，包括：

- **图像识别**：通过剪枝和量化，优化了图像识别模型的计算需求，使其能够在移动设备上高效运行。
- **自然语言处理**：通过知识蒸馏，提升了自然语言处理模型的推理能力，加速了模型的推理过程。
- **嵌入式系统**：通过模型压缩技术，使得深度学习模型能够在资源有限的嵌入式系统上实现高效推理。
- **数据中心**：通过剪枝和量化，优化了深度学习模型对硬件资源的需求，降低了数据中心的计算和存储成本。

除了上述这些经典应用外，模型压缩技术还被创新性地应用于更多场景中，如可控参数优化、动态模型选择等，为深度学习技术带来了全新的突破。

## 4. 数学模型和公式 & 详细讲解 & 举例说明

### 4.1 数学模型构建

以下是模型压缩技术的数学模型和公式推导：

**剪枝(Pruning)**
1. **模型初始化**：设模型参数为 $\theta$，初始化时 $\theta \sim \mathcal{N}(0, \sigma^2)$。
2. **剪枝策略**：选择剪枝策略 $\mathcal{S}$，如基于权重绝对值或相对重要性。
3. **剪枝执行**：移除重要性低的参数，设保留参数为 $\theta'$。
4. **后续优化**：对剪枝后的模型 $\theta'$ 进行后续优化，如重新训练或微调，以恢复部分性能损失。

**知识蒸馏(Knowledge Distillation)**
1. **定义教师和学生**：教师模型为 $M_{\text{teacher}}$，学生模型为 $M_{\text{student}}$。
2. **知识传递**：定义教师模型的输出为 $\hat{y}_{\text{teacher}} = M_{\text{teacher}}(x)$，学生模型的输出为 $\hat{y}_{\text{student}} = M_{\text{student}}(x)$。
3. **优化学生模型**：通过反向传播和优化算法，最小化学生模型和教师模型的输出差距，即 $\min_{\theta_{\text{student}}} \mathcal{L}(\hat{y}_{\text{student}}, \hat{y}_{\text{teacher}})$。
4. **评估和调整**：评估学生模型的性能，必要时对知识传递过程进行调整。

**量化(Quantization)**
1. **模型选择**：选择目标模型为 $M_{\theta}$。
2. **量化策略**：选择量化策略，如离散化或稀疏化。
3. **参数量化**：将模型参数量化为更小的精度，如从32位浮点数量化到8位整数。
4. **优化调整**：对量化后的模型进行优化，如重新训练或微调，以恢复部分性能损失。

### 4.2 公式推导过程

以下是模型压缩技术的公式推导过程：

**剪枝(Pruning)**
$$
\theta_{\text{pruned}} = \theta_{\text{initial}} \cap \mathcal{S}
$$
其中 $\theta_{\text{initial}}$ 为初始化后的模型参数，$\mathcal{S}$ 为剪枝策略，$x \in \mathcal{S}$ 表示参数 $x$ 在剪枝策略中。

**知识蒸馏(Knowledge Distillation)**
$$
\min_{\theta_{\text{student}}} \mathcal{L}(\hat{y}_{\text{student}}, \hat{y}_{\text{teacher}})
$$
其中 $\mathcal{L}$ 为损失函数，$\hat{y}_{\text{teacher}} = M_{\text{teacher}}(x)$，$\hat{y}_{\text{student}} = M_{\text{student}}(x)$。

**量化(Quantization)**
$$
\theta_{\text{quantized}} = \text{quantize}(\theta_{\text{initial}})
$$
其中 $\text{quantize}$ 为量化函数，$\theta_{\text{initial}}$ 为初始化后的模型参数。

### 4.3 案例分析与讲解

以下是一个简单的案例，演示了如何在VGG模型上进行剪枝操作：

1. **模型初始化**：使用VGG模型作为初始模型。
2. **选择策略**：选择基于权重绝对值的剪枝策略，移除权重绝对值小于某个阈值的参数。
3. **剪枝执行**：使用上述策略，移除权重绝对值小于 $10^{-3}$ 的参数。
4. **后续优化**：对剪枝后的模型进行微调，恢复部分性能损失。

## 5. 项目实践：代码实例和详细解释说明
### 5.1 开发环境搭建

在进行模型压缩实践前，我们需要准备好开发环境。以下是使用Python进行TensorFlow开发的环境配置流程：

1. 安装Anaconda：从官网下载并安装Anaconda，用于创建独立的Python环境。

2. 创建并激活虚拟环境：
```bash
conda create -n tf-env python=3.8 
conda activate tf-env
```

3. 安装TensorFlow：根据CUDA版本，从官网获取对应的安装命令。例如：
```bash
conda install tensorflow -c tensorflow -c conda-forge
```

4. 安装TensorBoard：TensorFlow配套的可视化工具，用于实时监测模型训练状态，提供丰富的图表呈现方式。
```bash
pip install tensorboard
```

5. 安装Flax：Flax是Google开发的深度学习框架，支持高效的模型压缩操作。
```bash
pip install flax
```

6. 安装Pprof：用于性能分析的CPU分析工具，可以在模型压缩过程中使用。
```bash
pip install pprof
```

完成上述步骤后，即可在`tf-env`环境中开始模型压缩实践。

### 5.2 源代码详细实现

下面我们以VGG模型为例，给出使用Flax库进行剪枝的PyTorch代码实现。

首先，定义剪枝函数：

```python
import flax
import flax.linen as nn
import jax.numpy as jnp
from flax.linen.initializers import normal_

def pruning_schedule(scale):
    return lambda weight: weight * scale

def pruning_layer(modules, key, drop_rate):
    mod = modules[key]
    if isinstance(mod, nn.Dense):
        prune = pruning_schedule(1 - drop_rate)
        weight = prune(mod.weight)
        mod.weight = weight
    return mod

def pruning_layer_fn(params, drop_rate):
    return flax.struct.transform_with_pruning(params, pruning_layer, drop_rate=drop_rate)
```

然后，定义剪枝后的模型：

```python
class PruningVGG(nn.Module):
    num_layers: int
    drop_rate: float
    
    def setup(self):
        self.layers = nn.layers.dense_sequence(
            self.num_layers, self.num_filters, self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3x3,
            self.depthwise_conv3

