                 

# Flink 原理与代码实例讲解

> 关键词：Apache Flink, 流处理, 容错性, 分布式计算, 有状态状态管理, 流状态处理, 分布式事务

## 1. 背景介绍

### 1.1 问题由来

随着大数据时代的来临，实时数据处理的需求日益增长。传统的批量处理系统无法满足实时性和低延迟的要求，而流处理系统应运而生。Apache Flink 作为开源流处理框架，以其高性能、低延迟、强一致性和灵活性等特性，成为业界的领先解决方案。

### 1.2 问题核心关键点

Flink 的核心竞争力在于其高性能、低延迟、强一致性等特点。通过分布式计算和状态管理，Flink 可以在大规模数据流上实现高吞吐量和低延迟的实时处理。同时，Flink 的分布式事务和多版本一致性支持，使其能够满足严格的可靠性要求。

Flink 的核心技术包括分布式计算引擎、有状态状态管理、流状态处理、分布式事务处理等。其中，有状态状态管理和流状态处理是 Flink 实现高性能、强一致性的关键。

## 2. 核心概念与联系

### 2.1 核心概念概述

为更好地理解 Flink 的工作原理和实现方式，本节将介绍几个关键概念：

- **分布式计算**：Flink 基于分布式计算架构，能够在大规模数据集上实现高效的并行计算。
- **有状态状态管理**：Flink 通过有状态的状态管理机制，确保流处理任务的一致性和可靠性。
- **流状态处理**：Flink 支持流数据的连续处理，利用流状态处理技术，实现高效的数据更新和维护。
- **分布式事务处理**：Flink 通过分布式事务处理技术，确保多节点上的操作原子性和一致性。

这些概念之间的联系可以通过以下 Mermaid 流程图来展示：

```mermaid
graph LR
    A[分布式计算] --> B[有状态状态管理]
    A --> C[流状态处理]
    B --> D[分布式事务处理]
```

这个流程图展示了 Flink 各个核心组件之间的关系：

1. 分布式计算是 Flink 的基础架构，负责并行计算和数据分发。
2. 有状态状态管理确保了流处理任务的一致性和可靠性。
3. 流状态处理在分布式计算基础上，实现数据的持续更新和维护。
4. 分布式事务处理确保了跨节点的原子性和一致性。

这些核心概念共同构成了 Flink 的高性能、强一致性等特性，使其在实时数据处理领域具有显著优势。

## 3. 核心算法原理 & 具体操作步骤

### 3.1 算法原理概述

Flink 的核心算法原理主要包括：

- **分布式计算框架**：基于数据流图模型，Flink 可以将复杂的数据处理任务拆分成多个小任务，并通过分布式计算实现并行处理。
- **有状态状态管理**：Flink 通过有状态的状态管理机制，维护流处理任务的状态信息，确保任务的一致性和可靠性。
- **流状态处理**：Flink 利用流状态处理技术，实现数据的持续更新和维护，支持高效的窗口操作和流计算。
- **分布式事务处理**：Flink 通过分布式事务处理技术，实现跨节点操作的原子性和一致性，支持事务处理和事务查询。

### 3.2 算法步骤详解

Flink 的分布式计算框架主要包括数据流图的构建、任务拆分和并行计算等步骤：

1. **构建数据流图**：用户需要根据实际数据处理需求，设计数据流图，描述数据流的转换和计算过程。
2. **任务拆分**：Flink 将数据流图转换成可执行的任务图，将大任务拆分成多个小任务，并分配到不同的节点上执行。
3. **并行计算**：每个小任务可以在不同的节点上并行执行，实现高效的数据处理。

有状态状态管理是 Flink 实现高性能和强一致性的关键，主要包括：

1. **状态管理策略**：Flink 提供了多种状态管理策略，如有状态、无状态和分布式状态等。
2. **状态分区和备份**：Flink 将状态信息分区存储，并提供状态备份机制，确保状态的一致性和可靠性。
3. **状态恢复和更新**：Flink 支持状态恢复和更新，实现流处理任务的连续性和持久性。

流状态处理是 Flink 的核心技术之一，主要包括：

1. **流状态的表示和更新**：Flink 利用流状态处理技术，实现流数据的连续处理和更新。
2. **窗口操作**：Flink 支持多种窗口操作，如滑动窗口、肿瘤窗口等，实现高效的数据聚合和计算。
3. **水平方向和垂直方向的状态管理**：Flink 通过水平方向和垂直方向的状态管理，实现高效的状态恢复和更新。

分布式事务处理是 Flink 实现强一致性和跨节点操作原子性的关键，主要包括：

1. **分布式事务处理框架**：Flink 提供分布式事务处理框架，支持跨节点操作的原子性和一致性。
2. **事务管理**：Flink 提供事务管理机制，确保事务的原子性和一致性。
3. **事务查询**：Flink 支持事务查询，实现跨节点操作的一致性。

### 3.3 算法优缺点

Flink 的优点包括：

- **高性能**：Flink 利用分布式计算架构，实现高效的并行计算和数据分发。
- **低延迟**：Flink 支持流数据的连续处理，实现低延迟的数据处理。
- **强一致性**：Flink 通过有状态的状态管理机制，确保流处理任务的一致性和可靠性。
- **灵活性**：Flink 支持多种数据处理方式，包括流处理、批量处理和批流混合处理。

Flink 的缺点包括：

- **复杂性**：Flink 需要复杂的状态管理和分布式计算架构，开发和调试相对复杂。
- **资源消耗高**：Flink 的分布式计算架构需要较多的计算资源和网络带宽，资源消耗较高。
- **状态管理开销大**：Flink 的有状态状态管理机制需要较大的存储和计算开销，可能影响性能。

## 4. 数学模型和公式 & 详细讲解 & 举例说明

### 4.1 数学模型构建

Flink 的核心数学模型包括分布式计算模型、有状态状态管理模型和流状态处理模型等。

**分布式计算模型**：
- 数据流图模型：描述数据流的转换和计算过程，支持并行计算。
- 任务图模型：将数据流图转换成可执行的任务图，支持任务拆分和并行计算。

**有状态状态管理模型**：
- 状态分区模型：将状态信息分区存储，支持分布式状态管理。
- 状态备份模型：提供状态备份机制，确保状态的一致性和可靠性。

**流状态处理模型**：
- 流状态表示模型：描述流状态的表示方式，支持高效的流状态处理。
- 窗口操作模型：支持多种窗口操作，实现高效的数据聚合和计算。

### 4.2 公式推导过程

以窗口操作为例，推导 Flink 窗口操作的数学模型。

设数据流 $D$ 包含 $n$ 个元素，每个元素表示为一个元组 $(e,t)$，其中 $e$ 为元素值，$t$ 为元素时间戳。定义滑动窗口为 $W$，其窗口大小为 $\Delta T$，滑动步长为 $\delta T$。

窗口操作的目标是计算窗口 $W$ 内的元素聚合结果。Flink 的滑动窗口操作可以分为两个阶段：

1. **窗口分区阶段**：将数据流 $D$ 根据时间戳 $t$ 分区，每个分区对应一个滑动窗口 $W$。
2. **窗口聚合阶段**：对每个滑动窗口 $W$ 内的元素进行聚合计算，得到窗口结果。

假设窗口操作为 $\text{reduce}$ 函数，其定义如下：

$$
\text{reduce}(\{e_1,e_2,\ldots,e_k\}) = \text{agg}_1(e_1,e_2,\ldots,e_k) \oplus \text{agg}_2(e_1,e_2,\ldots,e_k)
$$

其中 $\text{agg}_1$ 和 $\text{agg}_2$ 为聚合函数。

窗口操作的数学模型为：

$$
\text{window}(D,\Delta T,\delta T,\text{reduce}) = \bigcup_{i=1}^n \text{reduce}(\{e_j | t_j \in W\})
$$

其中 $W = [t_i, t_i + \Delta T]$ 为窗口区间，$t_i$ 为窗口起始时间戳，$\oplus$ 为聚合函数。

### 4.3 案例分析与讲解

以 Flink 的流状态处理为例，展示流状态处理的基本原理。

假设有一个简单的计数器任务，需要统计数据流中每个元素出现的次数。Flink 的流状态处理可以通过一个计数器状态来实现：

1. **状态初始化**：将计数器状态初始化为 0。
2. **元素处理**：对每个元素 $e$，更新计数器状态 $s$：
   $$
   s \leftarrow s + 1
   $$
3. **状态输出**：输出计数器状态 $s$ 的值。

Flink 的流状态处理可以通过有状态的状态管理机制来实现，具体步骤如下：

1. **状态分区**：将状态 $s$ 分区存储，确保状态的一致性和可靠性。
2. **状态更新**：对每个元素 $e$，更新计数器状态 $s$：
   $$
   s \leftarrow s + 1
   $$
3. **状态恢复**：在任务重启时，从状态存储中恢复计数器状态 $s$ 的值。
4. **状态同步**：在状态分区之间的同步，确保状态的一致性和可靠性。

通过 Flink 的流状态处理，可以实现高效的流计数器和统计分析等应用。

## 5. 项目实践：代码实例和详细解释说明

### 5.1 开发环境搭建

在进行 Flink 项目开发前，需要准备好开发环境。以下是使用 Python 进行 Flink 开发的环境配置流程：

1. 安装 Java 和 Scala：
   ```bash
   sudo apt-get update
   sudo apt-get install openjdk-11-jdk
   sudo apt-get install openjdk-11-jre-headless
   ```

2. 安装 Flink：
   ```bash
   wget https://repo1.maven.org/maven2/org/apache/flink/flink/flink-assembly/flink-assembly-1.15.1.jar
   ```

3. 安装 IDE：
   推荐使用 IntelliJ IDEA，支持 Flink 项目开发和调试。

完成上述步骤后，即可在 IntelliJ IDEA 中开始 Flink 项目开发。

### 5.2 源代码详细实现

这里以 Flink 的流计数器为例，展示 Flink 的流状态处理。

1. 定义流计数器类：
   ```java
   import org.apache.flink.streaming.api.functions.source.SourceFunction;
   import org.apache.flink.streaming.api.datastream.DataStream;
   import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;

   public class Counter {
       public static void main(String[] args) throws Exception {
           // 创建执行环境
           StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();

           // 定义数据源
           DataStream<String> source = env.addSource(new SourceFunction<String>() {
               @Override
               public void run(SourceContext<String> ctx) throws Exception {
                   for (int i = 0; i < 100; i++) {
                       ctx.collect("Hello World");
                   }
               }

               @Override
               public void cancel() {
               }
           });

           // 定义计数器状态
           ValueState<Tuple2<Long, Long>> countState = source.keyBy("").map(new Function<String, Tuple2<Long, Long>>() {
               @Override
               public Tuple2<Long, Long> apply(String value) throws Exception {
                   ValueStateDescriptor<Tuple2<Long, Long>> countDescriptor = new ValueStateDescriptor<>("count", new Tuple2<Long, Long>());
                   return new Tuple2<Long, Long>(stateManager.getOperatorStateHandle(countDescriptor), new Tuple2<Long, Long>(0, 0));
               }
           }).addState(countState);

           // 输出计数器状态
           countState.map(new Function<Tuple2<Long, Long>, Long>() {
               @Override
               public Long apply(Tuple2<Long, Long> value) throws Exception {
                   return value.f1;
               }
           }).addSink(new PrintFunction());

           // 执行任务
           env.execute("Flink Counter");
       }
   }
   ```

2. 运行 Flink 任务：
   ```bash
   bin/flink run Counter.jar
   ```

3. 查看输出结果：
   ```bash
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1
   1

