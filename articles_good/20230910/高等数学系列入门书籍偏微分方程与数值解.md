
作者：禅与计算机程序设计艺术                    

# 1.简介
  

偏微分方程（Partial Differential Equations，PDEs）是科学、工程和经济领域中非常重要的问题。在现代数学和物理学中，偏微分方程的研究已经成为一个重要方向。本文将围绕偏微分方程这一重要主题，介绍本系列《高等数学》的入门书籍，并通过作者在学习本书时自己的经历，向读者阐述偏微分方程与数值解的关键关系。

# 2.相关知识点
- 概念与术语：偏微分方程，微分方程，分界曲线，流函数，分裂域，区域边界条件，系数矩阵，特征向量，Helmholtz公式，积分形式，泰勒公式，松弛法，精确解，线性迭代法，数值法。
- 技术点：离散元数学、FEM方法、PDE求解、收敛稳定性、初始条件、边界条件、正则方程。

# 3.偏微分方程
## 3.1 概念
偏微分方程是指由变量之间的相互作用而导出的方程，一般情况下，这些方程表明了空间或时间的各个点上，变量之间的相互关系。
对偏微分方程进行数值分析，也就是用计算机来模拟系统演化过程，从而给出未知量在任意一给定时间的取值，称之为数值解，也被称为偏微分方程的数值解。
### 3.1.1 微分方程组
偏微分方程往往不是简单的单个方程，而是由多个方程组合而成的方程组。其中，最主要的有两类：偏微分方程、常微分方程。

#### （1）偏微分方程
以变量位置的变化为自变量，其他变量的变化率作为因变量的方程叫做偏微分方程。对于涉及多个变量的系统，一般采用边界值问题的形式，就是要求对某些特殊的边界处，变量的值已知，其他地方的变量的变化情况未知，利用偏微分方程进行求解。例如，在气象学中应用到有关于地面温度场的湿度方程。

#### （2）常微分方程
变量的变化率可以看作是一个时间的函数，所以一般来说，微分方程由一组同样类型的方程组成。对于以时间为自变量的系统，如果有初始条件和边界条件，那么可以得到其常微分方程。常微分方程中的参数化坐标的选择对其数值解的计算有着至关重要的作用。常微分方程中的时间通常是连续的，没有间断的跳跃，因此常微分方程组可以直接通过一阶近似进行求解。

## 3.2 分界曲线
偏微分方程的求解过程一般都涉及到了分界曲线，即偏微分方程所解决的问题区域内的一个曲面形状，其在坐标上任意一条曲线均可作为分界曲线。在实际问题中，由于偏微分方程的复杂程度和分界曲面的不规则性，往往难以直接获得该曲面的表达式。但是，可以通过一些数值方法或者抽象的方式，把求解的结果映射到分界曲线上去。

### 3.2.1 运动方程组
考虑一个二维的流体，其速度为$u(x,y,t)$。可以定义其切矢量为$\vec{v} = (u_x, u_y)$，向外加速的矢量为$a(x,y,t)$，即$-\nabla p+a(x,y,t)=\rho(x,y) \vec{v}$。此外还存在对流层界面上的压力分布$\sigma(x,y,z,t)$。

满足以上条件的方程组就可以作为偏微分方程。在偏微分方程中，$\vec{v}(x,y,t)$表示流体的速度，$\nabla$表示空间的梯度，$\rho$表示密度。满足这个方程组的分界曲线可能是一个位移分量为$p(x,y,t)$，速度为$u(x,y,t)$的过流层。

### 3.2.2 热传导方程组
在有限的空间中，考虑一个长度为$L$，宽度为$W$的矩形间的空气中，热分布。假设外壁的高度为$H$，壁的厚度为$\delta$，壁两侧有分别为$Q_{in}, Q_{out}$的热源。边界条件是：

1. 壁两端处：无对流；
2. 壁顶上：外壁两侧热源加起来等于壁顶上的热流；
3. 壁间：壁两侧的对流平衡；
4. 边界态热：约束条件，壁两侧热流加起来等于边界态热。

这样的一个偏微分方程组可以描述两个相邻壁之间的热流交换。在极限条件下，方程组可以用来描述边界态热的分布，亦即分布于边界处的热流。

### 3.2.3 分裂域
对于具有扩散性质的系统，如海洋、气泡、沼泽等，一般会把系统分裂为若干个子区域，每个子区域由单独的边界条件受到不同环境条件的影响。这就需要知道各个子区域的边界以及各区域之间的连接关系。

对于分裂区域的边界条件，要正确定义，有助于提高数值解的准确度和精度。除了可以刻画空气、水、油气流体的扩散性质之外，还有其它一些属性值，如电场、磁场等，它们都可以作为边界条件参与方程的求解。

## 3.3 流函数与分裂域
对于偏微分方程，除了可以在特定区域内进行研究外，还可以分析其运动或热传导的路径。为了说明其路径，可以采用流函数。流函数的定义是：任一一点$(x, y, z)$处的流函数可以定义为：

$$
    \psi(x, y, t) = \int_{\Omega} v(x', y', z') \psi(x', y', z', t)\mathrm{d} x' \mathrm{d} y' \mathrm{d} z',
$$

其中$\Omega$是分界曲线，$v(x', y', z')$是某一给定的速度场。根据流体动力学，流函数可以唯一确定流体的动量场：

$$
    m(x, y, z, t) = \frac{\partial}{\partial t}\psi(x, y, z),\\
    n(x, y, z, t) = \frac{\partial}{\partial t}\psi(x, y, z).
$$

流函数随时间的变化可以看作是某个曲面上的随机游走，而随机游走的结果可能会呈现不同的流形。对于具有扩散性质的系统，流函数会反映出不同区域之间流动的差异。

### 3.3.1 热流函数与扩散性
对于具有扩散性质的系统，热流函数可以用来反映出热传递的路径。设$B(\phi)$表示某个受力面积，则：

$$
    q(x, y, z, t) = -\frac{1}{B}\int_{\partial B} \sigma(x, y, z, s) n(s, y, z, t)ds + Q(x, y, z, t), \\
$$

其中$\sigma(x, y, z, s)$表示位于切向量$\vec{n} = (\cos \theta,\sin \theta,0)$和点$s$处的压力。$Q(x, y, z, t)$表示边界条件下的热流。对于二维的正方形分界曲面，热流函数可以表示为：

$$
    q(r, t) = \frac{K}{\sqrt{r^2+\alpha^2}}\cos\left(\frac{nt}{2R}\right),
$$

其中$K$是感应强度，$\alpha$是刚度，$R$是等效半径，$n$是圆周率，$t$是时间。当$\alpha=k/\mu$，其中$k$是核能，$\mu$是介电常数时，热流函数就会变为泊松方程：

$$
    q(r, t) = K e^{-\lambda r},
$$

其中$\lambda$是温度依赖的扩散系数。

### 3.3.2 分裂域流函数
如果一个系统通过特定的分裂域，比如，粒子在轴向的流体静止，它就可以对应到分裂域流函数的形式。流函数$\psi(x,y,z)$可以分解为许多子流函数的乘积形式，每个子流函数对应于一个分裂域。

举个例子，对于二维的偏微分方程，可以将其分解为上下两个分界区域，每个分界区域对应的子流函数可以表示为：

$$
    \psi(x,y,z;i) = U_i(x,y,z)(\mathrm{e}^{\gamma i}-1)^{-1},
$$

其中$U_i(x,y,z)$是区域$i$上的速度场，$\gamma$是帽克系数，帽克系数可以认为是流函数相对于速度场的系数，它依赖于平均粒子的大小。这样，可以将在上游区域的相对位置映射到在下游区域的相对位置，而不用考虑粒子实际所在的位置。

# 4.数值解
## 4.1 离散元法
对于具有扩散性质的偏微分方程，利用数值解的关键之一就是利用数值方法求解。现实世界的很多问题都不能直接采用解析解，只能通过数值方法获得解的近似解。离散元法是一种基于网格的方法，能够有效地处理偏微分方程。

### 4.1.1 FEM方法
对于二维的偏微分方程，FEM方法（Finite Element Method，简称FEM）是一个典型的离散元法。FEM利用离散的几何信息，在网格上精心构造元素，然后在每个单元上求解局部的方程组。FEM方法既可以用于求解流体动力学问题，也可以用于求解热传导问题。

对于FEM方法，首先要将偏微分方程的方程组表示为局部变量的形式。首先，把空间的坐标表示为$(x_i,y_j,z_k)$，将时间表示为$t$，把参数化变量表示为$r=\sqrt{(x-xc)^2+(y-yc)^2}$, $s=(z-zc)/h$, $h$是元素高度。FEM方法要求所有变量都是连续的，所以一般情况下，只能选取局部的一小部分变量来近似表示完整变量。

例如，二维流体动力学问题的局部变量表示可以选择速度场$u(x,y)$和密度$c(x,y)$，分别表示为$u_{ij}=u(x_i,y_j)$,$c_{ij}=c(x_i,y_j)$。这样，方程组可以写成：

$$
  \begin{cases}
    \frac{\partial c}{\partial t} + u\cdot\nabla c = -\frac{\partial}{\partial x} P(x,y,t)+\nu\Delta c -f(x,y,t)\\
    \nabla\cdot u=0,
  \end{cases}
$$

这里，$u$表示速度场，$c$表示密度场，$f(x,y,t)$表示源项，$\nu$表示粘度系数。

对于二维热传导问题，FEM方法将空间和时间的连续变量离散化，并且以相同的方式构造局部变量，方程组可以写成：

$$
  \begin{cases}
    \frac{\partial q}{\partial t}=-D_kq(x,y,z)-\sigma(x,y,z),\\
    \frac{\partial q}{\partial n}=0,
  \end{cases}
$$

这里，$q(x,y,z)$表示热流场，$D_k$表示温度依赖的扩散系数。

### 4.1.2 一维、二维和三维的数值模拟
对于一维和二维的偏微分方程，可以采用积分形式的数值方法来求解。积分形式的数值方法简单易懂，但往往计算代价较大。

对于三维的偏微分方程，可以采用FEM方法来求解。FEM方法是数值模拟中最快的算法之一，尤其适用于复杂的系统，而且能够在无限大计算范围内保证精确性。

## 4.2 初值问题
对于偏微分方程的求解，有两种基本的方法：一是初值问题，另一种是边值问题。对于偏微分方程，一般都可以找到一个初值，使得方程的解在初值的附近逼近收敛。当初值足够接近边界条件时，得到的数值解一定是收敛的。对于一维、二维的偏微分方程，初值问题可以用一阶、二阶龙格库塔法来求解。对于三维的偏微分方程，一般采用FEM方法。

### 4.2.1 一阶龙格库塔法
对于一维的偏微分方程，一阶龙格库塔法（Forward Euler method，简称FE）的数值方法如下：

$$
   u_{i}^{n+1} = u_{i}^n + h f(u_{i}^n), \\
   u_{i-1}^{n+1} = u_{i-1}^n + h f(u_{i-1}^n), \\
   \cdots \\
   u_{2}^{n+1} = u_{2}^n + h f(u_{2}^n), \\
   u_{1}^{n+1} = u_{1}^n + h f(u_{1}^n), \\
   u_i^{n+1} = u_i^n + 2h f(u_i^n). 
$$

此处，$u_{i}^n$表示第$i$个节点处的时间步$n$时的解，$h$表示时间步长。在应用一阶龙格库塔法之前，需要设置好数值问题的初始条件，以及终止时间和步长。一阶龙格库塔法用一个相邻结点间隔的离散步长来积分时间，它是最简单的离散时间步法。

类似地，对于二维的偏微分方程，可以使用二阶龙格库塔法：

$$
   u_{ij}^{n+1} = u_{ij}^n + \frac{h^2}{2} [f(u_{ij}^n)+f(u_{i+1,j}^n)+f(u_{i-1,j}^n)+f(u_{ij-1}^n)], \\
   u_{i-1,j}^{n+1} = u_{i-1,j}^n + \frac{h^2}{2} [f(u_{i-1,j}^n)+f(u_{i,j}^n)+f(u_{i-1,j-1}^n)+f(u_{i-1,j+1}^n)], \\
   \cdots \\
   u_{2,j}^{n+1} = u_{2,j}^n + \frac{h^2}{2} [f(u_{2,j}^n)+f(u_{3,j}^n)+f(u_{2,j-1}^n)+f(u_{2,j+1}^n)], \\
   u_{1,j}^{n+1} = u_{1,j}^n + \frac{h^2}{2} [f(u_{1,j}^n)+f(u_{2,j}^n)+f(u_{1,j-1}^n)+f(u_{1,j+1}^n)]. 
$$

对于三维的偏微分方程，可以直接采用FEM方法。

### 4.2.2 边值问题的数值解
边值问题是指已知任一一点$x$处的取值，求解方程$Au=b$的解，$A$为系数矩阵，$b$为右端常数。对于偏微分方程，边值问题通常比起初值问题更容易求解。边值问题可以根据问题的不同，采用各种有限元方法，包括误差控制法、方程投影法、截断格林公式法等。

#### （1）误差控制法
误差控制法（Error Control Method）是指采用一些附加的约束条件，使得方程的解更加准确。对于一维偏微分方程，可以考虑采用边界值定理：

$$
    |u(x)| \leq C,
$$

其中，$C$表示边界值。对于二维偏微分方程，还可以考虑添加额外的约束条件，比如，拉普拉斯方程：

$$
    |\nabla u| \leq C,
$$

这样，可以对边界处的解进行一些修正。

#### （2）方程投影法
方程投影法（Equation Projection Method）也是采用一些附加约束条件，并试图使得方程的解的近似误差在允许的范围内。对于一维偏微分方程，方程投影法可以采用积分形式的方程求解法，这种方法可以将一维问题转化为一维线性方程组，可以用一些标准的线性求解器求解。

对于二维偏微分方程，方程投影法可以利用离散元方法，先对热传导问题进行离散化，再利用正交基对边界单元进行求解。

#### （3）截断格林公式法
截断格林公式法（Truncation Galerkin Method）是指利用截断式（truncation scheme），在离散化后的问题中保留部分高阶多项式。对于一维偏微分方程，截断格林公式法可以先对一维问题进行离散化，然后将逐渐放大的系数集中到几个点上去。对于二维偏微分方程，截断格林公式法也可以按照离散元方法来实现，只是将系数集中到单元上。

截断格林公式法的缺陷是引入高阶多项式导致数值误差的增大，因此可以增加截断的次数，也可以使用更复杂的正交基。