
作者：禅与计算机程序设计艺术                    

# 1.简介
  

什么是“依赖倒置”？它和IoC又有什么关系呢？“抽象工厂”又是什么意思？它们之间有什么联系？为什么要用它们？这些都是需要阐述的。本文将分别对“依赖倒置”、“控制反转”（也称为“依赖注入”）、“抽象工厂”三者进行阐述，并进而探讨这些概念之间的关联和联系，并结合具体代码实例加以说明。最后，还会指出“抽象工actory”在实际工程应用中的作用，并着重介绍一些优缺点，最后给出未来可能出现的挑战。

## 2.相关名词
- “依赖倒置”（DIP): Dependency Inversion Principle
- “控制反转”或“依赖注入”（IoC): Inversion of Control or Dependency Injection
- “抽象工厂”: Abstract factory design pattern

# 2.相关概念及术语
“依赖倒置”、“控制反转”和“抽象工厂”三个概念是密切相关的。因此，本节首先简要介绍相关概念和术语。

## 2.1.“依赖倒置”原则（Dependency Inversion Principle, DIP）
“依赖倒置”原则（DIP）是面向对象编程领域中著名的原则之一。DIP认为高层模块不应该依赖于低层模块，二者都应该依赖于抽象。换句话说，要实现“依赖倒置”，系统的每一个功能都应该通过接口或者抽象类来定义，而不是依赖于具体的实现。这样一来，当我们需要替换底层模块的时候，只需替换掉接口或者抽象类的实现即可，而无须影响上层模块。其主要含义就是通过“抽象”的方式，实现“多态”和“开闭”。

DIP 可以分为以下几点内容：

1. 抽象：某个东西应该是抽象的，意味着它的具体实现应该是隐藏的或者交给其他东西去处理。例如，一个函数可以接受一个参数，这个参数类型可以是一个抽象基类或者接口。

2. 依赖：高层模块不应该直接依赖于低层模块，二者都应该依赖于抽象。换句话说，不要强行让某些东西依赖于另一些东西。

3. 接口隔离：客户端不应该依赖于那些它不需要的接口，它只应该依赖于所需的接口。

4. 迪米特法则：如果两个模块不必彼此通信，那么这两个模块就不应当发生直接的相互作用。也就是说，降低耦合度。

5. 单一职责：每个类都只负责完成一个逻辑上的事情。

## 2.2.“控制反转”（Inversion Of Control, IoC）
“控制反转”（IoC），英文翻译为“控制倒转”，是一种常用的设计模式，用于减轻计算机代码之间的耦合度，并提供更多的可测试性。该模式通过“第三方”来促进松耦合，从而实现了代码的可复用性和可维护性。

如同其名称所表达的一样，IoC 是一种设计原则，它提倡在许多层次上将对象配置与实现代码解耦，而不是将对象直接配置到代码中。IoC 的理念基于“控制反转”原则，即要实现松耦合，我们可以通过引入“第三方”组件来实现对象之间的依赖关系。

使用“控制反转”的好处主要有以下几点：

1. 可测试性：IoC 有助于实现单元测试，因为它允许我们创建易于被测试的对象，并且使得单元测试更容易编写。

2. 模块化开发：IoC 可以有效地实现模块化开发，使得应用由小型的组件组成，而这些组件可以独立于其他组件进行开发、测试和部署。

3. 可移植性：IoC 可以使应用更加容易移植到其他环境，比如从开发环境切换到生产环境时，只需要修改配置文件即可。

## 2.3.“抽象工厂”模式
“抽象工厂”（Abstract Factory）模式提供了一种方式，可以生成一系列相关或相互依赖对象的集合，但这些对象却不知道它们所属的具体类。抽象工厂模式是面向对象设计模式的一种，可以为应用程序创建一个接口，而子类可以创建一系列相关或相互依赖的对象。

抽象工厂模式的目的是提供一个接口，用来创建一系列相关或相互依赖的对象。抽象工厂模式的结构包括一个工厂接口，它能够产生一系列产品，而一个具体的工厂实现能够产生一个具体的产品。多个抽象工厂可以实现同样的接口，不同的抽象工厂生产的产品可能不同。

## 2.4.“工厂方法”模式
“工厂方法”（Factory Method）是最简单也是最经典的设计模式之一，这种模式用于创建对象。这种模式为创建对象提供了一种模板，这个模板封装了创建过程，但却没有对外暴露任何创建对象的细节。

“工厂方法”模式中，抽象类负责声明一个用于创建对象的接口，而子类则负责具体实现。利用抽象类和子类，我们可以灵活地创建不同类型的对象，同时避免了创建对象过程中的硬编码。

“工厂方法”模式的优点如下：

1. 将对象创建与具体实现分离：由于工厂方法模式把创建对象的任务委托给子类，所以，我们可以在运行时动态选择创建哪种对象。

2. 提供了良好的扩展能力：在增加新产品时，只需添加新的具体子类就可以了，已有的代码无须改变，符合“开闭”原则。

3. 屏蔽复杂的对象创建过程：用户只需关心如何得到想要的对象，而不必知道其创建的过程。

# 3.“依赖倒置”原则和“控制反转”实现方式
## 3.1.依赖倒置
正如前面所说，“依赖倒置”原则表明高层模块不应该依赖于低层模块，二者都应该依赖于抽象。在“依赖倒置”原则的约束下，我们通常采用两种方法实现“依赖倒置”：
1. 通过接口（Interface）解耦。在这种情况下，高层模块依赖于低层模块的抽象（接口），而不是具体实现。例如，对于支付系统来说，不再直接依赖于数据库实现，而是依赖于一个接口——IPayService。
2. 通过抽象工厂模式（Abstract Factory Pattern）解耦。在这种情况下，低层模块仍然依赖于具体实现，但是通过抽象工厂模式，高层模块不需要关注底层模块的具体实现。例如，对于支付系统来说，不再直接调用具体的微信支付、支付宝支付等SDK，而是统一通过一个接口IPayService调用，底层模块通过配置实现。

下面看一下“依赖倒置”的例子：

假设有一个需求：我们希望统计某个网站的所有访问量。但是目前该网站有很多页面，比如首页、搜索页、购物车页等，每天都会有成千上万的访问请求，如果每次统计访问量都要重复编写代码，势必要降低效率。

为了解决这个问题，我们可以采用“抽象工厂模式+代理模式”：

1. 创建一个名叫IPageViewService的接口。这个接口定义了记录页面访问量的方法viewPage。
2. 创建一个名叫PageViewServiceFactory的抽象工厂类，这个抽象工厂类用于创建IPageViewService的实现对象。
3. 在PageViewServiceFactory的实现类WebSitePageViewServiceFactory中，创建各种具体实现类的对象（比如WebHomePageViewServiceImpl、WebSearchPageViewServiceImpl等）。
4. 在WebSitePageViewServiceFactory的viewPage方法中，通过调用IPageViewService的viewPage方法记录页面访问量。
5. 用户只需调用WebSitePageViewServiceFactory的viewPage方法即可统计所有网站页面访问量。

这样做的好处是，我们不需要关心具体的页面访问实现细节，只需要调用一个统一的方法，就可以记录所有网站页面的访问量。

## 3.2.控制反转
“控制反转”（IoC），英文翻译为“控制倒转”，是一种常用的设计模式，用于减轻计算机代码之间的耦合度，并提供更多的可测试性。该模式通过“第三方”来促进松耦合，从而实现了代码的可复用性和可维护性。

“控制反转”的实质是依赖倒置原则，即高层模块不应该依赖于低层模块，二者都应该依赖于抽象。在传统的开发模式中，我们是由底层模块依赖于高层模块，低层模块调用高层模块的接口或方法，实现低层模块的功能。在“控制反转”模式下，我们由低层模块依赖于高层模块，高层模块决定底层模块的具体实现，调用底层模块的接口或方法。这样一来，我们可以在运行时动态地决定底层模块的具体实现，从而达到代码的可测试性和可维护性。

下面看一下“控制反转”的例子：

假设有这样一个需求：需要一个后台系统，用于管理文件上传。当前系统的功能有上传、下载、删除、查看等。现在需要将上传功能集成到网页端，要求当用户点击“上传”按钮时，需要自动执行上传动作。

传统的开发模式中，我们可以这样实现：

1. 我们创建了一个名叫IUploadService的接口，用于定义上传文件的接口。
2. 我们创建了一个名叫UploadController的控制器类，这个类用来接收用户的上传请求，并调用IUploadService的upload方法实现文件上传。
3. 我们创建了一个名叫FileUploadService的实现类，这个类用于实现IUploadService接口。

现在的问题是，文件上传需要使用FTP协议传输，因此，我们需要创建FtpUploadService的实现类，继承自IUploadService。然后，我们需要修改控制器类，修改其upload方法，改为调用FtpUploadService的upload方法。这样做的话，就会造成代码耦合性很高，如果有其他地方需要用到文件上传功能，那么都需要修改控制器类。

“控制反转”模式可以这样实现：

1. 我们创建了一个名叫IUploadManagerFactory的接口，用于定义文件上传服务工厂的接口，这个工厂类用于创建IUploadService的实现对象。
2. 我们创建了一个名叫UploadManagerFactory的实现类，这个类实现了IUploadManagerFactory接口，并定义了创建FtpUploadService的逻辑。
3. 我们创建了一个名叫UploadController的控制器类，这个类用来接收用户的上传请求，并调用IUploadManagerFactory的createUploadManager方法创建IUploadService的实现对象，并调用其upload方法实现文件上传。

这样一来，文件上传功能的具体实现被推迟到了工厂类中，而且，上传服务的实现是可以动态切换的，不会影响到其他模块。这样，我们就可以灵活地实现文件上传功能，并且代码的耦合度很低，其他地方也可以方便地使用文件上传功能。

# 4.“抽象工厂”模式
## 4.1.概述
“抽象工厂”模式，也叫作Kit模式，是面向对象设计模式的一种，可以为应用程序创建一个接口，而子类可以创建一系列相关或相互依赖的对象。在这种模式里，工厂方法模式和抽象工厂模式是两个非常重要的角色，具体工作流程如下：

1. 创建一个接口。这步是关键，我们先创建一个接口（IFactory），这个接口用于描述工厂的行为，它要求返回一个产品。
2. 创建一个抽象类（SuperFactory），这个抽象类实现了IFactory接口，并提供了一个createProductA()和createProductB()方法，用于创建产品。
3. 创建子类（SubFactory_1、SubFactory_2...），这些子类继承了SuperFactory，并重写了父类的方法。这些子类用于创建不同种类的产品。
4. 当客户需要一个产品时，他应该根据需求去调用相应的子类，并调用其createProductA()或者createProductB()方法。

这样做的好处是，通过抽象工厂模式，我们可以创建一系列相关的产品，而且，他们具有共同的接口。这样，当我们需要一个产品时，我们就不用担心它具体是哪个子类提供的。

## 4.2.“抽象工厂”模式的优点和缺点
“抽象工厂”模式的优点如下：

1. 隔离了抽象类和具体实现。由于抽象工厂模式采用的是工厂方法模式，因此，它将复杂对象的创建过程封装起来，并由子类负责实现。因此，客户端代码只能看到一个创建对象的抽象接口，而具体实现被隐藏起来。

2. 更加容易扩展。由于抽象工厂模式采用的是工厂方法模式，因此，它可以很容易地扩展产品族。新产品只需要按照接口约定来实现其具体类，并注册到工厂方法即可，而不需要修改源代码。

3. 支持多态性。由于抽象工厂模式采用的是工厂方法模式，因此，支持多态性，它允许不同类型的具体工厂对应不同类型的产品。

“抽象工厂”模式的缺点如下：

1. 增加了额外的工厂和产品类。虽然使用了抽象工厂模式，但依然存在一个问题，就是每个工厂都需要有一个对应的产品类，并且要保证工厂与产品类的一致性。因此，在项目中会存在大量的类。

2. 使用范围受限。虽然抽象工厂模式提供了一种创建复杂对象的途径，但它并不是所有的场景都适用。如果项目中只有一个产品族，那么建议优先考虑使用工厂方法模式。


# 5.实战实例：用“抽象工厂”模式实现QQ登录与微信登录
## 5.1.背景介绍
公司有多个APP版本，其中有一些版本需要支持QQ登录、微信登录等多种登录方式。一般来说，支持多种登录方式有以下两种方式：

1. 方案一：针对不同登录方式，创建不同的界面。比如有三个界面——登录界面、QQ登录界面、微信登录界面。不同界面之间的跳转和数据传递均由开发人员手动完成。这种方式过于繁琐，且容易出错。
2. 方案二：采用统一的登录界面，并通过动态加载不同的登录插件实现登录功能。这种方式比较靠谱，但开发难度较高，需要熟悉JavaScript、HTML、CSS等前端技术。

为了更好地实现方案二，公司决定采用“抽象工厂”模式来实现QQ登录与微信登录功能。

## 5.2.准备工作
为了实现“抽象工厂”模式，我们首先需要准备以下几个关键角色：

1. ILoginFactory接口。这个接口用于描述登录插件的创建行为，它要求返回一个IUserLogin接口的实例。
2. ISocialAccountLogin接口。这个接口用于描述QQ、微信等社交账号登录的行为，它包含login()方法，用于执行登录操作。
3. UserLoginFactory类。这个类用于创建ISocialAccountLogin接口的实例，具体的登录插件由子类实现。
4. LoginWindow类。这个类用于显示登录界面，并提供登录、注册、忘记密码等功能。
5. SocialAccountLoginFactory类。这个类用于创建ISocialAccountLogin接口的实例，并实现QQ登录功能。
6. WeiXinSocialAccountLoginFactory类。这个类用于创建ISocialAccountLogin接口的实例，并实现微信登录功能。

## 5.3.实现过程
下面，我们来详细看一下实现过程。

### （1）创建ILoginFactory接口
```java
public interface ILoginFactory {
    public IUserLogin createUserLogin();
}
```
ILoginFactory接口只包含一个方法，createSocialAccountLogin()，它用于创建ISocialAccountLogin接口的实例。

### （2）创建ISocialAccountLogin接口
```java
public interface ISocialAccountLogin extends IUserLogin {

    // 执行登录操作
    public void login(String account, String password);
}
```
ISocialAccountLogin接口继承自IUserLogin接口，它包含一个login()方法，用于执行登录操作。

### （3）创建UserLoginFactory类
```java
public class UserLoginFactory implements ILoginFactory{
    @Override
    public IUserLogin createUserLogin() {
        return new QQUserLogin();
    }
}
```
UserLoginFactory类实现了ILoginFactory接口，它返回一个QQUserLogin实例。

### （4）创建LoginWindow类
```java
import java.awt.*;
import javax.swing.*;

public class LoginWindow extends JFrame {
    
    private JLabel accountLabel;
    private JTextField accountTextField;
    private JLabel passwordLabel;
    private JPasswordField passwordTextField;
    private JButton loginButton;
    private JButton registerButton;
    private JButton forgetPasswordButton;
    
    public LoginWindow(){
        
        setTitle("登录");
        setSize(400, 300);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        
        JPanel panel = new JPanel();
        panel.setLayout(new FlowLayout());
        
        accountLabel = new JLabel("账户:");
        panel.add(accountLabel);
        accountTextField = new JTextField(10);
        panel.add(accountTextField);
        
        passwordLabel = new JLabel("密码:");
        panel.add(passwordLabel);
        passwordTextField = new JPasswordField(10);
        panel.add(passwordTextField);
        
        loginButton = new JButton("登录");
        panel.add(loginButton);
        loginButton.addActionListener(e -> {
            if (login()) {
                dispose();
            } else {
                JOptionPane.showMessageDialog(null, "用户名或密码错误！", "提示", JOptionPane.WARNING_MESSAGE);
            }
        });
        
        registerButton = new JButton("注册");
        panel.add(registerButton);
        registerButton.addActionListener(e -> {
            RegisterDialog dialog = new RegisterDialog(this, true);
            dialog.setVisible(true);
        });
        
        forgetPasswordButton = new JButton("忘记密码?");
        panel.add(forgetPasswordButton);
        forgetPasswordButton.addActionListener(e -> {
            ForgetPasswordDialog dialog = new ForgetPasswordDialog(this, true);
            dialog.setVisible(true);
        });
        
        add(panel);
        
    }
    
    /**
     * 登录操作
     */
    private boolean login() {
        String account = accountTextField.getText().trim();
        String password = passwordTextField.getText().trim();
        if ("admin".equals(account) && "123456".equals(password)) {
            return true;
        }
        return false;
    }
    
}
```
LoginWindow类用于显示登录界面的功能，并提供登录、注册、忘记密码等功能。

### （5）创建SocialAccountLoginFactory类
```java
import com.sun.org.apache.xpath.internal.operations.Bool;

public class SocialAccountLoginFactory implements ILoginFactory{
    private static final int QQ = 1;
    private static final int WECHAT = 2;

    @Override
    public IUserLogin createUserLogin() {
        Object obj = JOptionPane.showInputDialog(null, "请选择登录方式:", "登录", JOptionPane.INFORMATION_MESSAGE, null, 
                new String[] {"QQ登录", "微信登录"}, "QQ登录");
        switch ((Integer)obj){
            case QQ:
                return new QQUserLogin();
            case WECHAT:
                return new WeiXinUserLogin();
            default:
                throw new RuntimeException("暂不支持该登录方式!");
        }
    }
}
```
SocialAccountLoginFactory类实现了ILoginFactory接口，它通过JOptionPane弹出框，让用户选择登录方式。并返回相应的登录插件实例。

### （6）创建QQUserLogin类
```java
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

public class QQUserLogin implements ISocialAccountLogin {
    private Logger logger = LoggerFactory.getLogger(getClass());

    @Override
    public void login(String account, String password) {
        logger.info("qq登录成功! account={}, password={}", account, password);
    }
}
```
QQUserLogin类实现了ISocialAccountLogin接口，并实现了login()方法，用于执行QQ登录操作。

### （7）创建WeiXinUserLogin类
```java
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

public class WeiXinUserLogin implements ISocialAccountLogin {
    private Logger logger = LoggerFactory.getLogger(getClass());

    @Override
    public void login(String account, String password) {
        logger.info("微信登录成功! account={}, password={}", account, password);
    }
}
```
WeiXinUserLogin类实现了ISocialAccountLogin接口，并实现了login()方法，用于执行微信登录操作。

### （8）创建RegisterDialog类
```java
import java.awt.*;
import javax.swing.*;

public class RegisterDialog extends JDialog {
    
    private JLabel usernameLabel;
    private JTextField usernameTextField;
    private JLabel emailLabel;
    private JTextField emailTextField;
    private JLabel passwordLabel;
    private JPasswordField passwordTextField;
    private JButton confirmButton;
    
    public RegisterDialog(JFrame owner, boolean modal){
        super(owner, modal);
        initUI();
    }
    
    private void initUI(){
        this.setTitle("注册");
        this.setSize(400, 300);
        this.setDefaultCloseOperation(JDialog.DISPOSE_ON_CLOSE);

        Container container = getContentPane();
        GridBagLayout layout = new GridBagLayout();
        GridBagConstraints c = new GridBagConstraints();
        container.setLayout(layout);
        
        JLabel titleLabel = new JLabel("<html><h2>注册</h2></html>");
        c.gridx = 0;
        c.gridy = 0;
        c.weightx = 0.5;
        c.anchor = GridBagConstraints.WEST;
        container.add(titleLabel, c);
        
        JLabel nameLabel = new JLabel("用户名:");
        c.gridx = 0;
        c.gridy = 1;
        c.anchor = GridBagConstraints.EAST;
        container.add(nameLabel, c);
        usernameTextField = new JTextField(20);
        c.gridx = 1;
        c.gridy = 1;
        c.weightx = 0.5;
        c.anchor = GridBagConstraints.WEST;
        container.add(usernameTextField, c);
        
        JLabel emailLabel = new JLabel("邮箱:");
        c.gridx = 0;
        c.gridy = 2;
        c.anchor = GridBagConstraints.EAST;
        container.add(emailLabel, c);
        emailTextField = new JTextField(20);
        c.gridx = 1;
        c.gridy = 2;
        c.weightx = 0.5;
        c.anchor = GridBagConstraints.WEST;
        container.add(emailTextField, c);
        
        JLabel passwordLabel = new JLabel("密码:");
        c.gridx = 0;
        c.gridy = 3;
        c.anchor = GridBagConstraints.EAST;
        container.add(passwordLabel, c);
        passwordTextField = new JPasswordField(20);
        c.gridx = 1;
        c.gridy = 3;
        c.weightx = 0.5;
        c.anchor = GridBagConstraints.WEST;
        container.add(passwordTextField, c);
        
        confirmButton = new JButton("确认");
        c.gridx = 0;
        c.gridy = 4;
        c.gridwidth = 2;
        c.anchor = GridBagConstraints.CENTER;
        container.add(confirmButton, c);
        confirmButton.addActionListener(e -> dispose());
        
        pack();
        setLocationRelativeTo(getOwner());
    }

    public String getUsername() {
        return usernameTextField.getText().trim();
    }

    public String getEmail() {
        return emailTextField.getText().trim();
    }

    public char[] getPassword() {
        return passwordTextField.getPassword();
    }
    
}
```
RegisterDialog类用于显示注册窗口的功能。

### （9）创建ForgetPasswordDialog类
```java
import java.awt.*;
import javax.swing.*;

public class ForgetPasswordDialog extends JDialog {
    
    private JLabel usernameLabel;
    private JTextField usernameTextField;
    private JButton sendCodeButton;
    
    public ForgetPasswordDialog(JFrame owner, boolean modal){
        super(owner, modal);
        initUI();
    }
    
    private void initUI(){
        this.setTitle("找回密码");
        this.setSize(400, 150);
        this.setDefaultCloseOperation(JDialog.DISPOSE_ON_CLOSE);

        Container container = getContentPane();
        GridBagLayout layout = new GridBagLayout();
        GridBagConstraints c = new GridBagConstraints();
        container.setLayout(layout);
        
        JLabel titleLabel = new JLabel("<html><h2>找回密码</h2></html>");
        c.gridx = 0;
        c.gridy = 0;
        c.weightx = 0.5;
        c.anchor = GridBagConstraints.WEST;
        container.add(titleLabel, c);
        
        JLabel nameLabel = new JLabel("用户名:");
        c.gridx = 0;
        c.gridy = 1;
        c.anchor = GridBagConstraints.EAST;
        container.add(nameLabel, c);
        usernameTextField = new JTextField(20);
        c.gridx = 1;
        c.gridy = 1;
        c.weightx = 0.5;
        c.anchor = GridBagConstraints.WEST;
        container.add(usernameTextField, c);
        
        sendCodeButton = new JButton("发送验证码");
        c.gridx = 0;
        c.gridy = 2;
        c.gridwidth = 2;
        c.anchor = GridBagConstraints.CENTER;
        container.add(sendCodeButton, c);
        sendCodeButton.addActionListener(e -> {
            System.out.println("TODO: 发送验证码...");
        });
        
        pack();
        setLocationRelativeTo(getOwner());
    }

    public String getUsername() {
        return usernameTextField.getText().trim();
    }
    
}
```
ForgetPasswordDialog类用于显示忘记密码窗口的功能。

### （10）创建登录案例
```java
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import javax.swing.border.*;

public class LoginDemo extends JFrame {
    
    private JComboBox<String> loginTypeComboBox;
    private ButtonGroup buttonGroup;
    private JRadioButton qqRadioButton;
    private JRadioButton wechatRadioButton;
    private JButton loginButton;
    
    public LoginDemo(){
        initComponents();
        initEvent();
    }
    
    private void initComponents(){
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setBounds(400, 200, 400, 300);
        setTitle("登录案例");
        
        loginTypeComboBox = new JComboBox<>();
        loginTypeComboBox.addItem("社交账号登录");
        loginTypeComboBox.addItem("普通登录");
        
        buttonGroup = new ButtonGroup();
        qqRadioButton = new JRadioButton("QQ登录");
        buttonGroup.add(qqRadioButton);
        wechatRadioButton = new JRadioButton("微信登录");
        buttonGroup.add(wechatRadioButton);
        
        loginButton = new JButton("登录");
        
        GroupLayout layout = new GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        
        layout.setHorizontalGroup(
            layout.createParallelGroup(GroupLayout.Alignment.LEADING)
           .addGroup(layout.createSequentialGroup()
               .addGap(30)
               .addGroup(layout.createParallelGroup(GroupLayout.Alignment.TRAILING)
                   .addComponent(loginTypeComboBox, GroupLayout.PREFERRED_SIZE, 150, GroupLayout.PREFERRED_SIZE)
                   .addGroup(layout.createParallelGroup(GroupLayout.Alignment.LEADING)
                       .addComponent(qqRadioButton)
                       .addComponent(wechatRadioButton)))
               .addGap(30)
               .addComponent(loginButton)
               .addGap(30))
        );
        
        layout.setVerticalGroup(
            layout.createParallelGroup(GroupLayout.Alignment.LEADING)
           .addGroup(layout.createSequentialGroup()
               .addGap(30)
               .addComponent(loginTypeComboBox)
               .addGap(20)
               .addComponent(qqRadioButton)
               .addGap(10)
               .addComponent(wechatRadioButton)
               .addGap(50)
               .addComponent(loginButton)
               .addGap(30))
        );
    }
    
    private void initEvent(){
        ActionListener listener = e -> {
            if (e.getActionCommand().equals("登录")) {
                if (!buttonGroup.isSelected(qqRadioButton) &&!buttonGroup.isSelected(wechatRadioButton)){
                    JOptionPane.showMessageDialog(null, "请选择登录方式!", "警告", JOptionPane.WARNING_MESSAGE);
                    return ;
                }
                
                String type = loginTypeComboBox.getSelectedItem().toString();
                if ("社交账号登录".equals(type)) {
                    new SocialLoginDemo().setVisible(true);
                } else if ("普通登录".equals(type)) {
                    new NormalLoginDemo().setVisible(true);
                }
            } 
        };
        loginButton.addActionListener(listener);
    }
    
    public static void main(String[] args) {
        EventQueue.invokeLater(() -> {
            LoginDemo frame = new LoginDemo();
            frame.setVisible(true);
        });
    }

}
```
LoginDemo类用于演示登录的过程。

### （11）创建社交登录案例
```java
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class SocialLoginDemo extends JFrame {
    
    private JTextField accountTextField;
    private JPasswordField passwordTextField;
    private JButton loginButton;
    
    public SocialLoginDemo(){
        initUI();
        initListener();
    }
    
    private void initUI(){
        setTitle("社交登录");
        setSize(400, 300);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        
        JPanel contentPanel = new JPanel();
        contentPanel.setBorder(BorderFactory.createEmptyBorder(20, 20, 20, 20));
        contentPanel.setLayout(new BorderLayout());
        
        JPanel centerPanel = new JPanel();
        centerPanel.setLayout(new GridLayout(2, 2));
        
        JLabel accountLabel = new JLabel("请输入账号:");
        centerPanel.add(accountLabel);
        accountTextField = new JTextField(20);
        centerPanel.add(accountTextField);
        
        JLabel passwordLabel = new JLabel("请输入密码:");
        centerPanel.add(passwordLabel);
        passwordTextField = new JPasswordField(20);
        centerPanel.add(passwordTextField);
        
        JLabel iconLabel = new JLabel("", imageIcon, JLabel.CENTER);
        centerPanel.add(iconLabel);
        
        loginButton = new JButton("登录");
        centerPanel.add(loginButton);
        
        contentPanel.add(centerPanel, BorderLayout.CENTER);
        
        add(contentPanel);
    }
    
    private void initListener(){
        ActionListener listener = e -> {
            if (e.getActionCommand().equals("登录")){
                String account = accountTextField.getText().trim();
                char[] password = passwordTextField.getPassword();
                
                ILoginFactory factory = new SocialAccountLoginFactory();
                ISocialAccountLogin userLogin = (ISocialAccountLogin)factory.createUserLogin();
                userLogin.login(account, new String(password));
                
                JOptionPane.showMessageDialog(null,"登录成功!", "消息", JOptionPane.PLAIN_MESSAGE);
                dispose();
            }
        };
        loginButton.addActionListener(listener);
    }
    
}
```
SocialLoginDemo类用于演示社交登录的过程。

### （12）创建普通登录案例
```java
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class NormalLoginDemo extends JFrame {
    
    private JTextField usernameTextField;
    private JPasswordField passwordTextField;
    private JButton loginButton;
    
    public NormalLoginDemo(){
        initUI();
        initListener();
    }
    
    private void initUI(){
        setTitle("普通登录");
        setSize(400, 300);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        
        JPanel contentPanel = new JPanel();
        contentPanel.setBorder(BorderFactory.createEmptyBorder(20, 20, 20, 20));
        contentPanel.setLayout(new BorderLayout());
        
        JPanel centerPanel = new JPanel();
        centerPanel.setLayout(new GridLayout(2, 2));
        
        JLabel usernameLabel = new JLabel("请输入用户名:");
        centerPanel.add(usernameLabel);
        usernameTextField = new JTextField(20);
        centerPanel.add(usernameTextField);
        
        JLabel passwordLabel = new JLabel("请输入密码:");
        centerPanel.add(passwordLabel);
        passwordTextField = new JPasswordField(20);
        centerPanel.add(passwordTextField);
        
        JLabel iconLabel = new JLabel("");
        centerPanel.add(iconLabel);
        
        loginButton = new JButton("登录");
        centerPanel.add(loginButton);
        
        contentPanel.add(centerPanel, BorderLayout.CENTER);
        
        add(contentPanel);
    }
    
    private void initListener(){
        ActionListener listener = e -> {
            if (e.getActionCommand().equals("登录")){
                String username = usernameTextField.getText().trim();
                char[] password = passwordTextField.getPassword();
                
                if ("admin".equals(username) && "123456".equals(new String(password))){
                    JOptionPane.showMessageDialog(null,"登录成功!", "消息", JOptionPane.PLAIN_MESSAGE);
                    dispose();
                }else{
                    JOptionPane.showMessageDialog(null,"用户名或密码错误!", "消息", JOptionPane.WARNING_MESSAGE);
                }
            }
        };
        loginButton.addActionListener(listener);
    }
    
}
```
NormalLoginDemo类用于演示普通登录的过程。