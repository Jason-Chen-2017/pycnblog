
作者：禅与计算机程序设计艺术                    

# 1.简介
         
　　 MyBatis Generator是一个开源的MyBatis代码生成器插件。它可以帮助mybatis用户快速实现数据库操作和DAO层代码的生成。本文将详细介绍mybatis generator maven插件相关知识，包括：
         　　* 项目背景和目的；
         　　* 插件功能特性；
         　　* 使用场景；
         　　* 安装配置；
         　　* 核心配置文件参数配置；
         　　* 执行Generator插件命令；
         　　* 常用代码生成模板及自定义模板；
         　　* 生成文件目录说明；
         　　* 应用注意事项；
         　　* 扩展插件参数说明；
         　　* 优化建议；
         　　* 作者信息等。
         # 2.基本概念及术语介绍
         　　* DAO（Data Access Object）: 数据访问对象，就是一个接口，里面定义了对数据库表增删改查的方法，是业务逻辑层和数据持久层的中间纽带。
          
         　　* ORM（Object Relational Mapping）: 对象-关系映射，把编程语言里面的对象用类似于关系型数据库中表的形式表示出来。目的是通过ORM框架，使得程序员可以面向对象的思想去访问关系型数据库中的数据。
          
         　　* CRUD（Create、Read、Update and Delete）: 是指在数据库管理系统中，针对特定类型的数据记录集所进行的一系列操作，即创建、读取、更新和删除记录。
          
         　　* 模板：模板是一种特殊的文本文件，其中包含生成文件的文字信息，以及需要替换的信息。 MyBatis Generator 可以根据模板生成各种各样的文件，如XML配置文件、Java实体类、SQL语句等。
          
         　　* 插件（Plugin）：是基于MyBatis的一个独立的小型容器，可扩展性强，能够对MyBatis的运行时产生影响，用于扩展MyBatis的功能。官方提供了一些常用的插件，比如分页插件、代码生成器插件等。
          
        # 3.核心算法原理及操作步骤
         　　1、安装Maven

         　　2、创建Mybatis工程，引入相应的依赖包（mybatis 和 mybatis-generator-core）。并添加对应的mapper XML 文件

         　　3、创建mysql数据库，并在数据库中创建表

         　　4、下载mybatis generator 插件，并配置插件参数

         　　　　①configfile：设置生成器的核心配置文件路径，该文件中定义了生成过程的详细信息

         　　　　②overwrite：覆盖已存在的文件，默认值是false，即不覆盖已存在的文件

         　　　　③verbose：显示详细信息，默认值是false，当设置为true时，插件输出详细的执行日志

         　　　　④forceDelete：强制删除已生成的文件，默认值是false，即不会强制删除已生成的文件

         　　　　⑤targetProject：指定生成文件要保存到的目标目录，如果不指定，则默认生成到项目根目录下target/generated-sources/mybatis-generator文件夹下

         　　　　⑥rootInterface：指定生成代码所实现的接口名，若没有此配置，则默认为org.apache.ibatis.generation.GenericDao。该接口提供了一个基础的方法，用来提供增删改查方法的空实现。

         　　　　⑦javaTypeResolver：生成目标类的字段类型转换策略，默认值为org.mybatis.generator.internal.types.JavaTypeResolverDefaultImpl。该类包含了一系列的方法，可以根据不同的字段类型返回对应的JAVA数据类型。

         　　　　⑧jdbcConnectionDriver：指定数据库驱动类

         　　　　⑨jdbcConnectionUrl：指定数据库连接URL

         　　　　⑩contextid：指定上下文标识符，通常情况下无需设置该参数，MyBatis Generator会自动检测

         　　　　⑪databaseProductName：指定数据库产品名称，例如mysql，oracle等

         　　　　⑫databaseSchema：指定数据库模式

         　　　　⑬databaseTableName：指定需要生成的代码的数据库表名，多个表名之间使用逗号分隔

         　　5、配置核心配置文件：可以通过修改configfile指定的配置文件来定制生成器的参数，一般包括以下参数：

         　　　　①clientRootInterface：客户端的DAO接口名，该接口继承自客户端项目中的抽象DAO接口，其中的方法是业务方法的空实现

         　　　　②daoPackage：生成的DAO的包名，例如com.test.dao

         　　　　③dtdLocation：DTD文件的位置，默认为null，若没有DTD文件，则不需要配置

         　　　　④generateBuilders：是否支持构造函数生成，默认值是false

         　　　　⑤generatedKey：是否支持生成主键，默认值是数据库表的主键列。如果该表没有主键列，则需要配置该属性。

         　　　　⑥jdbcDriver：数据库驱动类

         　　　　⑦jdbcPassword：数据库密码

         　　　　⑧jdbcUser：数据库用户名

         　　　　⑨modelPackage：生成的实体类的包名，例如com.test.entity

         　　　　⑩sqlMapPackage：生成的SQL Map文件的包名，例如com.test.xml

         　　　　⑪useActualColumnNames：是否使用实际列名，默认值是false。如果该值设置为true，则生成的SQL查询结果将会包含实际列名，而不是采用驼峰命名法。

         　　　　⑫javaFileEncoding：生成的Java源文件编码，默认值是UTF-8

         　　　　⑬typeAliasesPackage：生成的类型别名类的包名，例如com.test.aliases

         　　　　⑭xmlMapperConfigLocation：指定生成的XML mapper配置文件的位置

         　　　　⑮targetRuntime：指定生成器的目标运行环境，包括JEE、SE和Embedded，默认值是SE

         　　6、执行mybaits-generator:generate命令，即可完成代码的生成。生成的文件可以在targetProject指定的目录找到。

         　　7、常用代码生成模板：Mybatis Generator提供了丰富的模板供用户选择，包括XML配置文件模板、Java实体类模板、SQL Map模板、配置文件模板等，这些模板可以直接在项目中运行或作为父类使用，进行自定义配置。

        # 4.具体代码实例及解释说明
         　　1、创建mybatis工程，引入mybatis-generator-core依赖

           <dependency>
                <groupId>org.mybatis</groupId>
                <artifactId>mybatis-spring-boot-starter</artifactId>
            </dependency>

            <dependency>
                <groupId>org.mybatis.generator</groupId>
                <artifactId>mybatis-generator-core</artifactId>
                <version>1.3.7</version>
            </dependency>

         　　2、创建Mysql数据库，并在数据库中创建表

           CREATE TABLE `user` (
             `id` INT(11) NOT NULL AUTO_INCREMENT COMMENT '主键ID',
             `name` VARCHAR(30) DEFAULT '' COMMENT '姓名',
             `age` INT(11) DEFAULT NULL COMMENT '年龄',
             PRIMARY KEY (`id`)
           ) ENGINE=InnoDB AUTO_INCREMENT=9 DEFAULT CHARSET=utf8mb4;

         　　3、下载mybatis generator插件，并解压

         　　4、配置pom.xml，添加mybatis-generator-maven-plugin插件

           <!-- mybatis generator 插件 -->
            <build>
                <plugins>
                    <plugin>
                        <groupId>org.mybatis.generator</groupId>
                        <artifactId>mybatis-generator-maven-plugin</artifactId>
                        <version>1.3.7</version>
                        <configuration>
                            <configurationFile>src/main/resources/generatorConfig.xml</configurationFile>
                            <overwrite>true</overwrite>
                            <verbose>true</verbose>
                            <targetProject>${project.basedir}/src/main/java/</targetProject>
                            <rootInterface>com.demo.common.base.BaseService</rootInterface>
                            <javaTypeResolver>
                                <property type="org.mybatis.generator.api.dom.java.TypeResolverConfiguration" value="">
                                    <properties>
                                        <property name="forceBigDecimals" value="false"/>
                                    </properties>
                                </property>
                            </javaTypeResolver>
                        </configuration>
                        <dependencies>
                            <dependency>
                                <groupId>mysql</groupId>
                                <artifactId>mysql-connector-java</artifactId>
                                <version>5.1.47</version>
                            </dependency>
                        </dependencies>
                    </plugin>
                </plugins>
            </build>

         　　5、创建configfile：配置生成器的核心配置文件，其内容如下：

         　　<?xml version="1.0" encoding="UTF-8"?>
         	<generatorConfiguration>
         		<!-- 配置JDBC连接参数 -->
         		<jdbcConnection driverClass="com.mysql.cj.jdbc.Driver"
              url="jdbc:mysql://localhost:3306/mybatis?serverTimezone=UTC&amp;useSSL=false"
              userId="root" password="password">
        		</jdbcConnection>
         		
         		<!-- 指定生成哪些表的数据字典文件 -->
         		<table tableName="user" domainObjectName="User" enableCountByExample="false"
                  enableUpdateByExample="false" enableDeleteByExample="false" enableSelectByExample="false">
         		</table>
         		
         		<!-- 默认false ，不覆盖已经生成的文件 -->
         		<overwrite>true</overwrite>
         		
         		<!-- 是否显示详细信息 -->
         		<verbose>true</verbose>
         		
         		<!-- 如果存在指定的文件，那么就强制删除 -->
         		<forceDelete>false</forceDelete>
         		
         		<!-- 生成文件的保存路径 -->
         		<targetProject>${project.basedir}</targetProject>
         		
         		<!-- root interface是为了生成DAO接口，但也可以用于生成其他任何类型的接口 -->
         		<rootInterface>com.demo.common.base.BaseService</rootInterface>
         		
         		<!-- Type Resolver 可以设置不同数据库字段对应的Java类型，可以使用 DefaultImpl 或者 CustomImpl 来实现。 -->
         		<javaTypeResolver>
         			<property type="org.mybatis.generator.api.dom.java.JavaTypeResolver"
                   key="default">
                    <value>org.mybatis.generator.internal.types.JavaTypeResolverDefaultImpl</value>
                </property>
         		</javaTypeResolver>
         		
         		<!-- 默认 false ，如果设置为 true，那么生成的 SQL 会考虑 JDBC 的 getBestRowIdentifier 方法，并且需要在表中定义主键或者唯一索引。 -->
         		<useBestPrimaryKeyTypes>false</useBestPrimaryKeyTypes>
         		
         		<!-- 自定义注释模板 -->
         		<commentProvider type="org.mybatis.generator.internal.CommentProviderDefaultImpl"></commentProvider>
         		
         		<!-- 当出现重复的列名时， MyBatis Generator 有两种处理方式。当设置为 false 时，默认的策略是在生成的 JavaBeans 属性名中加入下划线，然后检查是否有相同的属性名。 -->
         		<!-- 设置为 true 时，会在生成的 JavaBeans 属性名中完全使用列名，这样更加符合 JavaBeans 规范。 -->
         		<useActualColumnNames>true</useActualColumnNames>
         		
         		<!-- contextId 是个简单的字符串标识符，用于区分多个环境下的 MyBatis 配置文件。 -->
         		<contextId></contextId>
         		
         		<!-- 其它生成配置... -->
         	</generatorConfiguration>

         　　6、创建Java实体类User

           package com.demo.domain;
           
           public class User {
               private Integer id;
               private String name;
               private Integer age;
               
               // getter and setter methods... 
           }

         　　7、创建SqlMap xml文件：可以将同一组sql语句配置为一个xml文件，使用statement标签对每个sql进行定义，并给出一个唯一的id属性

         　　<?xml version="1.0" encoding="UTF-8"?>
         	<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
          "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
         	<mapper namespace="com.demo.dao.UserDao">
         		
         		<!-- statement标签配置sql语句，uniqueStatementId属性值为sql语句的唯一标识 -->
         		<select id="getUserList" resultType="com.demo.domain.User">
         			SELECT * FROM user ORDER BY ID ASC LIMIT #{start},#{size}
         		</select>
         		
         		<!-- 此处省略其它sql语句配置 -->
         	</mapper>

         　　8、执行命令：mvn clean compile exec:java@mbg

     　　  9、编译成功后，可以看到在target/generated-sources/mybatis-generator文件夹下生成了两个java文件，分别是Dao接口和实体类，还有一个sqlmap配置文件。

         　　实体类：

         　　package com.demo.domain;

         　　public class User {

         　　　private Integer id;

         　　　private String name;

         　　　private Integer age;

         　　　
         　　　/**

         　　　 * 获取主键ID

         　　　 */
         　　　public Integer getId() {
         　　　　　return this.id;
         　　　}

         　　　/**

         　　　 * 设置主键ID

         　　　 */
         　　　public void setId(Integer id) {
         　　　　　this.id = id;
         　　　}

         　　　
         　　　/**

         　　　 * 获取姓名

         　　　 */
         　　　public String getName() {
         　　　　　return this.name;
         　　　}

         　　　/**

         　　　 * 设置姓名

         　　　 */
         　　　public void setName(String name) {
         　　　　　this.name = name;
         　　　}

         　　　
         　　　/**

         　　　 * 获取年龄

         　　　 */
         　　　public Integer getAge() {
         　　　　　return this.age;
         　　　}

         　　　/**

         　　　 * 设置年龄

         　　　 */
         　　　public void setAge(Integer age) {
         　　　　　this.age = age;
         　　　}

         　　　
         　　　
         　　　@Override
         　　　public boolean equals(Object o) {
         　　　　　if (this == o) return true;
         　　　　　if (o == null || getClass()!= o.getClass()) return false;
         　　　　　User that = (User) o;
         　　　　　return Objects.equals(id, that.id) &&
         　　　　　　　　　Objects.equals(name, that.name) &&
         　　　　　　　　　Objects.equals(age, that.age);
         　　　}

         　　　@Override
         　　　public int hashCode() {
         　　　　　return Objects.hash(id, name, age);
         　　　}
         　　}

         　　Dao接口：

         　　package com.demo.dao;

         　　import java.util.List;

         　　import org.apache.ibatis.annotations.Param;

         　　import com.demo.domain.User;

         　　public interface UserDao {
         　　
         　　　/**
         　　　 * 查询所有用户列表
         　　　 */
         　　　List<User> getUserList(@Param("start") Integer start,@Param("size") Integer size);
         　　}

         　　其中，UserDao继承了BaseService接口，因此UserDao可以继承其他业务接口，并共用BaseService的事务控制功能。