# 第36篇 线性代数在3D图形学中的应用

## 1. 背景介绍

### 1.1 3D图形学概述

3D图形学是计算机图形学的一个重要分支,它涉及到在二维平面上表示和操作三维对象的各种技术和算法。随着计算机硬件性能的不断提高,以及人们对更加逼真的视觉体验的需求,3D图形学在各个领域得到了广泛的应用,如计算机游戏、电影特效、虚拟现实、科学可视化等。

### 1.2 线性代数在3D图形学中的重要性

线性代数为3D图形学提供了坚实的数学基础。在3D图形学中,我们需要对三维空间中的点、向量、变换等进行表示和操作,这些都需要借助线性代数的概念和方法。线性代数不仅为3D图形学提供了描述和建模的工具,而且还为许多核心算法提供了高效的计算方式。

## 2. 核心概念与联系

### 2.1 向量

向量是线性代数中最基本的概念之一,在3D图形学中被广泛应用。一个三维向量可以表示一个点在三维空间中的位置,也可以表示一个方向。向量的加法和数乘运算为我们操作空间中的点和方向提供了方便。

### 2.2 矩阵

矩阵是线性代数中另一个核心概念,在3D图形学中也扮演着重要角色。矩阵可以用来表示坐标变换、投影等操作,使得我们能够方便地对三维场景中的物体进行各种几何变换。

### 2.3 变换

变换是3D图形学中最常见的操作之一,包括平移、旋转、缩放等。通过线性代数中的矩阵运算,我们可以高效地实现各种变换,从而操控三维场景中物体的位置和方向。

### 2.4 视角变换

在3D图形学中,我们需要将三维场景投影到二维平面上进行显示。视角变换就是将三维坐标系统转换到观察坐标系统的过程,这个过程需要借助线性代数中的矩阵运算来实现。

## 3. 核心算法原理和具体操作步骤

### 3.1 向量运算

#### 3.1.1 向量加法

向量加法是将两个向量按照分量相加的运算,具体操作步骤如下:

1) 将两个向量分别表示为 $\vec{a} = (a_x, a_y, a_z)$ 和 $\vec{b} = (b_x, b_y, b_z)$
2) 计算 $\vec{c} = \vec{a} + \vec{b} = (a_x + b_x, a_y + b_y, a_z + b_z)$

向量加法满足交换律和结合律。

#### 3.1.2 向量数乘

向量数乘是将一个向量的每个分量乘以一个标量的运算,具体操作步骤如下:

1) 将向量表示为 $\vec{a} = (a_x, a_y, a_z)$
2) 对于任意标量 $k$,计算 $k\vec{a} = (ka_x, ka_y, ka_z)$

向量数乘满足结合律和分配律。

#### 3.1.3 向量点积

向量点积是两个向量的一种内积运算,具体操作步骤如下:

1) 将两个向量分别表示为 $\vec{a} = (a_x, a_y, a_z)$ 和 $\vec{b} = (b_x, b_y, b_z)$
2) 计算 $\vec{a} \cdot \vec{b} = a_xb_x + a_yb_y + a_zb_z$

向量点积的几何意义是两个向量的长度的乘积与它们夹角的余弦的乘积。

#### 3.1.4 向量叉积

向量叉积是两个向量的一种外积运算,具体操作步骤如下:

1) 将两个向量分别表示为 $\vec{a} = (a_x, a_y, a_z)$ 和 $\vec{b} = (b_x, b_y, b_z)$
2) 计算 $\vec{a} \times \vec{b} = (a_yb_z - a_zb_y, a_zb_x - a_xb_z, a_xb_y - a_yb_x)$

向量叉积的几何意义是一个垂直于两个向量所在平面的向量,其长度等于两个向量形成的平行四边形的面积。

### 3.2 矩阵运算

#### 3.2.1 矩阵乘法

矩阵乘法是两个矩阵相乘的运算,具体操作步骤如下:

1) 设矩阵 $A$ 为 $m \times n$ 矩阵,矩阵 $B$ 为 $n \times p$ 矩阵
2) 构造一个 $m \times p$ 的矩阵 $C$,其中第 $i$ 行第 $j$ 列的元素为:

$$c_{ij} = \sum_{k=1}^n a_{ik}b_{kj}$$

3) 矩阵乘法满足结合律,但不满足交换律

#### 3.2.2 逆矩阵

如果一个矩阵 $A$ 存在逆矩阵 $A^{-1}$,那么就有 $AA^{-1} = A^{-1}A = I$,其中 $I$ 是单位矩阵。求逆矩阵的操作步骤如下:

1) 计算矩阵 $A$ 的行列式 $\det(A)$
2) 如果 $\det(A) \neq 0$,那么 $A$ 是可逆的,计算 $A$ 的伴随矩阵 $\text{adj}(A)$
3) 计算 $A^{-1} = \frac{1}{\det(A)}\text{adj}(A)$

#### 3.2.3 变换矩阵

在3D图形学中,我们通常使用矩阵来表示各种几何变换,如平移、旋转、缩放等。下面分别介绍这些变换矩阵的计算方法:

1) **平移矩阵**

对于一个三维向量 $(t_x, t_y, t_z)$,平移变换的矩阵为:

$$
T = \begin{bmatrix}
1 & 0 & 0 & t_x \\
0 & 1 & 0 & t_y \\
0 & 0 & 1 & t_z \\
0 & 0 & 0 & 1
\end{bmatrix}
$$

2) **旋转矩阵**

旋转矩阵分为绕 $x$ 轴旋转、绕 $y$ 轴旋转和绕 $z$ 轴旋转三种情况,它们的矩阵形式如下:

绕 $x$ 轴旋转 $\theta$ 角度:

$$
R_x(\theta) = \begin{bmatrix}
1 & 0 & 0 & 0\\
0 & \cos\theta & -\sin\theta & 0\\
0 & \sin\theta & \cos\theta & 0\\
0 & 0 & 0 & 1
\end{bmatrix}
$$

绕 $y$ 轴旋转 $\theta$ 角度:

$$
R_y(\theta) = \begin{bmatrix}
\cos\theta & 0 & \sin\theta & 0\\
0 & 1 & 0 & 0\\
-\sin\theta & 0 & \cos\theta & 0\\
0 & 0 & 0 & 1
\end{bmatrix}
$$

绕 $z$ 轴旋转 $\theta$ 角度:

$$
R_z(\theta) = \begin{bmatrix}
\cos\theta & -\sin\theta & 0 & 0\\
\sin\theta & \cos\theta & 0 & 0\\
0 & 0 & 1 & 0\\
0 & 0 & 0 & 1
\end{bmatrix}
$$

3) **缩放矩阵**

对于一个三维缩放比例 $(s_x, s_y, s_z)$,缩放变换的矩阵为:

$$
S = \begin{bmatrix}
s_x & 0 & 0 & 0\\
0 & s_y & 0 & 0\\
0 & 0 & s_z & 0\\
0 & 0 & 0 & 1
\end{bmatrix}
$$

通过将这些基本变换矩阵相乘,我们可以构造出复合变换矩阵,从而实现更加复杂的几何变换。

### 3.3 视角变换

#### 3.3.1 摄像机坐标系

在3D图形学中,我们通常使用一个摄像机坐标系来描述场景。摄像机坐标系的原点位于摄像机的位置,摄像机的朝向为 $-z$ 轴的方向,上方向为 $y$ 轴的方向。

#### 3.3.2 视图变换

视图变换是将物体从世界坐标系转换到摄像机坐标系的过程,具体步骤如下:

1) 构造一个平移矩阵 $T$,将摄像机位置的反方向作为平移向量
2) 构造一个旋转矩阵 $R$,将摄像机的朝向与 $-z$ 轴对齐,上方向与 $y$ 轴对齐
3) 视图变换矩阵 $M_\text{view} = R \times T$
4) 对于任意一个点 $P$ 在世界坐标系中的坐标 $(x, y, z, 1)$,它在摄像机坐标系中的坐标为 $M_\text{view} \times (x, y, z, 1)^T$

#### 3.3.3 投影变换

投影变换是将三维场景映射到二维平面的过程,分为正交投影和透视投影两种方式。

1) **正交投影**

正交投影保持了物体的形状和大小,但失去了深度信息。正交投影矩阵的形式为:

$$
M_\text{ortho} = \begin{bmatrix}
\frac{2}{r-l} & 0 & 0 & -\frac{r+l}{r-l}\\
0 & \frac{2}{t-b} & 0 & -\frac{t+b}{t-b}\\
0 & 0 & \frac{2}{n-f} & -\frac{n+f}{n-f}\\
0 & 0 & 0 & 1
\end{bmatrix}
$$

其中 $l, r, b, t, n, f$ 分别表示视景体的左、右、下、上、近、远平面的坐标值。

2) **透视投影**

透视投影能够保持物体的真实比例和远近关系,是更加逼真的投影方式。透视投影矩阵的形式为:

$$
M_\text{persp} = \begin{bmatrix}
\frac{2n}{r-l} & 0 & \frac{r+l}{r-l} & 0\\
0 & \frac{2n}{t-b} & \frac{t+b}{t-b} & 0\\
0 & 0 & -\frac{f+n}{f-n} & -\frac{2fn}{f-n}\\
0 & 0 & -1 & 0
\end{bmatrix}
$$

其中参数的含义与正交投影相同。

通过将视图变换矩阵和投影变换矩阵相乘,我们可以得到最终的模型视图投影矩阵 $M_\text{MVP}$,将三维物体的坐标乘以这个矩阵,就可以得到它在二维平面上的坐标,从而完成渲染。

## 4. 数学模型和公式详细讲解举例说明

在上一节中,我们介绍了线性代数在3D图形学中的一些核心算法,包括向量运算、矩阵运算和视角变换等。这些算法都有着严格的数学模型和公式支撑,下面我们将对其中的一些公式进行详细讲解和举例说明。

### 4.1 向量点积

向量点积 $\vec{a} \cdot \vec{b}$ 的计算公式为:

$$\vec{a} \cdot \vec{b} = a_xb_x + a_yb_y + a_zb_z$$

其中 $\vec{a} = (a_x, a_y, a_z)$, $\vec{b} = (b_x, b_y, b_z)$。

向量点积的几何意义是两个向量的长度的乘积与它们夹角的余弦的乘积,即:

$$\vec{a} \cdot \vec{b} = |\vec{a}||\vec{b}|\cos\theta$$

其中 $\theta$ 是两个向量的夹角。

**举例**:

设有两个向量 $\vec{a} = (2, 1, 3)$, $\vec{b} = (1, 4, 2)$,求它们的点积。

解:
$$
\begin{aligned}
\vec{a} \cdot \vec{b