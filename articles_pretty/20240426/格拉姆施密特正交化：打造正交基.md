# 格拉姆-施密特正交化：打造正交基

## 1. 背景介绍

### 1.1 线性代数基础

在线性代数中,向量空间是一个非常重要的概念。向量空间是一组满足某些代数运算的向量的集合。在向量空间中,我们经常需要找到一组基底向量,这些基底向量线性无关且能够生成整个向量空间。

### 1.2 正交基的重要性

然而,在许多应用中,我们不仅需要一组基,还需要一组正交基。正交基是指基向量之间彼此正交(内积为0)的一组基。正交基具有许多良好的数学性质,在许多领域都有广泛的应用,例如:

- 数值计算:正交基可以提高数值计算的稳定性和精度。
- 信号处理:正交基广泛应用于小波变换、主成分分析等领域。
- 量子力学:在量子力学中,正交基扮演着至关重要的角色。
- 数据压缩:正交基可用于有损数据压缩,如JPEG图像压缩。

因此,从任意一组基向量出发,构造一组正交基就成为一个重要的数学问题。格拉姆-施密特正交化正是解决这一问题的经典方法。

## 2. 核心概念与联系

### 2.1 向量正交

如果两个向量的内积为0,则称这两个向量是正交的。形式上,对于向量 $\vec{u}$ 和 $\vec{v}$,如果 $\vec{u} \cdot \vec{v} = 0$,则 $\vec{u}$ 和 $\vec{v}$ 正交。

### 2.2 正交基

一组向量 $\{\vec{v}_1, \vec{v}_2, \ldots, \vec{v}_n\}$ 如果两两正交,即 $\vec{v}_i \cdot \vec{v}_j = 0 (i \neq j)$,则称这组向量是一个正交基。

### 2.3 格拉姆-施密特正交化

格拉姆-施密特正交化是一种从任意一组线性无关的向量出发,构造一组正交基的方法。该方法由数学家格拉姆和施密特分别独立提出,因此得名。

该方法的核心思想是:从第一个向量开始,对后续的每个向量,去除其在前面所有正交向量上的投影分量,从而得到一个新的正交于前面所有向量的向量。重复这一过程,直到处理完所有向量。

## 3. 核心算法原理具体操作步骤  

### 3.1 算法描述

假设我们有一组线性无关的向量 $\{\vec{u}_1, \vec{u}_2, \ldots, \vec{u}_n\}$,我们希望从中构造一组正交基 $\{\vec{v}_1, \vec{v}_2, \ldots, \vec{v}_n\}$。格拉姆-施密特正交化的具体步骤如下:

1) 取 $\vec{v}_1 = \vec{u}_1$

2) 对于 $i = 2, 3, \ldots, n$:
    
    a) 计算 $\vec{u}_i$ 在 $\vec{v}_1, \vec{v}_2, \ldots, \vec{v}_{i-1}$ 上的投影:
        
        $$\vec{p}_i = \sum_{j=1}^{i-1} \frac{\vec{u}_i \cdot \vec{v}_j}{\vec{v}_j \cdot \vec{v}_j} \vec{v}_j$$
        
    b) 计算 $\vec{u}_i$ 去除投影后的分量:
        
        $$\vec{v}_i = \vec{u}_i - \vec{p}_i$$

3) 得到的 $\{\vec{v}_1, \vec{v}_2, \ldots, \vec{v}_n\}$ 就是我们需要的正交基。

### 3.2 算法解析

为什么这个算法能够构造出正交基呢?我们来仔细分析一下。

在第一步,我们直接取 $\vec{v}_1 = \vec{u}_1$,这是因为 $\vec{u}_1$ 本身就是线性无关的。

在第二步中,对于每一个新的向量 $\vec{u}_i$,我们首先计算它在之前构造的正交基 $\vec{v}_1, \vec{v}_2, \ldots, \vec{v}_{i-1}$ 上的投影 $\vec{p}_i$。由于投影是这些正交基的线性组合,所以 $\vec{p}_i$ 必然在由这些正交基张成的子空间内。

接下来,我们计算 $\vec{u}_i$ 去除投影后的分量 $\vec{v}_i = \vec{u}_i - \vec{p}_i$。由于 $\vec{p}_i$ 在由 $\vec{v}_1, \vec{v}_2, \ldots, \vec{v}_{i-1}$ 张成的子空间内,所以 $\vec{v}_i$ 必然正交于这些向量。

同时,由于 $\vec{u}_1, \vec{u}_2, \ldots, \vec{u}_n$ 线性无关,所以 $\vec{v}_i$ 不可能为零向量。因此,我们得到了一个新的正交于之前所有正交基的非零向量 $\vec{v}_i$。

重复这一过程,直到处理完所有向量,我们就得到了一组正交基 $\{\vec{v}_1, \vec{v}_2, \ldots, \vec{v}_n\}$。

### 3.3 算法复杂度分析

假设输入向量的维度为 $m$,输入向量的个数为 $n$,则格拉姆-施密特正交化算法的时间复杂度为 $O(m^2n)$。

这是因为,在计算每一个 $\vec{v}_i$ 时,我们需要:

1. 计算 $\vec{u}_i$ 在之前所有正交基上的投影,需要 $O(mi)$ 次运算。
2. 计算 $\vec{v}_i = \vec{u}_i - \vec{p}_i$,需要 $O(m)$ 次运算。

因此,计算 $\vec{v}_i$ 需要 $O(mi + m) = O(mi)$ 次运算。对于所有的 $n$ 个向量,总的时间复杂度为:

$$O(m \cdot 1 + m \cdot 2 + \ldots + m \cdot n) = O(m^2n)$$

空间复杂度为 $O(mn)$,因为我们需要存储输入向量和输出正交基。

## 4. 数学模型和公式详细讲解举例说明

在上一节中,我们已经给出了格拉姆-施密特正交化算法的核心公式:

$$\vec{p}_i = \sum_{j=1}^{i-1} \frac{\vec{u}_i \cdot \vec{v}_j}{\vec{v}_j \cdot \vec{v}_j} \vec{v}_j$$

$$\vec{v}_i = \vec{u}_i - \vec{p}_i$$

这里我们来详细解释一下这两个公式的含义和推导过程。

### 4.1 投影公式推导

我们先来推导投影公式 $\vec{p}_i = \sum_{j=1}^{i-1} \frac{\vec{u}_i \cdot \vec{v}_j}{\vec{v}_j \cdot \vec{v}_j} \vec{v}_j$。

设 $\vec{u}$ 为任意一个向量,我们希望求出 $\vec{u}$ 在某个单位向量 $\vec{v}$ 上的投影 $\vec{p}$。根据投影的性质,我们知道:

1. $\vec{p}$ 必须与 $\vec{v}$ 方向相同,即 $\vec{p} = \lambda \vec{v}$,其中 $\lambda$ 为某个标量。
2. $\vec{u} - \vec{p}$ 必须正交于 $\vec{v}$,即 $(\vec{u} - \vec{p}) \cdot \vec{v} = 0$。

将第一个性质代入第二个性质,我们得到:

$$(\vec{u} - \lambda \vec{v}) \cdot \vec{v} = 0$$
$$\vec{u} \cdot \vec{v} - \lambda \vec{v} \cdot \vec{v} = 0$$
$$\lambda = \frac{\vec{u} \cdot \vec{v}}{\vec{v} \cdot \vec{v}}$$

将 $\lambda$ 代回第一个性质,我们得到:

$$\vec{p} = \frac{\vec{u} \cdot \vec{v}}{\vec{v} \cdot \vec{v}} \vec{v}$$

这就是 $\vec{u}$ 在单位向量 $\vec{v}$ 上的投影公式。

如果我们希望求 $\vec{u}$ 在一组正交基 $\{\vec{v}_1, \vec{v}_2, \ldots, \vec{v}_k\}$ 上的投影 $\vec{p}$,根据投影的线性性质,我们只需要将投影在每个基向量上的分量相加即可:

$$\vec{p} = \sum_{j=1}^{k} \frac{\vec{u} \cdot \vec{v}_j}{\vec{v}_j \cdot \vec{v}_j} \vec{v}_j$$

将 $\vec{u}$ 替换为 $\vec{u}_i$,将 $k$ 替换为 $i-1$,我们就得到了格拉姆-施密特正交化算法中的投影公式:

$$\vec{p}_i = \sum_{j=1}^{i-1} \frac{\vec{u}_i \cdot \vec{v}_j}{\vec{v}_j \cdot \vec{v}_j} \vec{v}_j$$

### 4.2 正交化公式解释

接下来,我们解释一下正交化公式 $\vec{v}_i = \vec{u}_i - \vec{p}_i$ 的含义。

由于 $\vec{p}_i$ 是 $\vec{u}_i$ 在之前所有正交基上的投影,因此 $\vec{p}_i$ 必然在由这些正交基张成的子空间内。将 $\vec{p}_i$ 从 $\vec{u}_i$ 中减去,就得到了 $\vec{u}_i$ 在该子空间的正交补空间中的分量 $\vec{v}_i$。

由于 $\vec{u}_1, \vec{u}_2, \ldots, \vec{u}_n$ 线性无关,所以 $\vec{v}_i$ 必然是一个非零向量。同时,由于 $\vec{v}_i$ 正交于之前所有的正交基,因此 $\vec{v}_i$ 就是我们需要的新的正交基向量。

### 4.3 例子说明

现在,我们来看一个具体的例子,帮助理解格拉姆-施密特正交化的过程。

假设我们有一组三维向量 $\vec{u}_1 = (1, 1, 1)$, $\vec{u}_2 = (1, 0, 2)$, $\vec{u}_3 = (2, 1, 0)$,我们希望从中构造一组正交基。

1) 取 $\vec{v}_1 = \vec{u}_1 = (1, 1, 1)$

2) 计算 $\vec{p}_2$:

$$\vec{p}_2 = \frac{\vec{u}_2 \cdot \vec{v}_1}{\vec{v}_1 \cdot \vec{v}_1} \vec{v}_1 = \frac{1 \cdot 1 + 0 \cdot 1 + 2 \cdot 1}{1^2 + 1^2 + 1^2} (1, 1, 1) = \left(\frac{3}{3}, \frac{3}{3}, \frac{3}{3}\right)$$

计算 $\vec{v}_2$:

$$\vec{v}_2 = \vec{u}_2 - \vec{p}_2 = (1, 0, 2) - \left(\frac{3}{3}, \frac{3}{3}, \frac{3}{3}\right) = \left(-\frac{2}{3}, -\frac{3}{3}, \frac{5}{3}\right)$$

3) 计算 $\vec{p}_3$:

$$\vec{p}_3 = \frac{\vec{u}_3 \cdot \vec{v}_1}{\vec{v}_1 \cdot \vec{v}_1} \vec{v}_1 + \frac{\vec{u}_3 \cdot \vec{v}_2}{\vec{v}_2 \cdot \vec{v}_2} \vec{v}_2 = \frac{2 \cdot 1 + 1 \cdot 1 + 0 \cdot 1}{3} (1, 1, 1) + \frac{2 \cdot (-\frac{2}{3}) + 1 \cdot (-\frac{3}{3}) + 0 \cdot \frac{5}{3}}{\frac{14}{3}} \left(-\frac{2}{3}, -\frac{3}{3}, \frac{5}{3}\right) = \left(\frac{3}{3}, \frac{3}{3}, \frac{3}{3}\right) + \left(-\frac{5}{7}, -\frac{3}{7}, 0\right)$$

计算 $\vec{v}_3$:

$$\vec{v}_3 = \vec{u}_3 - \vec