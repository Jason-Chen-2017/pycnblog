## 1. 背景介绍

### 1.1 非线性规划问题概述

非线性规划问题广泛存在于科学、工程和经济等领域，其目标是在满足一系列约束条件的情况下，找到目标函数的最优解。与线性规划不同，非线性规划的目标函数或约束条件中包含非线性关系，这使得求解过程更为复杂。

### 1.2 序列二次规划算法 (SQP) 简介

序列二次规划算法 (SQP) 是一种用于解决非线性规划问题的迭代优化算法。它通过将原问题近似为一系列二次规划子问题，并利用已有的高效二次规划求解器进行求解，从而逐步逼近原问题的最优解。SQP 算法具有收敛速度快、鲁棒性强等优点，被广泛应用于各种非线性优化问题。

## 2. 核心概念与联系

### 2.1 拉格朗日乘子法

拉格朗日乘子法是解决约束优化问题的重要工具，它将约束条件引入目标函数，构建拉格朗日函数，通过求解拉格朗日函数的驻点来寻找原问题的最优解。在 SQP 算法中，拉格朗日乘子法被用于将约束非线性规划问题转换为无约束优化问题。

### 2.2 二次规划

二次规划 (QP) 是一种特殊的非线性规划问题，其目标函数为二次函数，约束条件为线性函数。QP 问题具有成熟的求解方法，如内点法、 active-set 法等，可以高效地求解。SQP 算法利用 QP 问题易于求解的特性，将非线性规划问题分解为一系列 QP 子问题进行求解。

## 3. 核心算法原理与操作步骤

### 3.1 SQP 算法基本思想

SQP 算法的基本思想是：在当前迭代点附近，将原非线性规划问题近似为一个 QP 子问题，求解该 QP 子问题得到搜索方向，并沿搜索方向进行线搜索，找到下一个迭代点。重复上述过程，直到满足收敛条件。

### 3.2 算法具体操作步骤

1. **初始化:** 选择初始点 $x_0$，拉格朗日乘子 $\lambda_0$，以及惩罚参数 $\mu_0$。

2. **构建 QP 子问题:** 在当前迭代点 $x_k$ 处，将目标函数和约束条件进行二阶泰勒展开，得到一个 QP 子问题。

3. **求解 QP 子问题:** 利用 QP 求解器求解 QP 子问题，得到搜索方向 $d_k$ 和拉格朗日乘子更新量 $\Delta \lambda_k$。

4. **线搜索:** 沿搜索方向 $d_k$ 进行线搜索，找到下一个迭代点 $x_{k+1}$，并更新拉格朗日乘子 $\lambda_{k+1}$ 和惩罚参数 $\mu_{k+1}$。

5. **收敛判断:** 判断是否满足收敛条件，若满足则停止迭代，输出最优解；否则，返回步骤 2 继续迭代。

## 4. 数学模型和公式详细讲解

### 4.1 非线性规划问题的一般形式

非线性规划问题的一般形式为：

$$
\begin{aligned}
\min_{x} \quad & f(x) \\
\text{s.t.} \quad & g(x) \leq 0 \\
& h(x) = 0
\end{aligned}
$$

其中，$f(x)$ 为目标函数，$g(x)$ 为不等式约束，$h(x)$ 为等式约束。

### 4.2 QP 子问题构建

在当前迭代点 $x_k$ 处，将目标函数和约束条件进行二阶泰勒展开，得到 QP 子问题：

$$
\begin{aligned}
\min_{d} \quad & \frac{1}{2} d^T \nabla^2_{xx} L(x_k, \lambda_k, \mu_k) d + \nabla f(x_k)^T d \\
\text{s.t.} \quad & \nabla g(x_k)^T d + g(x_k) \leq 0 \\
& \nabla h(x_k)^T d + h(x_k) = 0
\end{aligned}
$$

其中，$L(x, \lambda, \mu)$ 为拉格朗日函数，$\nabla^2_{xx} L$ 为拉格朗日函数的海森矩阵。

### 4.3 线搜索

线搜索的目的是找到一个合适的步长 $\alpha_k$，使得目标函数在搜索方向 $d_k$ 上有足够的下降。常用的线搜索方法包括 Armijo 条件、Wolfe 条件等。 
