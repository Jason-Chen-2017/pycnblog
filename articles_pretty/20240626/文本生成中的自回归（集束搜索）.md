# 文本生成中的自回归（集束搜索）

## 关键词：

- 自回归（Autoregressive）
- 集束搜索（Beam Search）
- 文本生成（Text Generation）
- 机器翻译（Machine Translation）
- 序列到序列模型（Sequence-to-Sequence Model）

## 1. 背景介绍

### 1.1 问题的由来

文本生成是自然语言处理领域中的一个重要分支，涉及到将一系列单词、句子或段落按照特定规则和模式转换为人类可读的文字。在过去的几十年里，随着深度学习技术的发展，尤其是循环神经网络（RNN）和注意力机制的引入，文本生成能力取得了显著的进步。在许多应用中，如自动摘要、对话系统、故事生成和机器翻译等领域，文本生成技术发挥了重要作用。

### 1.2 研究现状

目前，文本生成主要依赖于两种类型的技术：基于规则的方法和基于统计或学习的方法。基于规则的方法通常依赖于语法结构和词汇表，而基于统计或学习的方法则依赖于大量已有的文本数据进行训练，从而学习到文本生成的模式和规律。近年来，随着预训练语言模型（如BERT、GPT等）的兴起，基于学习的方法成为了文本生成领域的主流技术。这些模型通过在大量文本数据上进行预训练，学习到丰富的语言知识，进而能够生成与训练数据风格一致的新文本。

### 1.3 研究意义

自回归（Autoregressive）模型是文本生成的一种常见形式，它通过依次生成文本序列中的每一个元素，依赖于之前生成的元素来进行预测。自回归模型在生成文本时，会根据先前生成的文本片段来预测下一个最有可能出现的词语。这种顺序依赖的特性使得生成过程既依赖于模型的内部状态，又受到生成历史的影响。集束搜索（Beam Search）作为一种有效的搜索策略，常用于自回归模型中，尤其是在机器翻译、文本摘要等场景下，通过限制搜索空间来提高生成速度和效率，同时保证生成质量。

### 1.4 本文结构

本文将深入探讨自回归模型中的集束搜索技术，从理论基础出发，逐步介绍算法原理、具体操作步骤、优缺点以及在实际中的应用。同时，我们将通过数学模型和公式详细讲解集束搜索的运作机制，并给出代码实例和运行结果展示，以便读者能够全面了解这一技术在文本生成领域的应用。此外，本文还将讨论集束搜索在实际场景中的应用，提出未来发展趋势和面临的挑战，并提供相关学习资源、开发工具和论文推荐，以促进技术的普及和深入研究。

## 2. 核心概念与联系

### 自回归模型的基本概念

自回归模型是基于序列数据的一种预测模型，其预测的每个新元素都依赖于前一时刻预测出的序列。在文本生成中，这意味着每个新生成的单词都依赖于之前生成的所有单词。自回归模型可以分为以下几种：

- **单向自回归（Unidirectional Autoregressive）**：仅依赖于序列的过去部分，例如在生成文本时，每个单词仅依赖于前面的单词。
- **双向自回归（Bidirectional Autoregressive）**：同时依赖于序列的过去和未来部分，可以捕捉更多上下文信息。

### 集束搜索的引入

集束搜索是用于自回归模型的一种搜索策略，旨在平衡生成质量与搜索效率。在集束搜索中，算法会同时跟踪一组候选解决方案（即“束”），每一步生成可能的下一个元素，并评估这些候选解决方案。通过这种方式，集束搜索能够在较短的时间内产生高质量的生成文本，同时避免了全搜索带来的指数级增长时间复杂度。

## 3. 核心算法原理 & 具体操作步骤

### 3.1 算法原理概述

集束搜索算法的核心思想是在每次生成新元素时，同时考虑多个潜在的生成路径。每一步，算法都会根据当前状态和概率分布选择最有可能产生高质量文本的候选路径。这种策略在限制搜索空间的同时，仍然能够探索多种可能性，从而产生多样化的文本输出。

### 3.2 算法步骤详解

集束搜索算法的具体步骤如下：

#### 初始化步骤：
- 设定初始状态和束的大小（例如，K个初始路径）。
- 使用起始符号生成第一个序列。

#### 主循环步骤：
- 对于每个生成步骤：
  - 根据当前状态计算所有可能的后续符号及其概率。
  - 为每个候选路径选择最有可能的后续符号，同时记录每个路径的累积概率和状态。
  - 更新每个路径的状态，并在所有路径中选择K个最佳路径继续进行下一步。

#### 终止步骤：
- 当达到预定的生成长度或满足其他终止条件时，结束循环。
- 从剩余的最佳路径中选择累计概率最高的路径作为最终生成的结果。

### 3.3 算法优缺点

#### 优点：
- **高效性**：通过限制搜索空间，集束搜索可以在合理时间内生成高质量文本。
- **多样性**：相比于贪婪搜索，集束搜索能够探索更多的生成可能性，产生更丰富的文本输出。

#### 缺点：
- **搜索空间限制**：K值的选择直接影响生成质量和效率，过高或过低的K值可能导致生成质量不佳或搜索耗时增加。
- **记忆负担**：随着生成长度的增加，每个路径的计算和维护成本也随之增加。

### 3.4 算法应用领域

集束搜索在文本生成中的应用广泛，特别是在机器翻译、文本摘要、故事生成和对话系统等领域。它尤其适合处理语境依赖性强的任务，通过在有限的搜索空间内探索可能性，生成符合语境且多样化的文本。

## 4. 数学模型和公式 & 详细讲解 & 举例说明

### 4.1 数学模型构建

集束搜索可以视为一种基于概率的搜索策略，其中每个路径的得分可以通过累加生成过程中的概率来计算。设$\pi = (\pi_1, \pi_2, ..., \pi_T)$为生成的序列，$\pi_t$为第$t$时刻的生成元素，$p_t(\pi_t|\pi_{<t})$为在前$t-1$时刻生成的基础上生成$\pi_t$的概率，则生成序列$\pi$的总概率为：

$$P(\pi) = \prod_{t=1}^{T} p_t(\pi_t|\pi_{<t})$$

在集束搜索中，我们关心的是寻找概率最大的序列或者一组高概率的序列集合。设$k$为束的大小，即同时跟踪$k$个最高概率的序列：

$$\text{Best} = \text{argmax}_{\pi \in \Pi} P(\pi)$$

其中$\Pi$是所有可能序列的集合。

### 4.2 公式推导过程

在具体应用中，我们通常无法直接计算所有可能序列的总概率，因为序列的数量通常是指数级增长的。因此，我们采用动态规划的方法，逐步构建和更新可能的序列集合：

- **初始化**：设初始状态为起始符号的概率分布$p_1$，构建初始集合$\Pi$。
- **递推**：对于每个时刻$t$，遍历$\Pi$中的所有序列$\pi$，计算$\pi_t$的生成概率$p_t(\pi_t|\pi_{<t})$，更新$\Pi$为包含所有$\pi$及其子序列的集合，同时保持$k$个最高概率的序列。
- **终止**：重复递推过程直到达到预定长度或满足其他终止条件。

### 4.3 案例分析与讲解

假设我们使用一个简单的自回归模型来生成文本，模型在每个时刻基于前一时刻的状态来预测下一个单词的概率。假设我们的模型在训练集上学会了以下规则：

- **规则1**：如果上一个单词是“猫”，那么下一个单词可能是“喵”或“抓”。
- **规则2**：如果上一个单词是“狗”，那么下一个单词可能是“汪”或“咬”。

在生成文本时，我们使用集束搜索策略，考虑以下两个初始序列：

- **序列A**: ["猫"]
- **序列B**: ["狗"]

在第二个时刻，我们分别考虑每个序列的可能扩展：

- **序列A**：扩展为["猫", "喵"]或["猫", "抓"]。
- **序列B**：扩展为["狗", "汪"]或["狗", "咬"]。

我们根据每个扩展后的序列的概率来更新我们的候选序列集合，选择最有可能产生高质量文本的序列。这个过程会持续进行，直到达到预定的生成长度或满足其他停止条件。

### 4.4 常见问题解答

**Q:** 如何选择集束搜索中的K值？

**A:** K值的选择是集束搜索中的一个关键参数，它影响着生成文本的质量和多样性。较小的K值意味着更少的候选路径，可能导致生成的文本过于单一，而较大的K值虽然增加了多样性，但也可能导致生成时间增加。通常，K值的选择依赖于具体的任务需求和计算资源。在实践中，可以尝试不同的K值来观察生成文本的质量和效率之间的权衡。

**Q:** 集束搜索如何处理生成长度超过预设长度的情况？

**A:** 集束搜索在达到预设的生成长度时自然停止。若生成长度超过预设值，可以提前中断搜索过程。在某些情况下，为了确保生成质量，可以设定一个“early stopping”策略，即在生成过程中如果某个候选序列超过了预设长度，该序列会被排除在考虑之外。

**Q:** 集束搜索是否适用于所有类型的文本生成任务？

**A:** 集束搜索适用于大多数文本生成任务，尤其是那些需要探索多种可能性、产生多样化的文本输出的任务。对于一些特定任务，如需要精确翻译或严格遵循特定格式的文本生成，集束搜索可能不是最优选择，这时可能需要结合其他策略，如贪心搜索或特定的规则指导。

## 5. 项目实践：代码实例和详细解释说明

### 5.1 开发环境搭建

在进行文本生成的集束搜索项目时，通常会使用Python语言，结合TensorFlow或PyTorch等深度学习库进行模型训练和生成。以下是一份基于PyTorch的简单文本生成代码示例：

```python
import torch
import torch.nn as nn
import torch.optim as optim

# 定义一个简单的RNN模型
class RNN(nn.Module):
    def __init__(self, vocab_size, embed_dim, hidden_dim, output_dim):
        super().__init__()
        self.embedding = nn.Embedding(vocab_size, embed_dim)
        self.rnn = nn.RNN(embed_dim, hidden_dim)
        self.fc = nn.Linear(hidden_dim, output_dim)

    def forward(self, input):
        embedded = self.embedding(input)
        output, _ = self.rnn(embedded)
        prediction = self.fc(output)
        return prediction

# 假设我们有以下的训练数据和超参数设置
vocab_size = 1000
embed_dim = 100
hidden_dim = 50
output_dim = vocab_size
learning_rate = 0.01
num_epochs = 100

# 初始化模型和优化器
model = RNN(vocab_size, embed_dim, hidden_dim, output_dim)
optimizer = optim.Adam(model.parameters(), lr=learning_rate)

# 假设这里已经定义了训练数据和数据加载器
# data_loader = ...

# 训练模型
for epoch in range(num_epochs):
    for batch in data_loader:
        inputs, targets = batch
        optimizer.zero_grad()
        predictions = model(inputs)
        loss = criterion(predictions, targets)
        loss.backward()
        optimizer.step()

# 保存模型
torch.save(model.state_dict(), 'model.pth')
```

### 5.2 源代码详细实现

这里以RNN模型为例，展示如何在训练之后使用集束搜索生成文本：

```python
import torch
import torch.nn.functional as F

def generate_text(model, start_sequence, max_length, device):
    model.eval()
    input_sequence = torch.tensor(start_sequence, dtype=torch.long, device=device)
    generated_sequence = input_sequence

    for _ in range(max_length - len(input_sequence)):
        with torch.no_grad():
            output = model(input_sequence)
            output = F.softmax(output[-1], dim=0)
            next_token_index = torch.multinomial(output, 1).item()
            input_sequence = torch.cat((input_sequence, torch.tensor([next_token_index], dtype=torch.long, device=device)), dim=-1)
            generated_sequence = torch.cat((generated_sequence, torch.tensor([next_token_index], dtype=torch.long, device=device)), dim=-1)

    return generated_sequence.tolist()

# 假设model已经加载了状态，start_sequence是开始生成的文本序列，max_length是生成的文本长度
device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')
generated_text = generate_text(model, start_sequence, max_length, device)
print(generated_text)
```

### 5.3 代码解读与分析

这段代码展示了如何基于已训练的RNN模型生成文本。首先定义了一个简单的RNN模型，然后进行了模型训练。接着，定义了一个`generate_text`函数，用于生成文本。该函数接收模型、起始序列、生成长度和设备作为参数。函数中，模型处于评估模式，以确保在生成文本时不进行反向传播。在生成过程中，逐个预测下一个最可能的单词，并将其添加到生成序列中，直到达到预设的生成长度。

### 5.4 运行结果展示

假设我们使用上述代码成功生成了一段文本：

```
['猫', '喵', '喵', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓', '抓',