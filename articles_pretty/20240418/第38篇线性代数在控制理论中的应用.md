# 第38篇 线性代数在控制理论中的应用

## 1. 背景介绍

### 1.1 控制理论概述

控制理论是一门研究如何控制动态系统行为的学科。它广泛应用于工业自动化、航空航天、机器人技术、电力系统等领域。控制理论的目标是设计控制器,使系统的输出跟踪期望的轨迹或保持在稳定状态。

### 1.2 线性代数在控制理论中的重要性

线性代数为控制理论提供了强有力的数学工具。许多控制系统可以用线性方程组或线性微分方程组来描述,线性代数为分析和设计这些系统提供了理论基础。特别是状态空间方法,将控制系统表示为一组一阶线性微分方程,使得线性代数在控制理论中发挥了关键作用。

## 2. 核心概念与联系

### 2.1 状态空间表示

状态空间表示是控制理论中描述动态系统的一种重要方法。它将系统用一组一阶线性微分方程来表示:

$$
\begin{aligned}
\dot{\mathbf{x}}(t) &= \mathbf{A} \mathbf{x}(t) + \mathbf{B} \mathbf{u}(t) \\
\mathbf{y}(t) &= \mathbf{C} \mathbf{x}(t) + \mathbf{D} \mathbf{u}(t)
\end{aligned}
$$

其中 $\mathbf{x}(t) \in \mathbb{R}^n$ 是系统的状态向量, $\mathbf{u}(t) \in \mathbb{R}^m$ 是控制输入, $\mathbf{y}(t) \in \mathbb{R}^p$ 是系统输出。$\mathbf{A} \in \mathbb{R}^{n \times n}$ 是系统矩阵, $\mathbf{B} \in \mathbb{R}^{n \times m}$ 是输入矩阵, $\mathbf{C} \in \mathbb{R}^{p \times n}$ 是输出矩阵, $\mathbf{D} \in \mathbb{R}^{p \times m}$ 是直通矩阵。

### 2.2 可控性与可观性

可控性是指通过适当的控制输入,能够将系统从任意初始状态转移到任意期望状态。可观性是指能够从系统的输出重构出系统的状态。它们分别由可控性矩阵和可观性矩阵来刻画:

$$
\begin{aligned}
\mathcal{C} &= \begin{bmatrix} \mathbf{B} & \mathbf{AB} & \cdots & \mathbf{A}^{n-1}\mathbf{B} \end{bmatrix} \\
\mathcal{O} &= \begin{bmatrix} \mathbf{C}^\top \\ \mathbf{C}^\top \mathbf{A}^\top \\ \vdots \\ \mathbf{C}^\top (\mathbf{A}^\top)^{n-1} \end{bmatrix}
\end{aligned}
$$

如果 $\mathcal{C}$ 的秩为 $n$, 则系统是可控的; 如果 $\mathcal{O}$ 的秩为 $n$, 则系统是可观的。

### 2.3 李雅普诺夫方程与稳定性

李雅普诺夫方程描述了系统在控制作用下的动态行为:

$$
\dot{\mathbf{V}}(t) = \frac{\partial \mathbf{V}}{\partial \mathbf{x}} \left( \mathbf{A}\mathbf{x}(t) + \mathbf{B}\mathbf{u}(t) \right)
$$

其中 $\mathbf{V}(t)$ 是一个正定标量函数,称为李雅普诺夫函数。如果存在一个 $\mathbf{V}(t)$ 使得 $\dot{\mathbf{V}}(t) < 0$,则系统是渐进稳定的。

## 3. 核心算法原理与具体操作步骤

### 3.1 极点配置

极点配置是一种重要的控制器设计方法,目标是通过状态反馈将系统的极点(特征值)配置到期望的位置,从而获得所需的动态性能。

#### 3.1.1 可控性标准形式

将系统矩阵 $\mathbf{A}$ 化为可控性标准形式:

$$
\mathbf{A}_c = \begin{bmatrix}
    0 & 1 & 0 & \cdots & 0 \\
    0 & 0 & 1 & \cdots & 0 \\
    \vdots & \vdots & \vdots & \ddots & \vdots \\
    0 & 0 & 0 & \cdots & 1 \\
    -a_0 & -a_1 & -a_2 & \cdots & -a_{n-1}
\end{bmatrix}
$$

其特征值为 $\lambda_i$ 满足特征方程:

$$
\lambda^n + a_{n-1}\lambda^{n-1} + \cdots + a_1\lambda + a_0 = 0
$$

#### 3.1.2 反馈矩阵设计

设计状态反馈控制律 $\mathbf{u}(t) = -\mathbf{K}\mathbf{x}(t) + \mathbf{r}(t)$, 使闭环系统矩阵 $\mathbf{A} - \mathbf{B}\mathbf{K}$ 的特征值等于期望的极点 $\lambda_i^d$。反馈矩阵 $\mathbf{K}$ 可由 Ackermann 公式计算:

$$
\mathbf{K} = \begin{bmatrix} k_1 & k_2 & \cdots & k_n \end{bmatrix} = \begin{bmatrix} a_0^d - a_0 & a_1^d - a_1 & \cdots & a_{n-1}^d - a_{n-1} \end{bmatrix} \mathcal{C}^{-1}
$$

其中 $a_i^d$ 为期望特征方程的系数。

### 3.2 最优控制

最优控制旨在寻找使某个性能指标最优的控制输入。

#### 3.2.1 线性二次型性能指标

线性二次型性能指标为:

$$
J = \frac{1}{2} \int_0^\infty \left( \mathbf{x}^\top(t)\mathbf{Q}\mathbf{x}(t) + \mathbf{u}^\top(t)\mathbf{R}\mathbf{u}(t) \right) \mathrm{d}t
$$

其中 $\mathbf{Q} \geq 0$ 是半正定矩阵, $\mathbf{R} > 0$ 是正定矩阵,分别对应状态和控制的权重。

#### 3.2.2 无终端状态的最优控制

对于无终端状态约束的情况,最优控制律为:

$$
\mathbf{u}^*(t) = -\mathbf{R}^{-1}\mathbf{B}^\top\mathbf{P}\mathbf{x}(t)
$$

其中 $\mathbf{P}$ 是代数里卡提方程的唯一半正定解:

$$
\mathbf{A}^\top\mathbf{P} + \mathbf{P}\mathbf{A} - \mathbf{P}\mathbf{B}\mathbf{R}^{-1}\mathbf{B}^\top\mathbf{P} + \mathbf{Q} = 0
$$

#### 3.2.3 有终端状态约束的最优控制

对于有终端状态约束 $\mathbf{x}(T) = \mathbf{x}_T$ 的情况,最优控制律为:

$$
\mathbf{u}^*(t) = -\mathbf{R}^{-1}\mathbf{B}^\top\left( \mathbf{S}(t)\mathbf{x}(t) + \mathbf{s}(t) \right)
$$

其中 $\mathbf{S}(t)$ 和 $\mathbf{s}(t)$ 满足矩阵微分方程:

$$
\begin{aligned}
\dot{\mathbf{S}}(t) &= -\mathbf{Q} - \mathbf{S}(t)\mathbf{A} - \mathbf{A}^\top\mathbf{S}(t) + \mathbf{S}(t)\mathbf{B}\mathbf{R}^{-1}\mathbf{B}^\top\mathbf{S}(t) \\
\dot{\mathbf{s}}(t) &= -\mathbf{S}(t)\mathbf{B}\mathbf{R}^{-1}\mathbf{B}^\top\mathbf{s}(t) - \mathbf{Q}\mathbf{x}_T
\end{aligned}
$$

且有终端条件 $\mathbf{S}(T) = 0$, $\mathbf{s}(T) = 0$。

## 4. 数学模型和公式详细讲解举例说明

### 4.1 状态空间模型

考虑一个质量为 $m$、阻尼系数为 $b$、弹性系数为 $k$ 的质量-弹簧-阻尼系统。它的运动方程为:

$$
m\ddot{x}(t) + b\dot{x}(t) + kx(t) = u(t)
$$

令 $x_1(t) = x(t)$, $x_2(t) = \dot{x}(t)$, 则可写成状态空间形式:

$$
\begin{aligned}
\begin{bmatrix} \dot{x}_1(t) \\ \dot{x}_2(t) \end{bmatrix} &= \begin{bmatrix} 0 & 1 \\ -\frac{k}{m} & -\frac{b}{m} \end{bmatrix} \begin{bmatrix} x_1(t) \\ x_2(t) \end{bmatrix} + \begin{bmatrix} 0 \\ \frac{1}{m} \end{bmatrix} u(t) \\
y(t) &= \begin{bmatrix} 1 & 0 \end{bmatrix} \begin{bmatrix} x_1(t) \\ x_2(t) \end{bmatrix}
\end{aligned}
$$

其中 $\mathbf{A} = \begin{bmatrix} 0 & 1 \\ -\frac{k}{m} & -\frac{b}{m} \end{bmatrix}$, $\mathbf{B} = \begin{bmatrix} 0 \\ \frac{1}{m} \end{bmatrix}$, $\mathbf{C} = \begin{bmatrix} 1 & 0 \end{bmatrix}$。

### 4.2 可控性与可观性分析

对于上述系统,可控性矩阵为:

$$
\mathcal{C} = \begin{bmatrix} 0 & \frac{1}{m} \\ \frac{1}{m} & -\frac{b}{m^2} \end{bmatrix}
$$

由于 $\mathcal{C}$ 的秩为 2,因此系统是可控的。

可观性矩阵为:

$$
\mathcal{O} = \begin{bmatrix} 1 \\ 0 \end{bmatrix}
$$

由于 $\mathcal{O}$ 的秩也为 2,因此系统是可观的。

### 4.3 极点配置示例

假设我们希望将系统的极点配置为 $\lambda_1 = -2$, $\lambda_2 = -3$,即特征方程为:

$$
(\lambda + 2)(\lambda + 3) = \lambda^2 + 5\lambda + 6 = 0
$$

对比可控性标准形式,我们有 $a_0 = 6$, $a_1 = 5$。利用 Ackermann 公式计算反馈矩阵:

$$
\mathbf{K} = \begin{bmatrix} 6 - (-\frac{k}{m}) & 5 - (-\frac{b}{m}) \end{bmatrix} \mathcal{C}^{-1} = \begin{bmatrix} \frac{6m + k}{m} & \frac{5m + b}{m} \end{bmatrix}
$$

则状态反馈控制律为:

$$
u(t) = -\begin{bmatrix} \frac{6m + k}{m} & \frac{5m + b}{m} \end{bmatrix} \begin{bmatrix} x_1(t) \\ x_2(t) \end{bmatrix} + r(t)
$$

使得闭环系统的极点为 $\lambda_1 = -2$, $\lambda_2 = -3$。

### 4.4 最优控制示例

考虑上述质量-弹簧-阻尼系统,设置性能指标为:

$$
J = \frac{1}{2} \int_0^\infty \left( x^2(t) + \dot{x}^2(t) + u^2(t) \right) \mathrm{d}t
$$

对应的 $\mathbf{Q} = \begin{bmatrix} 1 & 0 \\ 0 & 1 \end{bmatrix}$, $\mathbf{R} = 1$。

求解代数里卡提方程得到 $\mathbf{P}$,则无终端状态约束的最优控制律为:

$$
u^*(t) = -\begin{bmatrix} p_{11} & p_{12} \end{bmatrix} \begin{bmatrix} x_1(