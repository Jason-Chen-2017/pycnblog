# 辛几何引论：§6.流形上的辛结构

## 1.背景介绍
### 1.1 辛几何的起源与发展
辛几何是现代微分几何的一个重要分支,它起源于19世纪Hamilton对力学系统的研究。Hamilton发现,许多力学系统可以用一个偶对称的二次型(即辛结构)来描述,由此开创了辛几何的先河。20世纪60年代,在Arnold、Maslov、Weinstein等数学家的推动下,辛几何得到了蓬勃发展,并与拓扑、代数、分析等数学分支形成了深刻的联系。

### 1.2 辛几何的应用
辛几何不仅是一个深刻优美的数学理论,更在物理、力学、控制论等领域有着广泛的应用。在经典力学中,相空间就是一个辛流形,Hamilton方程描述了系统的演化。在量子力学中,Hilbert空间(态空间)也有辛结构。在几何光学、经典场论、相对论等领域,辛几何也扮演着不可或缺的角色。可以说,辛几何已经成为现代物理的数学基础之一。

## 2.核心概念与联系
### 2.1 辛流形与辛结构
辛流形(symplectic manifold)是一个偶数维流形$M^{2n}$,配备了一个封闭的非退化的二次型$\omega$,称为辛形式(symplectic form)。在局部坐标$(x^1,\cdots,x^n,y_1,\cdots,y_n)$下,$\omega$可以写成
$$\omega=\sum_{i=1}^n dx^i\wedge dy_i$$

辛结构可以看作是流形上的一种几何结构,它赋予了流形一些特殊的性质,如定向性、Darboux定理等。

### 2.2 Hamilton向量场与Hamilton方程
设$(M,\omega)$为辛流形,Hamilton函数$H: M\to \mathbb{R}$,则存在唯一的向量场$X_H$满足
$$\iota_{X_H}\omega=dH$$
其中$\iota_{X_H}$表示缩并算子。$X_H$称为Hamilton向量场,它刻画了Hamilton系统的演化。在Darboux坐标下,Hamilton方程可以写成
$$\begin{aligned}
\frac{dx^i}{dt}&=\frac{\partial H}{\partial y_i}\\
\frac{dy_i}{dt}&=-\frac{\partial H}{\partial x^i}
\end{aligned}$$

### 2.3 Poisson括号与辛同胚
设$f,g$为辛流形$M$上的光滑函数,定义它们的Poisson括号为
$${f,g}=\omega(X_f,X_g)$$
Poisson括号满足反对称性、Jacobi等式,使得光滑函数构成一个李代数。

保持辛形式的微分同胚$\varphi:M\to M$称为辛同胚(symplectomorphism)。辛同胚保持Hamilton方程形式不变,在经典力学中代表对称变换。辛同胚群是辛几何的重要研究对象。

### 2.4 Lagrange子流形与Arnold猜想
$M$的子流形$L$称为Lagrange子流形,如果$\omega$在$L$上恒为0,且$\dim L=\frac{1}{2}\dim M$。Lagrange子流形在半经典量子化、镜像对称等问题中有重要作用。

Arnold猜想断言,Lagrange同调群$H_*(L;\mathbb{Z})$给出了$L$在$M$中的交叉信息。Arnold猜想激发了辛拓扑的发展,揭示了辛几何与低维拓扑的深刻联系。

## 3.核心算法原理具体操作步骤
### 3.1 构造辛流形的基本步骤
1. 给定一个偶数维流形$M^{2n}$。
2. 在$M$上构造一个非退化的封闭二形式$\omega$。通常可以先在局部坐标系下给出$\omega$的表达式,再用分拆单位将其粘合成全局的形式。
3. 验证$\omega$的非退化性与封闭性。非退化性等价于$\omega^n$处处不为0;封闭性等价于外微分$d\omega=0$。
4. (可选)求出$\omega$的基本示性类如Chern类、Maslov类等,刻画流形的拓扑性质。

### 3.2 求解Hamilton方程的算法
考虑Hamilton系统$(M,\omega,H)$,求解Hamilton方程的步骤如下:
1. 求出Hamilton向量场$X_H$。在Darboux坐标下,$X_H$的表达式为
$$X_H=\sum_{i=1}^n(\frac{\partial H}{\partial y_i}\frac{\partial}{\partial x^i}-\frac{\partial H}{\partial x^i}\frac{\partial}{\partial y_i})$$
2. 将$X_H$代入Hamilton方程,得到关于$(x^i(t),y_i(t))$的常微分方程组。 
3. 给定初始条件$(x^i(0),y_i(0))$,用数值方法(如Runge-Kutta法)求解常微分方程组,得到系统的演化轨道$(x^i(t),y_i(t))$。
4. (可选)作出相空间中系统演化的相图,分析其定性行为如平衡点、周期轨道等。

### 3.3 构造辛同胚的方法
设$(M,\omega)$为辛流形,构造其辛同胚的基本方法有:
1. Hamilton流法。对Hamilton函数$H$,其Hamilton向量场$X_H$生成的流$\varphi_t$是辛同胚。
2. 生成函数法。设$S:M\to\mathbb{R}$为光滑函数,则其梯度映射$\nabla S$在$\omega$意义下是辛同胚。
3. Lie群作用法。设$G$为Lie群,且$G$在$M$上的左(右)作用保持$\omega$,则$G$通过左(右)平移诱导了$M$上的辛同胚。
4. Moser技巧。设$\omega_0,\omega_1$为$M$上的辛形式,满足$[\omega_0]=[\omega_1]$,则存在辛同胚$\varphi$使得$\varphi^*\omega_1=\omega_0$。

## 4.数学模型和公式详细讲解举例说明
### 4.1 简谐振子的辛模型
考虑一维简谐振子,其Hamilton量为
$$H(x,y)=\frac{1}{2}(y^2+\omega^2x^2)$$
其中$x$为位移,$y$为动量,$\omega$为角频率。引入复坐标$z=x+iy$,则Hamilton量可以写成
$$H(z)=\frac{\omega}{2}|z|^2$$
相空间为复平面$\mathbb{C}$,其上的辛形式为
$$\omega=\frac{i}{2}dz\wedge d\bar{z}$$
Hamilton方程简化为
$$\frac{dz}{dt}=-i\omega z$$
其解为$z(t)=e^{-i\omega t}z(0)$,表示复平面上的匀速圆周运动。

### 4.2 刚体运动的辛约化
考虑三维刚体绕固定点的转动,其构型空间为旋转群$SO(3)$,动量空间为其对偶$\mathfrak{so}(3)^*$,相空间为余切丛$T^*SO(3)$。系统的Hamilton量为
$$H(R,\Pi)=\frac{1}{2}\langle\Pi,\mathbb{I}^{-1}\Pi\rangle$$
其中$R\in SO(3)$为姿态矩阵,$\Pi\in\mathfrak{so}(3)^*$为角动量,$\mathbb{I}$为惯量张量,$\langle\cdot,\cdot\rangle$为$\mathfrak{so}(3)$上的对偶配对。

注意到$H$有$SO(3)$的左平移对称性,我们可以将其约化到Euler-Poinsot空间$\mathfrak{so}(3)^*$上。约化后的辛形式为Lie-Poisson括号
$$\{f,g\}_{\pm}(\Pi)=\pm\langle\Pi,[\nabla f(\Pi),\nabla g(\Pi)]\rangle$$
其中$[\cdot,\cdot]$为$\mathfrak{so}(3)$的李括号。约化后的Hamilton方程为欧拉方程
$$\frac{d\Pi}{dt}=\Pi\times\Omega$$
其中$\Omega=\mathbb{I}^{-1}\Pi$为角速度向量。这表明角动量在体坐标系下的分量满足欧拉运动方程。

## 5.项目实践：代码实例和详细解释说明
下面我们用Python的Sympy库来模拟简谐振子的Hamilton方程数值解。

```python
from sympy import symbols, Matrix, exp, I, pi, sin, cos
from sympy.physics.mechanics import dynamicsymbols
from sympy.physics.vector import ReferenceFrame
from sympy.plotting import plot_parametric

# 定义符号变量
x, y, t, omega = symbols('x y t omega')
H = omega/2 * (x**2 + y**2)  # Hamilton量

# 定义Hamilton方程
dxdt = H.diff(y) 
dydt = -H.diff(x)

# 数值求解Hamilton方程
N = ReferenceFrame('N')  
z = dynamicsymbols('z')
st = {x: z.re(), y: z.im()}
dzdt_st = dxdt.subs(st) + I*dydt.subs(st) 
dzdt_func = lambdify(z, dzdt_st)

def integrate(ic, ti, tf, n, omega_val):
    dt = (tf-ti)/n
    z_t = ic
    t_list = [ti]
    z_list = [ic]
    for i in range(n):
        t_i = ti + i*dt
        z_i = z_t
        k1 = dzdt_func(z_i).subs(omega, omega_val)
        k2 = dzdt_func(z_i + dt/2*k1).subs(omega, omega_val)
        k3 = dzdt_func(z_i + dt/2*k2).subs(omega, omega_val)
        k4 = dzdt_func(z_i + dt*k3).subs(omega, omega_val)
        z_t = z_i + dt/6*(k1 + 2*k2 + 2*k3 + k4)
        t_list.append(t_i+dt)
        z_list.append(z_t)
    return (t_list, z_list)

# 设置初值与参数
ic = 1 + 2*I
ti = 0
tf = 2*pi
n = 500
omega_val = 1

# 数值积分
t_list, z_list = integrate(ic, ti, tf, n, omega_val)

# 绘制相图
x_list = [z.re() for z in z_list]  
y_list = [z.im() for z in z_list]
plot_parametric(x_list, y_list, (t,0,tf), axis_center=(0,0))
```

代码解释如下:
1. 首先定义了符号变量$x,y,t,\omega$,并由此构造Hamilton量$H$。
2. 根据$H$写出Hamilton方程$\frac{dx}{dt},\frac{dy}{dt}$。
3. 引入复坐标$z=x+iy$,将Hamilton方程改写为关于$z$的复变函数方程$\frac{dz}{dt}$。
4. 定义数值积分函数`integrate`,用四阶Runge-Kutta法求解Hamilton方程。
5. 设置初值$z(0)=1+2i$,时间区间$[0,2\pi]$,频率$\omega=1$,数值积分得到$z(t)$的近似解。
6. 提取$z(t)$的实部、虚部,绘制相平面图像,得到简谐振子的圆周运动轨道。

该算法展示了如何用辛几何的视角分析简谐振子,并用数值方法模拟其Hamilton方程的解。

## 6.实际应用场景
辛几何在物理、力学、控制等领域有着广泛的应用,下面列举几个典型的应用场景。

### 6.1 天体力学中的辛积分器
在数值模拟太阳系、星系等天体力学系统时,长期轨道的稳定性至关重要。传统的数值积分算法如Runge-Kutta法通常不能长期保持系统的辛结构,导致模拟轨道漂移。而基于辛几何的辛积分器如Gauss-Legendre Runge-Kutta法,能够很好地保持Hamilton系统的辛结构,在长期轨道模拟中展现出独特的优势。

### 6.2 流体力学中的Clebsch表示
不可压缩理想流体的运动可以用欧拉方程描述,即
$$\frac{\partial\mathbf{u}}{\partial t}+\mathbf{u}\cdot\nabla\mathbf{u}=-\nabla p$$
其中$\mathbf{u}$为速度场,$p$为压强。欧拉方程具有辛结构,可以用Clebsch表示将其Hamilton化:
$$\