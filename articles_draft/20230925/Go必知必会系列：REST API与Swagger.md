
ä½œè€…ï¼šç¦…ä¸è®¡ç®—æœºç¨‹åºè®¾è®¡è‰ºæœ¯                    

# 1.ç®€ä»‹
  

## REST (Representational State Transfer)
REST æ˜¯ä¸€ç§åŸºäºHTTPåè®®çš„è®¾è®¡é£æ ¼ï¼Œå…¶æ—¨åœ¨æä¾›ä¸€å¥—ç»Ÿä¸€çš„æ¥å£è§„èŒƒã€åè®®ï¼Œé€šè¿‡äº’è”ç½‘ä¸Šçš„è®¡ç®—æœºä¹‹é—´è¿›è¡Œé€šä¿¡ã€‚REST ç”±ä»¥ä¸‹å‡ ä¸ªåŸºæœ¬è¦ç´ ç»„æˆ:

1. èµ„æºï¼ˆResourceï¼‰ï¼šç½‘ç»œä¸­çš„ä¸€ä¸ªå®ä½“ï¼Œä¾‹å¦‚ä¸€ä¸ªç½‘ç«™æˆ–è€…ä¸€ä¸ªå¯¹è±¡ã€‚å®ƒé€šå¸¸æ˜¯ä¸€ä¸ªåè¯ï¼Œå¦‚ customer æˆ– order ï¼Œæ—¢å¯æŒ‡ä»£å…·ä½“äº‹ç‰©ï¼Œä¹Ÿå¯æŒ‡ä»£æŠ½è±¡äº‹ç‰©çš„é›†åˆã€‚
2. è¡¨è¿°æ€§çŠ¶æ€è½¬ç§»ï¼ˆRepresentational State Transferï¼‰ï¼šå¯¹èµ„æºçš„ä¸€ä¸ªç‰¹å®šè¡¨ç¤ºå½¢å¼ï¼Œå®ƒæè¿°äº†èµ„æºçš„çŠ¶æ€ã€ç»“æ„ä»¥åŠå…³ç³»ç­‰ä¿¡æ¯ï¼Œå¹¶é€šè¿‡ HTTP æ–¹æ³•å¯¹å…¶è¿›è¡Œæ“ä½œã€‚
3. URLï¼ˆUniform Resource Locatorï¼‰ï¼šç”¨æ¥å”¯ä¸€æ ‡è¯†ä¸€ä¸ªèµ„æºæˆ–æœåŠ¡ï¼Œå®ƒä½¿å®¢æˆ·ç«¯èƒ½å¤Ÿåœ¨æŒ‡å®šåœ°å€å’Œç«¯å£ä¸Šæ‰¾åˆ°è¯¥èµ„æºæˆ–æœåŠ¡ã€‚
4. æ–¹æ³•ï¼ˆMethodï¼‰ï¼šç”¨æ¥å¯¹èµ„æºæ‰§è¡ŒæŸç§æ“ä½œã€‚HTTP/1.1 å…±å®šä¹‰äº†ä¸ƒç§æ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯ GETã€POSTã€PUTã€DELETEã€PATCHã€HEAD å’Œ OPTIONSã€‚
5. è¶…åª’ä½“ï¼ˆHypermediaï¼‰ï¼šä½œä¸ºé¢å‘å¯¹è±¡çš„åˆ†å¸ƒå¼ç³»ç»Ÿé—´çš„é€šä¿¡åè®®ï¼Œå…¶æœ€é‡è¦ç‰¹ç‚¹å°±æ˜¯å¯ç”¨çš„é“¾æ¥å¯ä»¥å°†ç”¨æˆ·ä»ä¸€ä¸ªä½ç½®ç›´æ¥è·³åˆ°å¦ä¸€ä¸ªä½ç½®ï¼Œå› æ­¤å®ƒä¿ƒè¿›äº† Web çš„å¯æ‰©å±•æ€§ã€‚
6. çŠ¶æ€ç ï¼ˆStatus Codeï¼‰ï¼šæœåŠ¡å™¨è¿”å›ç»™å®¢æˆ·ç«¯çš„å“åº”ä¿¡æ¯ï¼Œç”¨äºæç¤ºè¯·æ±‚æˆåŠŸã€èµ„æºå·²åˆ›å»ºã€å¤„ç†å¤±è´¥ç­‰å„ç§æƒ…å†µã€‚
7. æ¶ˆæ¯ä½“ï¼ˆMessage Bodyï¼‰ï¼šç”¨æ¥ä¼ è¾“å®é™…æ•°æ®ã€‚æ¶ˆæ¯ä½“æ˜¯å¯é€‰çš„ï¼Œæ¯”å¦‚ POST è¯·æ±‚ä¸­å°±å¯ä»¥ä¸å¸¦æ¶ˆæ¯ä½“ã€‚

é™¤äº†ä»¥ä¸Šä¸ƒä¸ªå…ƒç´ ï¼Œè¿˜æœ‰ä¸€äº›å…¶ä»–çº¦æŸæ¡ä»¶å’Œå»ºè®®ï¼š

1. æ— çŠ¶æ€ï¼šæ‰€æœ‰çš„èµ„æºéƒ½åº”è¯¥æ˜¯æ— çŠ¶æ€çš„ï¼Œå› ä¸ºä»»ä½•éœ€è¦ç»´æŠ¤çŠ¶æ€çš„ä¿¡æ¯éƒ½åº”è¯¥é€šè¿‡ URL è¿›è¡Œå®šä½ã€‚æ‰€ä»¥ï¼Œä»»ä½•éœ€è¦è®°å½•å®¢æˆ·ç«¯ä¿¡æ¯çš„åœºåˆï¼Œéƒ½ä¸è¦ä½¿ç”¨ HTTP åè®®ã€‚
2. å¯ç¼“å­˜ï¼šåœ¨æ€§èƒ½æ–¹é¢ï¼Œå°½é‡ä½¿ç”¨ç¼“å­˜æœºåˆ¶ï¼Œå‡å°‘ä¸å¿…è¦çš„é‡å¤è¯·æ±‚ï¼Œæé«˜æ•ˆç‡ã€‚
3. åˆ†å±‚ç³»ç»Ÿï¼šåˆ†å±‚ç³»ç»Ÿå…è®¸æœåŠ¡ç«¯åŒæ—¶æä¾›å¤šä¸ªçº§åˆ«çš„APIï¼Œæ¯ä¸€å±‚éƒ½æä¾›æ›´åŠ å…·ä½“çš„åŠŸèƒ½ï¼Œä¾‹å¦‚ç”¨æˆ·ã€è®¢å•ã€è¯„è®ºç­‰ã€‚
4. æŒ‰éœ€ç¼–ç ï¼šåªæä¾›å¿…è¦çš„æ¥å£ï¼Œä¿è¯æ•´ä½“çš„ç®€å•æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚
5. æ¥å£ç‰ˆæœ¬æ§åˆ¶ï¼šå¦‚æœ API æœ‰æ›´æ–°ï¼Œè¦åˆ›å»ºä¸€ä¸ªæ–°çš„ç‰ˆæœ¬è€Œä¸æ˜¯ä¿®æ”¹æ—§ç‰ˆæ¥å£ã€‚

## Swagger
Swagger æ˜¯ä¸€æ¬¾å¼€æºå·¥å…·ï¼Œå®ƒæä¾›äº†ä¸€å¥—å®šä¹‰ã€æè¿°ã€äº§ç”Ÿã€æ¶ˆè´¹ RESTful API çš„æ–¹å¼ï¼Œå¸®åŠ©å¼€å‘è€…è®¾è®¡ã€æ„å»ºã€ä½¿ç”¨ RESTful APIs ã€‚
Swagger ä½¿ç”¨ YAML æˆ–è€… JSON æ–‡ä»¶æ¥å®šä¹‰ RESTful API çš„æ¥å£åŠç›¸å…³å±æ€§ï¼ŒåŒ…æ‹¬è·¯å¾„ã€å‚æ•°ã€å“åº”ã€æ–¹æ³•ã€å¤´éƒ¨ç­‰ã€‚é€šè¿‡ Swagger-UI å¯ä»¥æ–¹ä¾¿åœ°æµè§ˆ API çš„æ–‡æ¡£ã€è°ƒè¯• API æ“ä½œï¼Œå¹¶ä¸åç«¯å®ç°è‡ªåŠ¨ç”Ÿæˆä»£ç ã€‚

æœ¬æ–‡ä¸»è¦è®²è§£å¦‚ä½•åˆ©ç”¨ Swagger æ¥å®ç° GO è¯­è¨€ç¼–å†™çš„ REST APIã€‚
# 2.å‰æœŸå‡†å¤‡å·¥ä½œ
```
go version
```
æ¥ä¸‹æ¥ï¼Œä½ éœ€è¦å®‰è£… Swagger æ’ä»¶ï¼Œå¯ä»¥åœ¨ç»ˆç«¯æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š
```
go get -u github.com/swaggo/swag/cmd/swag
```
æ­¤æ—¶ï¼ŒSwagger æ’ä»¶å°±å®‰è£…å¥½äº†ï¼Œå¯ä»¥ä½¿ç”¨ `swag init` å‘½ä»¤æ¥åˆå§‹åŒ–ä½ çš„é¡¹ç›®ã€‚

ç„¶åï¼Œæˆ‘ä»¬å°±å¯ä»¥ç¼–å†™æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ª REST API äº†ï¼ğŸ˜
# 3.ç¼–å†™ä½ çš„ç¬¬ä¸€ä¸ª REST API
## åˆå§‹åŒ–é¡¹ç›®æ–‡ä»¶å¤¹
é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç©ºçš„æ–‡ä»¶å¤¹ï¼Œç„¶åè¿›å…¥è¿™ä¸ªæ–‡ä»¶å¤¹ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š
```
swag init --generalInfo./cmd/main.go --output docs
```
å…¶ä¸­ `./cmd/main.go` æŒ‡å®šçš„æ˜¯é¡¹ç›®çš„å…¥å£æ–‡ä»¶ï¼Œä¸€èˆ¬æƒ…å†µä¸‹é»˜è®¤æ˜¯ `main.go`ï¼Œ`--generalInfo` æŒ‡å®šçš„æ˜¯ä¸€äº›é€šç”¨é…ç½®ï¼Œæ¯”å¦‚ä½œè€…ã€é¡¹ç›®åç§°ç­‰ï¼›`--output` æŒ‡å®šçš„æ˜¯è¾“å‡ºæ–‡ä»¶çš„ç›®å½•ï¼Œè¿™é‡Œæˆ‘ä»¬æŒ‡å®šçš„æ˜¯ `docs`ã€‚æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œä½ ä¼šçœ‹åˆ°å¦‚ä¸‹ç›®å½•ç»“æ„ï¼š
```
â”œâ”€â”€ cmd
â”‚   â””â”€â”€ main.go    // your project's entry file
â””â”€â”€ docs
    â”œâ”€â”€ docs.go     // auto generated by swag command, don't modify it manually.
    â”œâ”€â”€ swagger
    â”‚   â””â”€â”€ swagger.json   // swagger api definition file
    â””â”€â”€ swagger.yaml    // general configuration file for the project
```
## åˆ›å»ºä¸€ä¸ªç®€å•çš„ API
æˆ‘ä»¬å…ˆæ¥ç¼–å†™ä¸€ä¸ª APIï¼Œç”¨äºæ·»åŠ å­¦ç”Ÿä¿¡æ¯ã€‚åœ¨ `cmd` æ–‡ä»¶å¤¹é‡Œåˆ›å»ºä¸€ä¸ªåä¸º `student.go` çš„æ–‡ä»¶ï¼Œè¾“å…¥ä»¥ä¸‹ä»£ç ï¼š
```go
package main

import "net/http"

// @title Student API
// @version 1.0
// @description This is a sample student server.

func addStudent(w http.ResponseWriter, r *http.Request) {
  w.Write([]byte("Add student information"))
}

func deleteStudent(w http.ResponseWriter, r *http.Request) {
  w.Write([]byte("Delete student information"))
}

func updateStudent(w http.ResponseWriter, r *http.Request) {
  w.Write([]byte("Update student information"))
}

func getStudents(w http.ResponseWriter, r *http.Request) {
  w.Write([]byte("Get all students' information"))
}

func getStudentById(w http.ResponseWriter, r *http.Request) {
  w.Write([]byte("Get student's information based on id"))
}

func registerRoutes() {
  mux := http.NewServeMux()

  // Register handlers for routes
  mux.HandleFunc("/students", addStudent)
  mux.HandleFunc("/students/{id}", deleteStudent)
  mux.HandleFunc("/students/{id}/update", updateStudent)
  mux.HandleFunc("/students", getStudents)
  mux.HandleFunc("/students/{id}", getStudentById)

  return mux
}

func main() {
  // Start server with port number and route handler function
  http.ListenAndServe(":8080", registerRoutes())
}
```
è¿™é‡Œæˆ‘ä»¬åªæ˜¯å®šä¹‰äº†äº”ä¸ªè·¯ç”±å‡½æ•°ï¼Œä½†æ˜¯è¿™äº›å‡½æ•°å¹¶æ²¡æœ‰å®é™…çš„å®ç°ã€‚æˆ‘ä»¬è¿˜éœ€è¦åœ¨ `registerRoutes()` å‡½æ•°ä¸­æ³¨å†Œè¿™äº›è·¯ç”±ï¼š
```go
mux := http.NewServeMux()

// Add more routes to mux
mux.Handle("/students/", http.StripPrefix("/students", s.router))

return mux
```
è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è®¿é—® `/students/` è·¯å¾„ä¸‹çš„è·¯ç”±äº†ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦æŠŠè¿™äº›ä»£ç ç¼–è¯‘æˆå¯æ‰§è¡Œæ–‡ä»¶ï¼š
```
go build -o myserver.
```
è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿è¡Œè¿™ä¸ªå¯æ‰§è¡Œæ–‡ä»¶æ¥å¯åŠ¨æˆ‘ä»¬çš„æœåŠ¡å™¨äº†ï¼š
```
./myserver
```
å¦‚æœä½ è®¿é—® `http://localhost:8080/swagger/index.html`ï¼Œå°±ä¼šçœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„é¡µé¢ï¼š
ç‚¹å‡»å³ä¾§çš„ `Try it out` æŒ‰é’®ï¼Œå°±å¯ä»¥å°è¯•è°ƒç”¨æˆ‘ä»¬çš„ API äº†ï¼š