
作者：禅与计算机程序设计艺术                    

# 1.简介
  

随着物联网（IoT）技术的兴起、应用普及和商业落地，越来越多的人将其视作“杀手级”技术。近年来，由于各种各样的安全漏洞、攻击行为等造成了重大影响，导致众多企业、组织和个人受到经济损失、商誉损害甚至法律纠纷等损害。因此，为了保护好在物联网领域运行的公司和设备，企业和政府都在加紧部署相关的安全措施。物联网安全架构设计的目的就是基于现有的安全技术和网络安全体系，制定并实现一个符合企业需求、可靠、高效、不断演进的安全解决方案。该方案应满足以下要求：

⑴ 有助于保障关键设备安全；

⑵ 有利于对抗网络安全攻击；

⑶ 可自动化执行；

⑷ 可以有效监控设备状态；

⑸ 提供灵活的应急响应机制；

⑹ 能够处理复杂环境中的异构威胁。

本文将根据物联网安全的特征和国内外安全经验，提出一种物联网安全架构设计方案，并结合当前行业的安全实践进行阐述。
# 2.基本概念术语说明
## 2.1物联网定义
物联网（Internet of Things，简称IoT），亦称“物流网”，是一种网络技术，由一组由互联网协议(IP)连接的、能够感知并与其他物体交互的硬件或软件组件组成。这些物体被称为“物体”、“设备”或“传感器”。每个设备通常都包含数字传感器，可以采集到信息或外部事件，通过网络把这些信息发送给云端服务器进行分析处理，从而产生运营数据、执行预设的动作或控制其他设备。

## 2.2物联网安全术语
### 2.2.1物联网安全风险
物联网安全风险(IoT security risk)，是指通过物联网技术传输、处理或存储数据的能力可能被恶意攻击、篡改、破坏或者泄露所造成的社会、经济、政治和安全隐患。物联网安全风险包括如下几类:

⑴ 数据窃取风险(Data theft risk)：物联网设备或系统的主人不慎遗失或泄露设备上的数据而非法获取。

⑵ 篡改风险(Tampering risk)：未经授权的攻击者利用物联网技术对设备、数据、系统等资源进行篡改、修改或破坏。

⑶ 拒绝服务风险(Denial-of-service risk)：黑客利用物联网技术向目标设备发起拒绝服务攻击。

⑷ 欺诈欺骗风险(Fraud and deceptive risk)：冒用他人的身份、用虚假的财产信息骗取交易或欺诈他人。

⑸ 数据泄露风险(Data disclosure risk)：未经授权的攻击者截获设备或系统上敏感数据并使用。

⑹ 不必要的数据收集风险(Unnecessary data collection risk)：未经用户同意收集设备或系统上的信息，造成信息泄露。

⑺ 对人员的威胁风险(Threat to human being risk)：物联网设备或系统可能产生恶性毒害、疾病和死亡的危险。

### 2.2.2物联网安全威胁模型
物联网安全威胁模型，即基于物联网安全威胁的分析方法。它主要分为两类:静态威胁模型和动态威胁模型。

静态威胁模型是建立在对网络结构、协议、和应用程序功能的理解基础上，对系统可能出现的威胁类型和相应的防御措施进行分类和描述。静态威胁模型又可分为：

⑴ 边界威胁模型：边界威胁模型是指与物联网设备的边界通信和交互时可能发生的安全威胁，如通信线路不畅、设备之间数据传输存在缺陷、恶意编程、未经授权的访问等。

⑵ 自然威胁模型：自然威胁模型是指由于天气变化、地震、自然灾害等自然因素引发的物联网设备可能会遭受的安全威胁，如对传输数据存在明显延迟、黑客攻击、电力中断等。

⑶ 分布式威胁模型：分布式威胁模型是指物联网设备和它们之间的互连可能会触发的安全威胁，如电信网络中的攻击、电子邮件中的垃圾邮件、移动支付中恶意第三方渠道等。

动态威胁模型是建立在实时的网络流量、数据、应用程序和设备的观察基础上，反映网络暴露、系统攻击、入侵行为等的发生频率、规模和复杂程度。动态威胁模型又可分为：

⑴ 突发性威胁模型：突发性威胁模型是指偶然发生的安全威胁，如重大火灾、恶意爆炸、网络入侵等。

⑵ 漏洞扫描威胁模型：漏洞扫描威胁模型是指对设备和系统进行配置更新、关键补丁安装后可能会出现的安全威胁。

⑶ 黑盒威胁模型：黑盒威胁模型是指对系统的整体行为、系统状态以及关键数据进行深度挖掘分析，分析可能的攻击方式和威胁，以便能够预测、评估和抵御未来的安全威胁。

### 2.2.3物联网安全策略
物联网安全策略(IoT security policy)，是在对物联网安全风险进行评估和分析之后，形成的一套安全策略。该策略主要包含以下内容：

⑴ 安全态势管理：包括物联网安全技术水平评估、安全事件跟踪、安全事件响应与处置、网络安全建设与优化等。

⑵ 安全技术培训：包括物联网安全领域的专业技术人员培训、网络安全设备认证、安全工具使用等。

⑶ 安全工作流程制定：包括安全事件的发现、诊断和分析、安全风险的识别和整改，以及系统的保护和检测等。

⑷ 安全态势报告：包括在各个安全环节发布有关安全态势的报告。

⑸ 政策法规与标准制定：包括物联网安全政策和法规的制定，如安全保密协议、个人信息保护标准、网络安全等方面的标准。

### 2.2.4安全设计原则
安全设计原则是指对物联网安全架构进行设计时需要注意的一些共识性原则，如：

⑴ 可靠性原则：可靠性原则认为物联网架构需要具备可靠性和容错能力，具有较强的抗攻击能力和鲁棒性。

⑵ 安全性原则：安全性原则认为物联网架构应该能在各种恶意攻击下保持完整性、可用性、真实性、私密性，且保证各项操作均受到合理限制和审计。

⑶ 用户友好性原则：用户友好性原则认为物联网架构应该提供给用户足够易用的界面和操作流程，使得用户可以快速、有效地完成相关工作。

⑷ 可扩展性原则：可扩展性原则认为物联网架构的设计应该充分考虑可伸缩性和弹性，使得其在不断增长的业务量和数据规模下可以持续运行。

⑸ 成本效益原则：成本效益原则认为物联网架构的设计应该注重实现低成本、高效益，避免过度投资或过度依赖昂贵的高科技产品和服务。

## 2.3IoT安全架构设计
本文将围绕物联网安全架构设计方面，介绍以下几个部分的内容：

⑴ 功能权限划分
⑵ 设备类型划分
⑶ 安全通讯协议
⑷ 基础设施层安全架构
⑸ 服务层安全架构
⑹ 安全数据管理
⑺ 安全运维与运营支撑

### 2.3.1功能权限划分
为了更好的保障公司、组织和个人在物联网领域的安全，制定物联网安全架构的时候，首先要确定哪些功能需要保障安全，然后再设计对应的安全机制。功能权限划分通常采用功能矩阵的方式进行，功能矩阵中包括功能模块、功能详细说明和所属角色。功能模块包括核心功能和辅助功能，核心功能是指该功能对企业和组织的安全至关重要，没有核心功能就无法正常运转；辅助功能是指在核心功能无法正常工作时，仍能正常提供帮助，但是不能成为核心功能。所属角色又分为管理者角色、工作人员角色和终端用户角色，管理者角色负责核心功能的设计、部署、维护和运维；工作人员角色则负责辅助功能的开发和维护；终端用户角色则是最终的使用者，他们的角色和权限往往受限于设备本身。功能矩阵可帮助企业和组织了解系统中各功能的优先级，以便更好的确定最重要的功能，并为相应的安全机制和流程进行设计。

### 2.3.2设备类型划分
根据设备的网络接入方式和功能，可以将物联网设备分为下列五种类型：

⑴ 终端设备：由物联网终端、嵌入式系统和移动APP等软硬件组成，主要用于家庭、办公、商务等场景，主要包含传感器、控制器、网关等。

⑵ 中央控制器：物联网中心是一个物联网中枢，集中管理和控制所有终端设备，它可以进行数据聚合、规则引擎、数据流转、数据处理等功能，类似于智能城市里的核心交换机。

⑶ 网关设备：网关设备用于连接终端设备、中央控制器和外部网络，它可以实现数据转换、加密、压缩、过滤等功能。

⑷ 云计算平台：云计算平台是一个云端运行的操作系统，可以实现云端的数据存储、数据处理和数据的分析，类似于互联网上的服务器。

⑸ 安全防护装置：安全防护装置通常由安全芯片组成，是物联网安全的基石之一。其作用主要是对物联网数据进行收集、处理、分析，检测和防护网络攻击。

对于物联网设备的类型划分，企业必须在不降低安全性能的前提下，最大程度上减少设备数量，同时还要控制设备接入点、网络通讯协议和接口，以避免设备接入带来的安全风险。

### 2.3.3安全通讯协议
安全通讯协议(security communication protocol)是指物联网设备间、中央控制器和云端之间的通信协议，它直接决定了设备间通信的安全性、可靠性和完整性。目前国内外主流的安全通讯协议有TLS/SSL、DTLS、CoAP、MQTT等。

TLS/SSL和DTLS都是基于TCP/IP协议族的安全协议，它们与HTTP协议共享相同的端口号443，并且支持四种加密方式：SSLv3、TLSv1、TLSv1.1、TLSv1.2。相比于SSL，TLS版本更新快、规范清晰、密码学更加先进。DTLS只适用于UDP通信，速度更快。CoAP是一种轻量级、简单、资源受限的物联网通信协议。MQTT是物联网消息传输协议，它具有轻量、开销小、订阅模式灵活等优点。这些协议可以选择性地使用不同的端口号，也可以部署在不同的传输层协议上。

### 2.3.4基础设施层安全架构
基础设施层安全架构(Infrastructure Security Architecture)是指物联网设备的网络层、数据链路层、物理层以及其他相关的底层硬件和软件，它负责设备和相关的网络的安全和稳定，主要包括如下几个部分：

⑴ 网络层安全架构：该部分涉及物联网设备之间的网络通讯，主要包括网络设备的选型、部署和配置、网络安全策略的制定、系统网络监控和管理、日志管理等。

⑵ 数据链路层安全架构：该部分涉及物联网设备与中央控制器、云计算平台之间的通信，主要包括数据加密、认证、授权、数据完整性验证等。

⑶ 物理层安全架构：该部分涉及物联网设备的硬件安全，主要包括物理防护、固件加密、安全启动等。

⑷ 其他安全架构：该部分主要是对设备的其他安全问题，如恶意程序的识别、木马的预警、设备隐私的保护、设备行为的审计、边界安全的保护等。

物联网设备的网络层、数据链路层、物理层以及其他相关的底层硬件和软件，需要采取一些安全措施，才能确保设备的网络通讯和数据传输的安全、可靠和完整。

### 2.3.5服务层安全架构
服务层安全架构(Service Layer Security Architecture)是指物联网设备的应用层、业务层和管理层，它负责核心业务的安全、可用性和可靠性，主要包括如下几个部分：

⑴ 应用层安全架构：该部分主要关注物联网设备的应用安全，包括安全设计、软件开发、软件升级和安全测试等。

⑵ 业务层安全架构：该部分主要关注物联网业务系统的安全，包括业务数据隔离、业务流程管控、访问控制等。

⑶ 管理层安全架构：该部分主要关注物联网管理系统的安全，包括认证授权、审核、容量管控、安全运维等。

物联网设备的应用层、业务层和管理层，需要针对不同类型的业务场景，采取不同的安全措施，才能确保设备的核心业务的安全、可用性和可靠性。

### 2.3.6安全数据管理
安全数据管理(Security Data Management)是指如何安全地存储、处理、共享和保护物联网设备产生的数据。主要包括如下几个部分：

⑴ 数据收集：收集物联网设备产生的数据，包括设备日志、应用程序日志、操作记录、安全数据、网络数据等，并采用不同的安全级别对其进行加密和保护。

⑵ 数据处理：对收集到的物联网数据进行分析、处理，包括数据脱敏、数据汇总、数据过滤、数据统计等。

⑶ 数据共享：分享收集到的物联网数据，包括数据可视化、数据查询和数据传输。

⑷ 数据备份：进行物联网数据的备份和恢复，包括设备配置信息的备份、设备数据的备份、系统日志的备份、定期检查和运维。

在保障数据安全的过程中，企业必须选择合适的安全级别，并通过安全机制和过程，来保障物联网数据资产的安全、有效和完整。

### 2.3.7安全运维与运营支撑
安全运维与运营支撑(Security Operations and Support)是指如何运维和支撑物联网设备的安全、可用性和可靠性，主要包括如下几个部分：

⑴ 设备运维：对物联网设备进行日常维护、故障排查、安全评估和更新，并在发生安全事件时进行迅速响应。

⑵ 网络运维：对物联网网络进行日常维护、安全防护，确保网络的稳定、可靠和安全。

⑶ 操作与治理：对物联网设备和系统进行操作和治理，包括安全配置、安全管理、安全评估、审计等。

⑷ 技术支持：提供技术支持和咨询服务，包括实施软件更新、配置系统设置、提供远程访问、第三方安全软件的集成等。

物联网设备的安全运维与运营支撑，是保证物联网安全、可用性、可靠性、可控性的一个重要环节。