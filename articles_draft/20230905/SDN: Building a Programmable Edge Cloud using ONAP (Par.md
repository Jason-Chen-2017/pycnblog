
作者：禅与计算机程序设计艺术                    

# 1.简介
  

随着云计算、机器学习等技术的发展，越来越多的人选择采用边缘计算作为一种新的部署方式。而在这一趋势下，又有越来越多的企业拥抱这一新兴的计算模式。其中SDN(Software Defined Networking)，即“定义于软件之上的网络”是一个正在被广泛应用的技术，它将网络功能从硬件中剥离出来，通过可编程的控制器来实现，可以使网络更加灵活、智能化和动态化。

根据ONAP(开放网络自动化平台)项目，本文将讨论SDN的基础知识，包括数据平面和控制平面的功能，以及一些具体的SDN实现方案。通过这些内容，读者应该能够理解什么是SDN，以及如何利用Openstack和ONAP构建起一个可编程边缘云平台。
# 2.数据平面
## 2.1 数据平面的功能
数据平面主要负责网络的数据流转，主要功能如下：

1. 分配、管理网络资源
2. 流量处理和交换
3. 安全防护
4. 性能优化

## 2.2 数据平面的基本结构
数据平面的基本结构如下图所示：


数据平面的功能由控制器（Controller）和交换机（Switch）共同完成。控制器负责调度各个设备之间的通信，并协调数据平面的配置。交换机负责存储、转发网络包，并提供访问控制和QoS功能。

控制器和交换机之间通过高速网络连接起来，控制器通过 southbound接口与交换机进行通信。southbound接口提供了基于RESTful API的 northbound接口，northbound接口则是其他组件（如应用、虚拟机、容器等）用来与交换机进行通信的接口。

在数据平面中，控制器的主要功能如下：

1. 配置路由协议、QoS规则、IP地址池等参数
2. 根据业务需求调整数据平面网络拓扑结构
3. 监控数据平面设备的健康状况
4. 提供策略性管理，帮助用户解决网络问题

而在Openstack环境中，控制器可以通过Openstack Neutron插件进行管理。Neutron是一个开源的、纯Python编写的、支持多租户、扩展性强的网络服务软件，它可以让云管理员能够快速、方便地创建虚拟网络，同时将网络连接到底层物理网络上，实现多个网络之间的互联互通。

## 2.3 数据平面的具体实现
根据SDN的架构模型，SDN的实现分为三层：

- SDN控制器层：主要实现对数据平面资源的分配、控制和数据传输；
- 服务逻辑层：主要实现数据中心的网络功能，如路由、VPN等；
- 物理硬件层：主要实现数据平面的可编程特性，使得云环境中的网络可以高度灵活、智能化、动态化。

### 2.3.1 OVS&DPDK
Open vSwitch(OVS) 是目前最常用的开源SDN控制器，其由 Nicira Networks 创建，是当下最流行的SDN控制器之一。OVS支持多种类型的数据平面技术，包括 OpenFlow 和 OF-DPAA(Data Plane Acceleration Architecture) 。OF-DPAA 是一种基于数据平面加速的SDN数据平面，能显著提升数据平面的性能。

OpenFlow 是 SDN 的一种协议，基于OpenFlow协议的控制器可以对交换机执行各种操作，如流量控制、QoS等。OVS 作为一个独立的软件，可以集成到任何基于 Linux 操作系统的主机上，也可以通过 RESTful API 或 CLI 来远程管理。

另一方面，Intel 提出了 DPDK(Data Plane Development Kit)。它是一个开源的、高性能的、用于快速开发、运行用户态的网络堆栈，支持数据平面和网络接口。它可以让 SDN 控制器直接在 Linux 上运行，不用考虑不同平台的兼容性问题。

DPDK 可以让 SDN 控制器利用多核 CPU 的优势，实现高吞吐量、低延迟的网络处理。这种架构相比传统的单核控制器，能有效地提升数据平面性能。

### 2.3.2 P4
P4 语言是一种高级语言，可以被编译成低级指令集，在执行时才会将其映射到实际的硬件指令。P4 语言很适合在软件定义网络中实现高效、动态的网络处理。

P4 既可以在控制平面中执行，也可以在数据平面中执行。数据平面上的 P4 应用可以在硬件中执行，通过使用交换机上的 P4 芯片。

由于 P4 的编译器需要一定的时间和算力，因此也存在部署难度。但它在某些领域如数据中心网络、NFV(Network Function Virtualization) 中扮演着重要角色。

### 2.3.3 RYU&Faucet
RYU 是 Python 编写的一个基于 OpenFlow 的 SDNC 控制器，它可以作为 OpenStack Neutron 插件部署在 Openstack 环境中。

Faucet 是由 Facebook 创建的一款基于 Ryu 的 SDNC 控制器。Faucet 支持多种数据平面技术，如 OpenFlow 和 OF-DPAA ，同时也是唯一支持 OpenFlow 1.3 的控制器。

与其它控制器一样，Faucet 使用 YAML 文件配置网络，但它更侧重于网络的可编程性。用户可以通过配置表格的方式，在 Faucet 上定义数据平面的流量转发规则。

Faucet 在实现的易用性、扩展性和稳定性方面都有较好表现。

# 3.控制平面
## 3.1 控制平面的功能
控制平面主要负责网络的控制，主要功能如下：

1. 网络规划和规整
2. 网络实施与运维
3. 故障诊断与排除
4. 性能分析与优化

## 3.2 控制平面的基本结构
控制平面的基本结构如下图所示：


控制平面的功能由控制器（Controller）完成。控制器负责调度各个设备之间的通信，并协调数据平面的配置。控制器一般采用分布式架构，每个控制器都可以独立运行，当某个控制器出现故障的时候，可以自动切换到另一个控制器继续工作。

控制器通过 northbound接口与交换机或控制器进行通信。northbound接口提供了基于RESTful API的 southbound接口，southbound接口则是其他组件（如应用、虚拟机、容器等）用来与控制器进行通信的接口。

控制器的主要功能如下：

1. 维护数据平面网络拓扑结构
2. 运行基于策略的路由协议
3. 执行网络实施操作，如扩容、收缩、回滚
4. 监控整个网络的健康状况

## 3.3 控制平面的具体实现
根据SDN的架构模型，SDN的实现分为三层：

- SDN控制器层：主要实现对数据平面资源的分配、控制和数据传输；
- 服务逻辑层：主要实现数据中心的网络功能，如路由、VPN等；
- 物理硬件层：主要实现数据平面的可编程特性，使得云环境中的网络可以高度灵活、智能化、动态化。

### 3.3.1 ONAP
ONAP(开放网络自动化平台)项目是由Olfaction项目的创始成员联邦开放平台组(Floodlight Project)联合启动的，旨在促进NFV和SDN在开放标准的云计算基础设施之间建立桥梁，目的是通过提供统一的体系结构、API、工具、方法、流程以及管理策略来促进云计算的NFV和SDN功能融合。

ONAP已经推出了SDN-R(Software Defined and Hybrid Routing)项目，该项目是一个基于开源SDN控制器之上的统一SDN/NFV解决方案，为5G、车联网、边缘计算、智慧城市和其他场景提供可靠、高效的NFV和SDN组合框架。

ONAP还推出了ETSI(电信事业特殊化组织)的NFV API规范、VES(Vulnerability Early Warning System)漏洞预警系统及其相关ONOS子项目、VCA(VNF Compatibility Assessment)VNFD兼容性评估工具等项目，并与其他平台保持密切合作。

### 3.3.2 ONOS
Open Network Operating System (ONOS) 是基于Apache Software Foundation的开源项目，旨在帮助运营商和服务提供商构建可靠的、高可伸缩性的SDN控制器。ONOS支持多种类型的数据平面技术，包括OpenFlow和OF-DPAA。

OpenFlow 是SDN的一种协议，它基于OpenFlow协议的控制器可以对交换机执行各种操作，如流量控制、QoS等。ONOS支持多种类型的控制器，如OpenDaylight(ODL)、ONOS、floodlight等。

### 3.3.3 Stratum
Stratum 是一种开源的、基于gNMI的SDN控制器，由华为公司创建。Stratum支持OpenConfig YANG数据模型，并且内置了丰富的功能，如ACL、QoS、QoE、QoS、MPLS等。

### 3.3.4 Barista
Barista 是一种基于OpenFlow协议的控制器，由Juniper Networks 创建。Barista支持多种类型的数据平面技术，如OpenFlow和OF-DPAA。Barista是网络的分布式控制器，它利用多个可靠的控制器来保证其可用性。

# 4.SDN部署架构
SDN部署架构图如下图所示：


在部署架构图中，包含三个主要的组件：

- Openstack：Openstack是一套开源的、开源云计算IaaS软件产品。它利用虚拟化技术将底层服务器、存储、网络资源映射到云计算上，实现了自动化的资源管理、弹性伸缩和资源共享。Openstack在部署架构图中主要负责管理网络的创建、调度和管理。

- ONAP：ONAP是一套开源的、独立的、面向NFV和SDN的云原生平台。它通过提供统一的体系结构、API、工具、方法、流程以及管理策略，可以快速地、一致地部署和管理NFV和SDN方案。ONAP在部署架构图中主要负责管理网络功能，包括网络规划、网络实施、故障诊断、性能分析和优化。

- Data Center Network：Data Center Network是由专门人员专门设计、购买、布线、安装、调试、维护的数据中心网络系统。它可以帮助用户轻松地管理复杂的数据中心网络，并能够快速响应各种突发事件。

# 5.结论
SDN是一种新型的网络技术，它将网络功能从硬件中剥离出来，通过可编程的控制器来实现，可以使网络更加灵活、智能化和动态化。本文通过了解SDN的基本概念和实现原理，介绍了SDN的功能、架构和部署架构。最后，给出了几种SDN控制器的具体实现，以及一些关于ONAP、ONOS、Stratum、Barista等控制器的介绍。希望这篇文章能够帮助读者更好的理解SDN技术，以及如何利用Openstack和ONAP构建起一个可编程边缘云平台。