
作者：禅与计算机程序设计艺术                    

# 1.简介
  

曲面积分（Surface Integral）是指曲面上某一路径上的曲率积分，它是二维或三维曲面在空间中的投影面积。对于曲面的曲率，可以用微分形式表示出来，即曲面上某一点处切线的斜率。当曲面过于复杂时，计算曲面积分就变得十分困难。


在现实世界中，曲线积分也存在着广泛的应用。比如，在信号处理、统计学、工程技术领域都有着广泛的应用。曲线积分可用于描述物体表面积，导电性质等，还可以用来求解二维曲线之间的交点。另外，在光学、粒子物理学、流体力学、热学等领域，曲面积分亦是经典问题之一。


曲面积分虽然有很多优越性，但是计算曲面积分的复杂性使得它不能简单地用一套公式表达出来。需要采用数值方法进行近似计算。常用的数值方法有蒙特卡洛法、解析几何法、网格法和试探法等。本文主要从数学角度对曲面积分的几何意义进行讨论，并且通过一个具体的例子，对数值方法的实现过程作进一步阐述。

# 2.基本概念和术语
## 2.1 曲面积分的定义
曲面积分（Surface Integral），是指曲面上某一路径上的曲率积分。即曲面上某一路径$\gamma$的曲率积分等于所有该路径上的曲率及其变化率的乘积。曲率是曲面上某一点处切线的斜率，变化率是曲率的切向量。

记路径$\gamma$上的曲面积分为$I_{\gamma}$，则有：
$$I_{\gamma}=\int_\gamma \sqrt{(\frac{\partial N}{\partial x})^2+(\frac{\partial N}{\partial y})^2+\cdots+(\frac{\partial N}{\partial n})^2}\cdot da,$$
其中$\gamma$为曲面$\Sigma$上一段连续路径，$N\in\Sigma$为$\gamma$上的弧段。$da$是$\gamma$上的曲率元素。

## 2.2 概念定义
- 曲线（Curve）：由一系列点组成的曲线。曲线可以是直线、圆弧、椭圆弧、抛物线等。
- 曲面（Surface）：曲线所构成的空间区域，通常包括起点和终点两点。曲面可以是平面或曲面。
- 切线（Tangent line）：曲面$\Sigma$上的一条曲线，与曲面$\Sigma$的某个参数方程$x=f(y),y=g(z)$共线且与$xOy$平行。
- 法线（Normal vector）：曲面$\Sigma$上的一矢量，垂直于切线且与$xOz$正交。$N=(n_x,n_y,n_z)^T$。
- 曲率（Curvature）：曲面上任意一点处切线的斜率。一般用Krümmungskräfte表示。$R(u,v)=|\frac{\mathrm{d}^2 \phi}{\mathrm{d} u\mathrm{d} v}|$。
- 逆变坐标（Inverse coordinate）：把曲面上的一点$(u,v)$映射到一个新的坐标系，在新坐标系中，$t: [a,b] \rightarrow [-1,1]$。则新坐标系上的点$(s,t)=(\frac{(u-c_1)(b-a)}{(b-a)(b_2-a_1)},\frac{(v-c_2)(b-a)}{(b-a)(b_2-a_2)})$，其中$(c_1,\ c_2, b_1,b_2)$是关于曲面$\Sigma$的参数方程。逆变坐标系的曲率为：$\kappa(s,t)=\frac{|R(s,t)|}{1-\kappa_{max}}$.
- 复曲面的描述方程（Parametric equations）：以控制点$(C_1,C_2)$为中心，沿着方向$V_1$和$V_2$的一条曲线，连接三个控制点$(C_1,V_1,C_2,V_2)$的边界。则对于曲面上的一点$(u,v)$，其相应的曲率方程为：
  $$\rho(u,v)=R\left(\frac{u-u_1}{h},\frac{v-v_1}{k}\right),$$
  其中$u_1,v_1$是$C_1$的坐标，$h,k$分别是两个方向$V_1$和$V_2$的模长。

## 2.3 概念定义
- 曲面积分公式：
$$I_{\gamma}=S_{\gamma}=\int_\gamma (R_{\epsilon}(P))\cdot dA+\int_\gamma (\nabla R_{\epsilon}(P)\cdot N(P))ds.$$
- $\epsilon$：描述曲面细节的参数，如微小扰动$\delta\epsilon$。
- $R_{\epsilon}(P)$：曲率函数，描述曲面上点$P$处的曲率。$R_{\epsilon}(P)=|\frac{\partial N(P)}{\partial u}-\frac{\partial N(P)}{\partial v}|$。
- $(\nabla R_{\epsilon}(P))\cdot N(P)$：曲率函数的切向量与法线的内积，衡量的是曲率的方向和曲面的正负。
- $S_{\gamma}$：曲面积分，给出了曲线$\gamma$在曲面$\Sigma$上的面积。
- $dA$：$S_{\gamma}$和$\int_\gamma \cdot ds$的区别。

# 3.具体算法与数学公式推导
## 3.1 定义积分区域
首先，确定积分区域。一般来说，将要积分的曲线$\gamma$可以定义为某种拓扑结构。如果$\gamma$是连通的，则可以直接利用它形成的区域$D_{\gamma}$进行积分；否则，需要按照拓扑结构定义积分区域。设$\gamma$在曲面$\Sigma$上相切于开集$U$和$V$，则可以考虑如下策略进行积分区域的选择：

1. 如果$U$和$V$都具有圆周曲线相切条件，则积分区域$D_{\gamma}$可以取$U\times V$，即$D_{\gamma}=\{(x,y): (x',y')\in U\times V\forall x'\in[a,b],y'\in[c,d]\}$。这样可以保证积分面积$\int_{\gamma}dxdydz$是一个球体面积，计算方便。
2. 如果$U$和$V$中只有一个具有圆周曲线相切条件，则积分区域$D_{\gamma}$可以取另一半连通集合，如$U$具有圆周曲线相切条件，则$D_{\gamma}=\{(x,y): x\in [a,b],y\in Y(x)\}$.
3. 如果$U$和$V$均不具有圆周曲线相切条件，则积分区域$D_{\gamma}$可以取一个点集合，如$D_{\gamma}=(P_1,P_2,...,P_m)$，其满足$D_{\gamma}=\{(x,y)\in M:\text{$M$是$\Sigma$的一个极小凸包}\}$。

## 3.2 基本算法
设$\gamma$在曲面$\Sigma$上相切于开集$U$和$V$,考虑如下逆变坐标系：
$$s:\ [a,b]\rightarrow[-1,1]; t:\ [c,d]\rightarrow[-1,1].$$
其中$s$表示曲面$\Sigma$的第一条边所在的方向，$t$表示第二条边所在的方向。再设$\theta_1=-\pi/2$为$t$方向的转角，即
$$\theta_2=\tan^{-1}((x_1-x_2)/(y_1-y_2)).$$
引入新参数$\xi=\frac{st+\cos\theta_2}{1+\sin\theta_2}$,并令
$$\tilde s:[-1,1]\rightarrow s; \tilde t:[-1,1]\rightarrow t.$$
即
$$\tilde s(\xi)=\frac{2\xi}{1+\sin\theta_2}; \tilde t(\xi)=\frac{-2(1+\sin\theta_2)\xi+(1-\sin\theta_2)}{1+\sin\theta_2}.$$

曲面积分公式转换为逆变坐标系下的积分形式：
$$I_{\gamma}=S_{\gamma}=\int_\gamma (R_{\epsilon}(\xi))\cdot |J|ds,$$
其中
$$J=\left[\begin{matrix}\frac{\partial}{\partial s}\\\frac{\partial}{\partial t}\end{matrix}\right]=\left[\begin{matrix}\cos\theta_2&\sin\theta_2\\\frac{\cos\theta_2}{\sin\theta_2}&\sin\theta_2\end{matrix}\right].$$
为了方便计算，可以定义
$$\psi_i:[-1,1]\rightarrow S, i=1,2,\cdots,m.$$

## 3.3 局部坐标系下曲率函数的求法
由于曲面逆变坐标系下的曲率方程不同于笛卡尔坐标系下的曲率方程，因此需要单独研究曲面逆变坐标系下曲率函数的表达式。
### 3.3.1 曲率函数
曲面逆变坐标系下的曲率方程为：
$$\frac{1}{R_{\epsilon}(\xi)}\left(\frac{\partial^2 \psi}{\partial \xi^2}+\frac{2}{1+\sin\theta_2}\frac{\partial \psi}{\partial \xi}\frac{\partial \psi'}{\partial \xi}\right).$$
其中
$$\psi'_i=\frac{\partial\psi}{\partial s'}, i=1,2.\quad \psi''_j=\frac{\partial^2\psi}{\partial st'}_{jk}, j=1,2, k=1,2.$$

### 3.3.2 高斯积分
对于曲面$\Sigma$上的某一点$P$，其切线方向在逆变坐标系$[\xi,\eta]^2$中的方向矢量为$d\Psi=[d\psi/\partial\xi,\ d\psi/\partial\eta]$。高斯积分定义如下：
$$\int_{\gamma}(d\Psi)^T\cdot dB=\sum_{i=1}^md_i\int_{B_i}\frac{dB}{\tilde B},$$
其中$\tilde B=(\xi,\eta)\subset D_{\gamma}$为局部范围，$d_i$为点$P$到$B_i$的距离，$B_i=\cup_{j=1}^{m}DB_j$。由于曲面逆变坐标系的表达式较为复杂，因此不做详细推导。

### 3.3.3 高斯投影
引入局部坐标系$\Omega_p$，使得$d\Psi$张成$O_p$平面，有：
$$\int_{\gamma}(d\Psi)^T\cdot d\Omega_p=\sum_{i=1}^md_i\int_{O_i}\frac{d\Omega_p}{\tilde O},$$
其中$O_i=\cup_{j=1}^{m}DO_j$是局部投影区域。可以用代数几何的方法证明该公式的正确性。

## 3.4 全局坐标系下曲率函数的求法
将局部坐标系$\Omega_p$映射到全局坐标系$G$后，有：
$$\frac{d\psi_i}{\partial t}=\frac{\partial\psi_i}{\partial s},$$
此外，我们也可以将曲率函数作为一个曲面上的微分方程来研究。

### 3.4.1 基于微分方程的研究
假设曲率函数$\psi$的解为$u_1,u_2,\cdots,u_m$，那么它的曲率场可以表示为：
$$K_{ij}=\frac{1}{R_{\epsilon}}\frac{\partial}{\partial u_i}\left(\frac{\partial \psi}{\partial u_j}\right)-\frac{2}{1+\sin\theta_2}\frac{\partial \psi}{\partial u_i}\frac{\partial \psi}{\partial u_j}$$
其中$K_{ij}$表示曲率函数在第$i$个解$u_i$和第$j$个解$u_j$之间形成的曲率张量。通过微分方程的形式，可以计算出各个解的曲率函数。

### 3.4.2 拉普拉斯方程的变形
拉普拉斯方程表示了局部坐标系中的曲线$\gamma$对函数$f$的拉普拉斯散度。根据曲面积分的几何意义，考虑曲面$\Sigma$上一点$P$处的切线，其切向量在全局坐标系中的坐标为：
$$\frac{d\vec N}{dt}(\theta_1,\theta_2)=\frac{dx}{ds}\frac{d\theta_1}{ds}\vec e_{1}+\frac{dy}{ds}\frac{d\theta_2}{ds}\vec e_{2}+\vec N.$$
由局部坐标系变换公式知：
$$d\psi_i/\partial s=\frac{\partial\psi_i}{\partial s'},$$
其中$s'$是在局部坐标系中的参数。而$\vec N$在全局坐标系中的坐标为：
$$\vec N(\theta_1,\theta_2)=\vec e_{3}(\theta_1,\theta_2).$$
因此可以将拉普拉斯方程的右端改写为：
$$\frac{d\psi_i}{ds'}=\frac{\partial\psi_i}{\partial s}\frac{\partial\psi_i}{\partial s'+\frac{\partial\psi_i}{\partial s}},$$
并且可以看到$s$和$s'$的关系式。