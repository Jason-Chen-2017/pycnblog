
作者：禅与计算机程序设计艺术                    
                
                
## 概述
矩阵分解（Matrix Decomposition）是利用矩阵特征值和 eigenvectors 的方式进行矩阵分析、运算和数据处理的一门学科。在实际应用中，矩阵分解往往用于很多方面，如图像分析、信号处理、统计建模、多媒体处理等领域。本文主要讨论了关于线性代数中的矩阵分解方法。
## 矩阵分解的目的
主要有两个目的：

1. 将一个 n 维矩阵分解为多个较小的 n-1 阶方阵相乘得到的结果。
2. 通过某个基底空间找寻低秩近似（low rank approximation），即找到使得某些特定向量相互正交的子集。在最简单的形式下，该子集就是一个 n-k 阶的子空间，其中 k <= n/2 。通过这种分解，可以将复杂的问题简化为简单问题，并获得对问题的更好的理解和表达能力。
## 矩阵分解的方法
矩阵分解有两种主要的方法：

1. Singular Value Decomposition (SVD) 方法。
2. Eigendecomposition 方法。

本文仅会涉及后一种方法，即 eigenvalue decomposition 。这是因为前者的应用比较少。
# 2.基本概念术语说明
## 矩阵
设 A 为一个 m * n 矩阵，记作 $A_{m     imes n}$ ，A 可以表示为如下形式：
$$\begin{bmatrix} a_{11} & a_{12} &... & a_{1n}\\a_{21} & a_{22} &... & a_{2n}\\...&...&...&\dots\\a_{m1} & a_{m2} &... & a_{mn}\end{bmatrix}$$
其中 $\forall i = 1,2,\cdots,m ; j=1,2,\cdots,n$ ，记 $A^i_j$ 表示 $A$ 中第 i 个行向量、第 j 个列向量组成的矩阵。

## 矩阵的转置
设 A 为一个 m*n 矩阵，其转置为 AT ，记作 $AT_{n     imes m}$ ，则对于任意的 i 和 j ，都有：
$$A^i_j=\left(A^T\right)^i_j=\left(\begin{bmatrix}a_{11}&a_{21}&\cdots&a_{m1}\\a_{12}&a_{22}&\cdots&a_{m2}\\\vdots&\vdots&\ddots&\vdots\\a_{1n}&a_{2n}&\cdots&a_{mn}\end{bmatrix}\right)^i_j$$
当 A 是满秩时，AT=A^T 。

## 矩阵的迹（trace）
设 A 为一个 m*n 矩阵，则其迹（trace）记作 tr(A)，定义为：
$$tr(A)=\sum_{i=1}^m\sum_{j=1}^na_{ij}$$

## 对称矩阵
如果一个矩阵 A 是实对称矩阵（symmetric matrix），则对于任意的 i 和 j ，都有 $a_{ij}=a_{ji}$ 。

## 反对称矩阵
如果一个矩阵 A 是实反对称矩阵（skew symmetric matrix），则对于任意的 i 和 j ，都有 $a_{ij}=-a_{ji}$ 。

## 酉矩阵
如果一个矩阵 A 是酉矩阵（orthogonal matrix），则它一定是一个实对角阵（diagonal matrix）。且满足：
$$AA^T=A^TA=I$$
其中 I 是单位矩阵（identity matrix）。

# 3.核心算法原理和具体操作步骤以及数学公式讲解
## 特征值和特征向量
设 A 为一个方阵，其特征值对应的特征向量记作 $\lambda_i$ ，特征向量对应于该特征值的记作 $u_i$ 。如果存在一组实数 $\lambda_i$ ，使得下面的等式成立：
$$A u_i= \lambda_i u_i$$
那么，$\lambda_i$ ，$u_i$ 称为矩阵 A 的特征值（eigenvalues）和特征向量（eigenvectors）。特征值不必唯一，但对应的特征向量是唯一的。特征值一般按照大小递减的顺序排列。

## 对角矩阵的特征值和特征向量
如果 A 是对角矩阵（diagonal matrix），则其特征值都是 A 中的元素，其对应的特征向量为1 在对角线上的单位向量。

## 对称矩阵的特征值和特征向量
如果 A 是对称矩阵（symmetric matrix），其特征值也对应着特征向量，形式为：
$$\lambda_i=\frac{1}{2}(a_{ii}-a_{jj})$$
$$u_i=\begin{bmatrix}\sin    heta_i\\\cos    heta_i\end{bmatrix}$$
这里，$    heta_i$ 是 A 的第 i 个主对角线元素所对应的夹角（argument of principal angle），等于 arccos$(a_{ii}/\sqrt{a_{ii}^2+a_{jj}^2})$ 。

## 三重对角矩阵的特征值和特征向量
如果 A 是三重对角矩阵（triple diagonal matrix），其特征值只有非零元素，而对应特征向量的方向是固定的（固定平面和超平面），形式为：
$$\lambda_i=a_{ii},\quad 1\leq i \leq n$$

## 矩阵的奇异值分解 SVD
设 A 为一个 m*n 矩阵，其 SVD 分解为：
$$A=U \Sigma V^T$$
其中 U、V 是 m*m 和 n*n 的酉矩阵，\$\Sigma\$是一个对角矩阵，对角线上的值由大到小排列。

### 计算 SVD
#### 列主元高斯消去法
首先，将 A 按列拆开成由列向量构成的矩阵 V （每一列是一个向量），并令其每一列向量作为一列，将 A 的每一行作为一行组成的矩阵 W （每一行是一个向量），并令其每一行向量作为一行。
然后，沿对角线方向进行初等行变换，将每一行减去第一个元素（通常被认为是截距项），使每一行的第一个元素为 1 。这样就得到了一个具有如下形式的矩阵：
$$W=Q^{-1}AV$$
其中，Q 是 m*m 的酉矩阵，且满足 $QQ^T=I$ 。
接下来，在每一列中找到最大的元素，并将其放到对角线的位置，使其成为新的对角元素。这样就得到了一个对角矩阵，其对角线上的值从大到小排列。
最后，返回到 W 的计算中，将每一列除以对应对角元素，再将其和原始的 A 拼接起来。

#### 行主元高斯消去法
与上面类似，只不过先把矩阵变换到适合行主元求解的形式：
$$W'=A^\intercal V$$
其中，$A^\intercal$ 是 n*m 的矩阵。
根据此时的 W', 采用类似的方式进行初等行变换，使每一列减去第一个元素，并做同样的处理。
最后，生成新的对角矩阵，并采用类似的方式求取出新的 A 。

### 举例说明
#### 列主元高斯消去法举例
假设有一个 n*n 的矩阵 A：
$$\begin{bmatrix}5&7&9&2\\4&-3&8&5\\2&-4&3&7\end{bmatrix}$$
其列主元高斯消去法可以得到以下的对角矩阵 $\Sigma$ ：
$$\begin{pmatrix}\frac{1}{\sqrt{16}}&\frac{-1}{\sqrt{16}}&\frac{-1}{\sqrt{16}}&\frac{1}{\sqrt{16}}\end{pmatrix}$$
其对应的 U 矩阵为：
$$\begin{pmatrix}\frac{1}{\sqrt{16}}&\frac{-1}{\sqrt{16}}&\frac{1}{\sqrt{16}}&\frac{1}{\sqrt{16}}\end{pmatrix}$$
计算出来的 A 矩阵如下：
$$\begin{pmatrix}\frac{5}{\sqrt{16}}&\frac{2}{\sqrt{16}}&\frac{1}{\sqrt{16}}&\frac{1}{\sqrt{16}}\\0&-\frac{\sqrt{3}}{\sqrt{16}}&\frac{1}{\sqrt{16}}&\frac{1}{\sqrt{16}}\\0&0&0&0\end{pmatrix}$$
#### 行主元高斯消去法举例
假设有一个 m*n 的矩阵 B：
$$\begin{bmatrix}3&-1&1&0&2\\-2&3&0&1&-1\\1&-1&-1&0&1\end{bmatrix}$$
其行主元高斯消去法可以得到以下的对角矩阵 $\Sigma'$ ：
$$\begin{pmatrix}\frac{1}{\sqrt{6}}&\frac{-1}{\sqrt{6}}&\frac{1}{\sqrt{6}}&\frac{1}{\sqrt{6}}&\frac{1}{\sqrt{6}}\end{pmatrix}$$
其对应的 V 矩阵为：
$$\begin{pmatrix}\frac{1}{\sqrt{6}}&\frac{-1}{\sqrt{6}}&\frac{-1}{\sqrt{6}}&\frac{1}{\sqrt{6}}&\frac{1}{\sqrt{6}}\end{pmatrix}$$
计算出来的 B 矩阵如下：
$$\begin{pmatrix}\frac{3}{\sqrt{6}}&\frac{-1}{\sqrt{6}}&\frac{-1}{\sqrt{6}}&\frac{1}{\sqrt{6}}&\frac{2}{\sqrt{6}}\\0&\frac{3}{\sqrt{6}}&\frac{-1}{\sqrt{6}}&\frac{1}{\sqrt{6}}&\frac{-1}{\sqrt{6}}\\0&0&\frac{-\sqrt{3}}{\sqrt{6}}&\frac{1}{\sqrt{6}}&\frac{-1}{\sqrt{6}}\end{pmatrix}$$

