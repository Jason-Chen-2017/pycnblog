
# Flink原理与代码实例讲解

作者：禅与计算机程序设计艺术 / Zen and the Art of Computer Programming

## 1. 背景介绍

### 1.1 问题的由来

随着大数据时代的到来，对实时数据处理的需求日益增长。传统的批处理系统在处理实时数据时，往往面临着响应慢、延迟高、吞吐量低等问题。为了满足实时数据处理的需求，Apache Flink应运而生。Flink是一款分布式流处理框架，能够高效地处理实时数据，并具有高吞吐量、低延迟、容错性高等特点。

### 1.2 研究现状

Flink自2011年开源以来，发展迅速，已成为实时数据处理领域的领先技术之一。其核心优势包括：

- 支持流处理和批处理：Flink可以同时处理流数据和批数据，并保证两种处理模式的性能和一致性。
- 水平扩展：Flink采用无中心架构，可以轻松地进行水平扩展，满足大规模数据处理需求。
- 容错性：Flink采用分布式快照机制，能够保证在发生故障时数据的完整性和一致性。
- 高吞吐量：Flink采用高效的数据流引擎，能够处理高吞吐量的实时数据。

### 1.3 研究意义

Flink作为一款优秀的实时数据处理框架，在金融、电商、物流、物联网等领域具有广泛的应用。研究Flink的原理和代码实例，有助于深入了解其工作原理，提升开发者的技术水平，为实际应用提供技术支持。

### 1.4 本文结构

本文将按照以下结构进行讲解：

- 2. 核心概念与联系：介绍Flink的核心概念及其相互关系。
- 3. 核心算法原理 & 具体操作步骤：讲解Flink的内部工作原理和具体操作步骤。
- 4. 数学模型和公式 & 详细讲解 & 举例说明：介绍Flink中涉及到的数学模型和公式，并举例说明其应用。
- 5. 项目实践：代码实例和详细解释说明：通过代码实例讲解Flink的实际应用。
- 6. 实际应用场景：分析Flink在不同领域的应用案例。
- 7. 工具和资源推荐：推荐Flink的学习资源、开发工具和相关论文。
- 8. 总结：总结Flink的原理、应用和发展趋势。
- 9. 附录：常见问题与解答。

## 2. 核心概念与联系

### 2.1 Flink核心概念

- **Stream**: 实时数据流，是Flink处理的数据单元。
- **operator**: 数据处理操作符，负责处理数据流。
- **Job**: 由多个operator组成的任务，表示一个完整的数据处理流程。
- **Stream Graph**: 数据流图，描述了Job中operator之间的连接关系。
- **Execution Graph**: 执行图，是Stream Graph在分布式环境中的映射，表示了Job的物理执行结构。
- **Checkpoint**: 分布式快照，用于保证数据的一致性和容错性。
- **Checkpointing**: 快照机制，定期对数据进行快照，以便在发生故障时恢复。
- **Watermark**: 水印，用于处理乱序事件。
- **Time Window**: 时间窗口，用于对数据进行时间序列处理。

### 2.2 核心概念之间的联系

- Stream是Flink处理的数据单元，operator对Stream进行处理。
- Job由多个operator组成，表示一个完整的数据处理流程。
- Stream Graph描述了Job中operator之间的连接关系。
- Execution Graph是Stream Graph在分布式环境中的映射，表示了Job的物理执行结构。
- Checkpoint和Checkpointing用于保证数据的一致性和容错性。
- Watermark和Time Window用于处理乱序事件和时间序列数据。

## 3. 核心算法原理 & 具体操作步骤

### 3.1 算法原理概述

Flink的核心算法原理包括：

- **事件驱动模型**: Flink采用事件驱动模型，以事件为处理单元，能够实时处理数据流。
- **分布式快照机制**: Flink采用分布式快照机制，定期对数据进行快照，保证数据的一致性和容错性。
- **流处理与批处理统一**: Flink可以同时处理流数据和批数据，保证两种处理模式的性能和一致性。

### 3.2 算法步骤详解

Flink的算法步骤如下：

1. **数据输入**: 将数据源（如Kafka、Redis、文件等）的数据读取到Flink中。
2. **数据转换**: 使用operator对数据进行转换处理，如过滤、映射、连接等。
3. **数据聚合**: 使用window和trigger机制对数据进行时间窗口聚合，如求和、平均、最大值等。
4. **输出结果**: 将处理后的数据输出到结果输出源（如数据库、文件等）。

### 3.3 算法优缺点

**优点**：

- **高吞吐量**: Flink采用高效的数据流引擎，能够处理高吞吐量的实时数据。
- **低延迟**: Flink采用事件驱动模型，能够实时处理数据，延迟极低。
- **容错性**: Flink采用分布式快照机制，能够保证数据的一致性和容错性。
- **可扩展性**: Flink采用无中心架构，可以轻松地进行水平扩展。

**缺点**：

- **学习成本**: Flink的学习成本较高，需要掌握流处理和分布式计算的相关知识。
- **开发难度**: Flink的开发难度较大，需要编写较多的代码。

### 3.4 算法应用领域

Flink广泛应用于以下领域：

- 实时数据监控：如股票行情、网络流量监控等。
- 实时推荐系统：如电商推荐、广告推荐等。
- 实时数据分析：如用户行为分析、日志分析等。
- 实时数据挖掘：如异常检测、关联规则挖掘等。

## 4. 数学模型和公式 & 详细讲解 & 举例说明

### 4.1 数学模型构建

Flink中涉及到的数学模型主要包括：

- **时间窗口**: 时间窗口将数据流划分为多个时间段，以便进行时间序列处理。时间窗口的数学模型如下：

  $$ W_t = \{ x | x.t \in [t_0, t_1] \} $$

  其中，$W_t$ 表示时间窗口，$t_0$ 和 $t_1$ 分别表示时间窗口的开始时间和结束时间。

- **水印**: 水印用于处理乱序事件。水印的数学模型如下：

  $$ w_t = \max(x.t | x \in X, x.t \leq t) $$

  其中，$w_t$ 表示时间 $t$ 的水印，$X$ 表示时间 $t$ 之前到达的所有事件。

### 4.2 公式推导过程

时间窗口和水印的公式推导过程如下：

- 时间窗口：将数据流划分为多个时间段，每个时间段包含一定时间范围内的所有事件。
- 水印：对于每个时间点 $t$，找到时间 $t$ 之前到达的最晚事件的时间戳，作为时间 $t$ 的水印。

### 4.3 案例分析与讲解

以下是一个使用Flink处理实时日志数据的案例：

- **需求**：实时统计每天每个用户的登录次数。
- **数据源**：日志文件。
- **数据格式**：每条日志包含用户ID和时间戳。

```java
DataStream<String> inputStream = env.readTextFile("log.txt");

DataStream<UserLogin> loginStream = inputStream
  .map(new MapFunction<String, UserLogin>() {
    @Override
    public UserLogin map(String value) throws Exception {
      String[] parts = value.split(",");
      String userId = parts[0];
      String timestamp = parts[1];
      return new UserLogin(userId, timestamp);
    }
  })
  .assignTimestampsAndWatermarks(new WatermarkStrategy<UserLogin>() {
    @Override
    public WatermarkGenerator<UserLogin> createTimestampAssigner(WatermarkStrategy.Parameters<UserLogin> parameters) {
      return (event, timestamp) -> {
        // 设置水印延迟时间为1秒
        return TimestampsAndWatermarks.timestampWithDelay(new Timestamp(event.timestamp.getTime() + 1000));
      };
    }
  })
  .keyBy(UserLogin::getUserId)
  .window(TumblingEventTimeWindows.of(Time.seconds(86400)))
  .sum("count");

loginStream.print();
```

- **代码解读**：
  - 首先，从日志文件中读取文本流。
  - 然后，使用MapFunction对文本流进行处理，提取用户ID和时间戳，并转换为UserLogin对象。
  - 接着，使用assignTimestampsAndWatermarks方法设置时间戳和水印。
  - 然后，使用keyBy方法对数据按用户ID进行分组。
  - 使用TumblingEventTimeWindows.of方法设置时间窗口，每24小时滚动一次。
  - 最后，使用sum方法计算每个用户的登录次数，并输出结果。

### 4.4 常见问题解答

**Q1：Flink与Spark Streaming相比，有哪些优势？**

A1：Flink与Spark Streaming相比，具有以下优势：

- **毫秒级延迟**: Flink的延迟更低，通常在毫秒级别，而Spark Streaming的延迟在秒级别。
- **容错性**: Flink采用分布式快照机制，能够保证数据的一致性和容错性，而Spark Streaming采用 checkpoint 机制，容错性稍弱。
- **高吞吐量**: Flink采用高效的数据流引擎，能够处理高吞吐量的实时数据，而Spark Streaming的吞吐量相对较低。

**Q2：Flink如何处理乱序事件？**

A2：Flink使用水印（Watermark）机制处理乱序事件。水印表示时间戳 $t$ 之前到达的所有事件都已到达，后续到达的事件可以直接处理，无需等待。

**Q3：Flink如何进行分布式计算？**

A3：Flink采用无中心架构，将数据流划分为多个分区，并分配到不同的节点进行并行计算。每个节点负责处理一部分数据，并与其他节点进行通信，完成数据交换和任务调度。

## 5. 项目实践：代码实例和详细解释说明

### 5.1 开发环境搭建

以下是使用Flink进行开发的环境搭建步骤：

1. 下载Flink安装包。
2. 解压安装包，配置环境变量。
3. 使用IDE（如IntelliJ IDEA、Eclipse等）创建Flink项目。

### 5.2 源代码详细实现

以下是一个使用Flink进行实时日志分析的项目实例：

```java
import org.apache.flink.api.common.functions.MapFunction;
import org.apache.flink.api.java.tuple.Tuple2;
import org.apache.flink.streaming.api.datastream.DataStream;
import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;

public class RealTimeLogAnalysis {
  public static void main(String[] args) throws Exception {
    // 创建Flink执行环境
    StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();

    // 创建数据源
    DataStream<String> inputStream = env.readTextFile("log.txt");

    // 转换数据
    DataStream<Tuple2<String, Integer>> wordCounts = inputStream
      .map(new MapFunction<String, Tuple2<String, Integer>>() {
        @Override
        public Tuple2<String, Integer> map(String value) throws Exception {
          return new Tuple2<>(value, 1);
        }
      })
      .keyBy(0)
      .sum(1);

    // 输出结果
    wordCounts.print();

    // 执行任务
    env.execute("RealTime Log Analysis");
  }
}
```

- **代码解读**：
  - 创建Flink执行环境。
  - 从文件中读取文本流。
  - 使用MapFunction对文本流进行处理，将每行文本转换为字符串-整数元组。
  - 使用keyBy方法对数据按第一个字段进行分组。
  - 使用sum方法计算每个组的第二个字段的和。
  - 输出结果。
  - 执行任务。

### 5.3 代码解读与分析

上述代码展示了如何使用Flink进行实时日志分析。首先，创建Flink执行环境，然后从文件中读取文本流。接下来，使用MapFunction将每行文本转换为字符串-整数元组，然后使用keyBy方法对数据按第一个字段进行分组，最后使用sum方法计算每个组的第二个字段的和。最后，输出结果并执行任务。

### 5.4 运行结果展示

运行上述代码后，可以看到实时日志分析的结果，例如：

```
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(b, 1)
(a, 1)
(b, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(b, 1)
(a, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a, 1)
(b, 1)
(a